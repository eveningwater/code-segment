<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ë¥¢Âä°ËÆ°ÁÆóÂô® - hasDecimals ÂÆûÊàòÁ§∫‰æã</title>
    <link rel="stylesheet" href="../../demo/plugins/modal/style.css">
    <link rel="stylesheet" href="../../demo/plugins/input-number/style.css">
    <link rel="stylesheet" href="../../demo/plugins/select/style.css">
    <link rel="stylesheet" href="../../demo/plugins/notification/style.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            transition: all 0.3s ease;
        }

        body.dark-theme {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: #ecf0f1;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            color: #fff;
            font-size: 2.8rem;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            margin-bottom: 10px;
        }

        .header p {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.1rem;
        }

        .theme-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 50px;
            padding: 12px 24px;
            color: #fff;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            z-index: 100;
        }

        .theme-toggle:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .calculator-section {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            position: relative;
            z-index: 1;
        }

        .section-title {
            color: #fff;
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 20px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
            padding-bottom: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            color: #fff;
            margin-bottom: 8px;
            font-weight: 500;
            font-size: 0.95rem;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        #incomeInput .ew-input-number {
            width: 100%;
        }

       
        #dataInput .ew-input-number {
            width: 100%;
            min-width: 600px;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.15);
        }

        .form-group input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .calculate-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 50px;
            padding: 15px 30px;
            color: #fff;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            width: 100%;
            margin-top: 10px;
        }

        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        .result-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            border-left: 4px solid #27ae60;
        }

        .result-title {
            color: #fff;
            font-weight: 600;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .result-value {
            color: #27ae60;
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .result-details {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .data-analysis {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            position: relative;
            z-index: 1;
        }

        .data-input {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .data-input input {
            flex: 1;
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            font-size: 1rem;
        }

        .add-data-btn {
            background: rgba(39, 174, 96, 0.3);
            border: none;
            border-radius: 10px;
            padding: 12px 20px;
            color: #fff;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .add-data-btn:hover {
            background: rgba(39, 174, 96, 0.5);
        }

        .data-list {
            max-height: 200px;
            overflow-y: auto;
            margin-bottom: 20px;
        }

        .data-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: #fff;
        }

        .data-item .value {
            font-weight: 600;
        }

        .data-item .type {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .remove-data-btn {
            background: rgba(231, 76, 60, 0.3);
            border: none;
            border-radius: 6px;
            padding: 4px 8px;
            color: #fff;
            cursor: pointer;
            font-size: 0.8rem;
        }

        .remove-data-btn:hover {
            background: rgba(231, 76, 60, 0.5);
        }

        .analysis-results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .analysis-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
        }

        .analysis-label {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.8rem;
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .analysis-value {
            color: #fff;
            font-size: 1.5rem;
            font-weight: 700;
        }

        .analysis-value.integer {
            color: #27ae60;
        }

        .analysis-value.decimal {
            color: #f39c12;
        }

        .validation-section {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            position: relative;
            z-index: 1;
        }

        .validation-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid transparent;
        }

        .validation-item.valid {
            border-left-color: #27ae60;
        }

        .validation-item.invalid {
            border-left-color: #e74c3c;
        }

        .validation-label {
            color: #fff;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .validation-result {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
        }

        .validation-result.valid {
            color: #27ae60;
        }

        .validation-result.invalid {
            color: #e74c3c;
        }

        .currency-converter {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            position: relative;
            z-index: 1;
        }

        .converter-row {
            display: flex;
            gap: 15px;
            align-items: center;
            margin-bottom: 15px;
        }

        .converter-row input {
            flex: 1;
        }

        .converter-row .ew-select {
            flex: 1;
        }

        .swap-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            color: #fff;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }

        .swap-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(180deg);
        }

        .dark-theme .form-group input,
        .dark-theme .form-group select {
            background: rgba(0, 0, 0, 0.3);
            border-color: rgba(255, 255, 255, 0.1);
            color: #ecf0f1;
        }

        .dark-theme .form-group input:focus,
        .dark-theme .form-group select:focus {
            border-color: rgba(255, 255, 255, 0.3);
            background: rgba(0, 0, 0, 0.5);
        }

        .dark-theme .ew-select {
            background: rgba(0, 0, 0, 0.3);
            border-color: rgba(255, 255, 255, 0.1);
            color: #ecf0f1;
        }


        .ew-select {
            position: relative;
            z-index: 100;
        }

        .ew-select .select-options {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            max-height: 200px;
            overflow-y: auto;
        }

        .dark-theme .ew-select .select-options {
            background: rgba(0, 0, 0, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .select-option {
            padding: 10px 15px;
            cursor: pointer;
            transition: all 0.2s ease;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .select-option:hover {
            background: rgba(102, 126, 234, 0.1);
        }

        .dark-theme .select-option {
            color: #ecf0f1;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .dark-theme .select-option:hover {
            background: rgba(102, 126, 234, 0.2);
        }

        /* InputNumber Êèí‰ª∂Ëá™ÂÆö‰πâÊ†∑Âºè */
        .dark-theme .ew-input-number {
            background: rgba(0, 0, 0, 0.3);
            border-color: rgba(255, 255, 255, 0.1);
        }

        .dark-theme .input-number-input {
            background: rgba(0, 0, 0, 0.3);
            border-color: rgba(255, 255, 255, 0.1);
            color: #ecf0f1;
        }

        .dark-theme .input-number-button {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
            color: #ecf0f1;
        }

        .dark-theme .input-number-button:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .data-input .ew-input-number {
            flex: 1;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .converter-row {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <button class="theme-toggle" id="themeToggle">üåô ÂàáÊç¢‰∏ªÈ¢ò</button>
    
    <div class="container">
        <header class="header">
            <h1>Ë¥¢Âä°ËÆ°ÁÆóÂô®</h1>
            <p>Âü∫‰∫é hasDecimals ÊñπÊ≥ïÁöÑÊô∫ËÉΩË¥¢Âä°ËÆ°ÁÆó‰∏éÊï∞ÊçÆÂàÜÊûêÁ≥ªÁªü</p>
        </header>

        <div class="main-content">
            <div class="calculator-section">
                <h2 class="section-title">Á®éÁéáËÆ°ÁÆóÂô®</h2>
                <div class="form-group">
                    <label>Êî∂ÂÖ•ÈáëÈ¢ù</label>
                    <div id="incomeInput"></div>
                </div>
                <div class="form-group">
                    <label>Á®éÁéáÁ±ªÂûã</label>
                    <div id="taxTypeSelect"></div>
                </div>
                <button class="calculate-btn" id="calculateTaxBtn">ËÆ°ÁÆóÁ®éÈ¢ù</button>
                <div class="result-card" id="taxResult" style="display: none;">
                    <div class="result-title">ËÆ°ÁÆóÁªìÊûú</div>
                    <div class="result-value" id="taxAmount">¬•0.00</div>
                    <div class="result-details" id="taxDetails"></div>
                </div>
            </div>

            <div class="currency-converter">
                <h2 class="section-title">Ë¥ßÂ∏ÅËΩ¨Êç¢Âô®</h2>
                <div class="converter-row">
                    <div id="fromAmountInput"></div>
                    <div id="fromCurrencySelect"></div>
                </div>
                <div class="converter-row">
                    <button class="swap-btn" id="swapBtn">‚áÖ</button>
                </div>
                <div class="converter-row">
                    <div id="toAmountInput"></div>
                    <div id="toCurrencySelect"></div>
                </div>
                <button class="calculate-btn" id="convertBtn">ËΩ¨Êç¢Ë¥ßÂ∏Å</button>
                <div class="result-card" id="conversionResult" style="display: none;">
                    <div class="result-title">ËΩ¨Êç¢ÁªìÊûú</div>
                    <div class="result-value" id="convertedAmount">$0.00</div>
                    <div class="result-details" id="conversionDetails"></div>
                </div>
            </div>
        </div>

        <div class="data-analysis">
            <h2 class="section-title">Êï∞ÊçÆÂàÜÊûê</h2>
            <div class="data-input">
                <div id="dataInput"></div>
                <button class="add-data-btn" id="addDataBtn">Ê∑ªÂä†</button>
            </div>
            <div class="data-list" id="dataList"></div>
            <div class="analysis-results" id="analysisResults"></div>
        </div>

        <div class="validation-section">
            <h2 class="section-title">Êï∞ÂÄºÈ™åËØÅ</h2>
            <div id="validationResults"></div>
        </div>
    </div>

    <script src="../../demo/plugins/modal/index.js"></script>
    <script src="../../demo/plugins/input-number/index.js"></script>
    <script src="../../demo/plugins/select/index.js"></script>
    <script src="../../demo/plugins/notification/index.js"></script>
    
    <script>
        // hasDecimals ÊñπÊ≥ï
        const hasDecimals = num => num % 1 !== 0;

        // Ë¥¢Âä°ËÆ°ÁÆóÂô®Á≥ªÁªü
        class FinancialCalculator {
            constructor() {
                this.dataSet = [];
                this.exchangeRates = {
                    'CNY': 1,
                    'USD': 0.14,
                    'EUR': 0.13,
                    'JPY': 20.5,
                    'GBP': 0.11
                };
                this.taxRates = {
                    'progressive': {
                        brackets: [
                            { min: 0, max: 3000, rate: 0.03 },
                            { min: 3000, max: 12000, rate: 0.10 },
                            { min: 12000, max: 25000, rate: 0.20 },
                            { min: 25000, max: 35000, rate: 0.25 },
                            { min: 35000, max: 55000, rate: 0.30 },
                            { min: 55000, max: 80000, rate: 0.35 },
                            { min: 80000, max: Infinity, rate: 0.45 }
                        ]
                    },
                    'flat': { rate: 0.20 },
                    'reduced': { rate: 0.10 }
                };
                
                this.modal = new Modal();
                this.notification = new Notification();
                
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.initComponents();
                this.runValidationTests();
            }

            setupEventListeners() {
                // ‰∏ªÈ¢òÂàáÊç¢
                document.getElementById('themeToggle').addEventListener('click', () => {
                    this.toggleTheme();
                });

                // Á®éÁéáËÆ°ÁÆó
                document.getElementById('calculateTaxBtn').addEventListener('click', () => {
                    this.calculateTax();
                });

                // Ë¥ßÂ∏ÅËΩ¨Êç¢
                document.getElementById('convertBtn').addEventListener('click', () => {
                    this.convertCurrency();
                });

                // Êï∞ÊçÆÊ∑ªÂä†
                document.getElementById('addDataBtn').addEventListener('click', () => {
                    this.addData();
                });

                // Ë¥ßÂ∏Å‰∫§Êç¢
                document.getElementById('swapBtn').addEventListener('click', () => {
                    this.swapCurrencies();
                });

                // ÂõûËΩ¶ÈîÆÊ∑ªÂä†Êï∞ÊçÆ
                document.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && e.target.closest('#dataInput')) {
                        this.addData();
                    }
                });
            }

            initComponents() {
                // ÂàùÂßãÂåñÊî∂ÂÖ•ËæìÂÖ•
                this.incomeInput = new InputNumber({
                    container: '#incomeInput',
                    min: 0,
                    max: 1000000,
                    step: 100,
                    value: 50000,
                    onChange: (value) => {
                        console.log('Êî∂ÂÖ•ÈáëÈ¢ù:', value);
                    }
                });

                // ÂàùÂßãÂåñÁ®éÁéáÁ±ªÂûãÈÄâÊã©
                this.taxTypeSelect = new Select({
                    container: '#taxTypeSelect',
                    placeholder: 'ÈÄâÊã©Á®éÁéáÁ±ªÂûã'
                });
                this.taxTypeSelect.setOptions([
                    { value: 'progressive', label: 'Á¥ØËøõÁ®éÁéá' },
                    { value: 'flat', label: 'Áªü‰∏ÄÁ®éÁéá (20%)' },
                    { value: 'reduced', label: '‰ºòÊÉ†Á®éÁéá (10%)' }
                ]);

                // ÂàùÂßãÂåñË¥ßÂ∏ÅËΩ¨Êç¢Âô®
                this.fromAmountInput = new InputNumber({
                    container: '#fromAmountInput',
                    min: 0,
                    max: 1000000,
                    step: 0.01,
                    value: 1000,
                    onChange: (value) => {
                        console.log('ËΩ¨Êç¢ÈáëÈ¢ù:', value);
                    }
                });

                this.toAmountInput = new InputNumber({
                    container: '#toAmountInput',
                    min: 0,
                    max: 1000000,
                    step: 0.01,
                    value: 0,
                    onChange: (value) => {
                        console.log('ËΩ¨Êç¢ÁªìÊûú:', value);
                    }
                });

                this.fromCurrencySelect = new Select({
                    container: '#fromCurrencySelect',
                    placeholder: 'ÈÄâÊã©Ë¥ßÂ∏Å'
                });
                this.fromCurrencySelect.setOptions([
                    { value: 'CNY', label: '‰∫∫Ê∞ëÂ∏Å (CNY)' },
                    { value: 'USD', label: 'ÁæéÂÖÉ (USD)' },
                    { value: 'EUR', label: 'Ê¨ßÂÖÉ (EUR)' },
                    { value: 'JPY', label: 'Êó•ÂÖÉ (JPY)' },
                    { value: 'GBP', label: 'Ëã±Èïë (GBP)' }
                ]);
                this.fromCurrencySelect.setValue('CNY');

                this.toCurrencySelect = new Select({
                    container: '#toCurrencySelect',
                    placeholder: 'ÈÄâÊã©Ë¥ßÂ∏Å'
                });
                this.toCurrencySelect.setOptions([
                    { value: 'USD', label: 'ÁæéÂÖÉ (USD)' },
                    { value: 'CNY', label: '‰∫∫Ê∞ëÂ∏Å (CNY)' },
                    { value: 'EUR', label: 'Ê¨ßÂÖÉ (EUR)' },
                    { value: 'JPY', label: 'Êó•ÂÖÉ (JPY)' },
                    { value: 'GBP', label: 'Ëã±Èïë (GBP)' }
                ]);
                this.toCurrencySelect.setValue('USD');

                // ÂàùÂßãÂåñÊï∞ÊçÆÂàÜÊûêËæìÂÖ•
                this.dataInput = new InputNumber({
                    container: '#dataInput',
                    min: -1000000,
                    max: 1000000,
                    step: 0.01,
                    value: 0,
                    onChange: (value) => {
                        console.log('Êï∞ÊçÆËæìÂÖ•:', value);
                    }
                });
            }

            toggleTheme() {
                const body = document.body;
                const themeBtn = document.getElementById('themeToggle');
                
                if (body.classList.contains('dark-theme')) {
                    body.classList.remove('dark-theme');
                    themeBtn.textContent = 'üåô ÂàáÊç¢‰∏ªÈ¢ò';
                    this.notification.success('Â∑≤ÂàáÊç¢Âà∞ÊµÖËâ≤‰∏ªÈ¢ò');
                } else {
                    body.classList.add('dark-theme');
                    themeBtn.textContent = '‚òÄÔ∏è ÂàáÊç¢‰∏ªÈ¢ò';
                    this.notification.success('Â∑≤ÂàáÊç¢Âà∞Ê∑±Ëâ≤‰∏ªÈ¢ò');
                }
            }

            calculateTax() {
                const income = this.incomeInput.getValue();
                const taxType = this.taxTypeSelect.getValue();

                if (!income || income <= 0) {
                    this.notification.error('ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑÊî∂ÂÖ•ÈáëÈ¢ù');
                    return;
                }

                if (!taxType) {
                    this.notification.error('ËØ∑ÈÄâÊã©Á®éÁéáÁ±ªÂûã');
                    return;
                }

                let taxAmount = 0;
                let taxDetails = '';

                if (taxType === 'progressive') {
                    // Á¥ØËøõÁ®éÁéáËÆ°ÁÆó
                    let remainingIncome = income;
                    let totalTax = 0;
                    const brackets = this.taxRates.progressive.brackets;

                    for (let i = 0; i < brackets.length; i++) {
                        const bracket = brackets[i];
                        if (remainingIncome > 0) {
                            const taxableInBracket = Math.min(remainingIncome, bracket.max - bracket.min);
                            const taxInBracket = taxableInBracket * bracket.rate;
                            totalTax += taxInBracket;
                            remainingIncome -= taxableInBracket;

                            if (taxInBracket > 0) {
                                taxDetails += `${bracket.min.toLocaleString()}-${bracket.max === Infinity ? '‚àû' : bracket.max.toLocaleString()}: ¬•${taxInBracket.toFixed(2)} (${(bracket.rate * 100)}%)<br>`;
                            }
                        }
                    }
                    taxAmount = totalTax;
                } else {
                    // Áªü‰∏ÄÁ®éÁéáÊàñ‰ºòÊÉ†Á®éÁéá
                    const rate = this.taxRates[taxType].rate;
                    taxAmount = income * rate;
                    taxDetails = `Á®éÁéá: ${(rate * 100)}%`;
                }

                // ‰ΩøÁî® hasDecimals Ê£ÄÊü•Á®éÈ¢ùÊòØÂê¶ÊúâÂ∞èÊï∞
                const hasDecimalTax = hasDecimals(taxAmount);
                const taxDisplay = hasDecimalTax ? taxAmount.toFixed(2) : taxAmount.toFixed(0);

                document.getElementById('taxAmount').textContent = `¬•${taxDisplay}`;
                document.getElementById('taxDetails').innerHTML = taxDetails;
                document.getElementById('taxResult').style.display = 'block';

                this.notification.success(`Á®éÈ¢ùËÆ°ÁÆóÂÆåÊàê: ¬•${taxDisplay}`);
            }

            convertCurrency() {
                const amount = this.fromAmountInput.getValue();
                const fromCurrency = this.fromCurrencySelect.getValue();
                const toCurrency = this.toCurrencySelect.getValue();

                if (!amount || amount <= 0) {
                    this.notification.error('ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑËΩ¨Êç¢ÈáëÈ¢ù');
                    return;
                }

                if (!fromCurrency || !toCurrency) {
                    this.notification.error('ËØ∑ÈÄâÊã©Ë¥ßÂ∏ÅÁ±ªÂûã');
                    return;
                }

                // ËΩ¨Êç¢‰∏∫‰∫∫Ê∞ëÂ∏ÅÔºåÂÜçËΩ¨Êç¢‰∏∫ÁõÆÊ†áË¥ßÂ∏Å
                const cnyAmount = amount / this.exchangeRates[fromCurrency];
                const convertedAmount = cnyAmount * this.exchangeRates[toCurrency];

                // ‰ΩøÁî® hasDecimals Ê£ÄÊü•ËΩ¨Êç¢ÁªìÊûúÊòØÂê¶ÊúâÂ∞èÊï∞
                const hasDecimalResult = hasDecimals(convertedAmount);
                const displayAmount = hasDecimalResult ? convertedAmount.toFixed(2) : convertedAmount.toFixed(0);

                this.toAmountInput.setValue(convertedAmount);

                document.getElementById('convertedAmount').textContent = `${toCurrency} ${displayAmount}`;
                document.getElementById('conversionDetails').innerHTML = `
                    Ê±áÁéá: 1 ${fromCurrency} = ${(this.exchangeRates[toCurrency] / this.exchangeRates[fromCurrency]).toFixed(4)} ${toCurrency}<br>
                    ËΩ¨Êç¢Á±ªÂûã: ${hasDecimalResult ? 'Â∞èÊï∞ÈáëÈ¢ù' : 'Êï¥Êï∞ÈáëÈ¢ù'}
                `;
                document.getElementById('conversionResult').style.display = 'block';

                this.notification.success(`Ë¥ßÂ∏ÅËΩ¨Êç¢ÂÆåÊàê: ${toCurrency} ${displayAmount}`);
            }

            swapCurrencies() {
                const fromCurrency = this.fromCurrencySelect.getValue();
                const toCurrency = this.toCurrencySelect.getValue();
                const amount = this.fromAmountInput.getValue();

                this.fromCurrencySelect.setValue(toCurrency);
                this.toCurrencySelect.setValue(fromCurrency);
                this.fromAmountInput.setValue(amount);

                // Ëá™Âä®ËΩ¨Êç¢
                this.convertCurrency();
            }

            addData() {
                const value = this.dataInput.getValue();

                if (value === null || isNaN(value)) {
                    this.notification.error('ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑÊï∞ÂÄº');
                    return;
                }

                this.dataSet.push(value);
                this.dataInput.setValue(0);
                this.renderDataList();
                this.analyzeData();
                this.notification.success(`Êï∞ÊçÆÊ∑ªÂä†ÊàêÂäü: ${value}`);
            }

            renderDataList() {
                const dataList = document.getElementById('dataList');
                dataList.innerHTML = '';

                this.dataSet.forEach((value, index) => {
                    const dataItem = document.createElement('div');
                    dataItem.className = 'data-item';
                    
                    const hasDecimal = hasDecimals(value);
                    const displayValue = hasDecimal ? value.toFixed(2) : value.toFixed(0);
                    
                    dataItem.innerHTML = `
                        <div>
                            <div class="value">${displayValue}</div>
                            <div class="type">${hasDecimal ? 'Â∞èÊï∞' : 'Êï¥Êï∞'}</div>
                        </div>
                        <button class="remove-data-btn" onclick="calculator.removeData(${index})">Âà†Èô§</button>
                    `;
                    dataList.appendChild(dataItem);
                });
            }

            removeData(index) {
                this.dataSet.splice(index, 1);
                this.renderDataList();
                this.analyzeData();
                this.notification.success('Êï∞ÊçÆÂà†Èô§ÊàêÂäü');
            }

            analyzeData() {
                if (this.dataSet.length === 0) {
                    document.getElementById('analysisResults').innerHTML = '<p style="color: rgba(255,255,255,0.7); text-align: center;">ÊöÇÊó†Êï∞ÊçÆ</p>';
                    return;
                }

                const sum = this.dataSet.reduce((a, b) => a + b, 0);
                const average = sum / this.dataSet.length;
                const min = Math.min(...this.dataSet);
                const max = Math.max(...this.dataSet);
                const integerCount = this.dataSet.filter(num => !hasDecimals(num)).length;
                const decimalCount = this.dataSet.filter(num => hasDecimals(num)).length;

                const results = [
                    { label: 'ÊÄªÂíå', value: sum, hasDecimal: hasDecimals(sum) },
                    { label: 'Âπ≥ÂùáÂÄº', value: average, hasDecimal: hasDecimals(average) },
                    { label: 'ÊúÄÂ∞èÂÄº', value: min, hasDecimal: hasDecimals(min) },
                    { label: 'ÊúÄÂ§ßÂÄº', value: max, hasDecimal: hasDecimals(max) },
                    { label: 'Êï¥Êï∞Êï∞Èáè', value: integerCount, hasDecimal: false },
                    { label: 'Â∞èÊï∞Êï∞Èáè', value: decimalCount, hasDecimal: false }
                ];

                document.getElementById('analysisResults').innerHTML = results.map(result => `
                    <div class="analysis-card">
                        <div class="analysis-label">${result.label}</div>
                        <div class="analysis-value ${result.hasDecimal ? 'decimal' : 'integer'}">
                            ${result.hasDecimal ? result.value.toFixed(2) : result.value}
                        </div>
                    </div>
                `).join('');
            }

            runValidationTests() {
                const testCases = [
                    { value: 42, expected: false, description: 'Êï¥Êï∞ 42' },
                    { value: 3.14, expected: true, description: 'Â∞èÊï∞ 3.14' },
                    { value: 0, expected: false, description: 'Èõ∂ÂÄº 0' },
                    { value: -5, expected: false, description: 'Ë¥üÊï¥Êï∞ -5' },
                    { value: -2.5, expected: true, description: 'Ë¥üÂ∞èÊï∞ -2.5' },
                    { value: 100.0, expected: false, description: 'Êï¥Êï∞ÂÄº 100.0' },
                    { value: 0.001, expected: true, description: 'Â∞èÊï∞ÂÄº 0.001' }
                ];

                const validationResults = document.getElementById('validationResults');
                validationResults.innerHTML = '';

                testCases.forEach(testCase => {
                    const result = hasDecimals(testCase.value);
                    const isValid = result === testCase.expected;
                    
                    const validationItem = document.createElement('div');
                    validationItem.className = `validation-item ${isValid ? 'valid' : 'invalid'}`;
                    
                    validationItem.innerHTML = `
                        <div class="validation-label">${testCase.description}</div>
                        <div class="validation-result ${isValid ? 'valid' : 'invalid'}">
                            ËæìÂÖ•: ${testCase.value} | ÊúüÊúõ: ${testCase.expected} | ÂÆûÈôÖ: ${result} | 
                            ${isValid ? '‚úì ÈÄöËøá' : '‚úó Â§±Ë¥•'}
                        </div>
                    `;
                    
                    validationResults.appendChild(validationItem);
                });
            }
        }

        // ÂàùÂßãÂåñË¥¢Âä°ËÆ°ÁÆóÂô®
        const calculator = new FinancialCalculator();

        // ÊºîÁ§∫ hasDecimals ÊñπÊ≥ïÁöÑ‰ΩøÁî®
        console.log('hasDecimals ÊñπÊ≥ïÊºîÁ§∫:');
        console.log('hasDecimals(42):', hasDecimals(42));
        console.log('hasDecimals(3.14):', hasDecimals(3.14));
        console.log('hasDecimals(100.0):', hasDecimals(100.0));
        console.log('hasDecimals(0.001):', hasDecimals(0.001));
    </script>
</body>
</html>