<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Áî®Êà∑Ê≥®ÂÜåÁ≥ªÁªü - httpPost ÂÆûÊàòÁ§∫‰æã</title>
    <link rel="stylesheet" href="../../demo/plugins/modal/style.css">
    <link rel="stylesheet" href="../../demo/plugins/notification/style.css">
    <link rel="stylesheet" href="../../demo/plugins/select/style.css">
    <link rel="stylesheet" href="../../demo/plugins/checkbox/style.css">
    <link rel="stylesheet" href="../../demo/plugins/datetime-picker/style.css">
    <link rel="stylesheet" href="../../demo/plugins/input-number/style.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
        }

        .form-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .form-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            border: 2px solid #e9ecef;
        }

        .form-section h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.3em;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 0.9em;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-control.error {
            border-color: #dc3545;
        }

        .form-control.success {
            border-color: #28a745;
        }

        .error-message {
            color: #dc3545;
            font-size: 0.8em;
            margin-top: 5px;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 16px;
            margin: 5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
            color: white;
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(108, 117, 125, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(40, 167, 69, 0.4);
        }

        .file-upload {
            position: relative;
            display: inline-block;
            width: 100%;
        }

        .file-upload input[type=file] {
            position: absolute;
            left: -9999px;
        }

        .file-upload-label {
            display: block;
            padding: 12px 15px;
            border: 2px dashed #e9ecef;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        .file-upload-label:hover {
            border-color: #667eea;
            background: #f0f2ff;
        }

        .file-preview {
            margin-top: 10px;
            padding: 10px;
            background: #e9ecef;
            border-radius: 8px;
            display: none;
        }

        .file-preview.show {
            display: block;
        }

        .file-preview img {
            max-width: 100px;
            max-height: 100px;
            border-radius: 5px;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: #e9ecef;
            border-radius: 3px;
            overflow: hidden;
            margin-top: 10px;
            display: none;
        }

        .progress-bar.show {
            display: block;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            width: 0%;
            transition: width 0.3s ease;
        }

        .form-actions {
            grid-column: 1 / -1;
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #e9ecef;
        }

        .result-container {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
            border: 2px solid #e9ecef;
            display: none;
        }

        .result-container.show {
            display: block;
        }

        .result-title {
            font-size: 1.2em;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
            text-align: center;
        }

        .result-data {
            display: grid;
            gap: 10px;
        }

        .result-row {
            display: flex;
            padding: 10px;
            background: white;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }

        .result-label {
            font-weight: 600;
            color: #333;
            min-width: 120px;
            margin-right: 15px;
        }

        .result-value {
            color: #666;
            flex: 1;
        }

        .validation-status {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
            font-size: 0.9em;
        }

        .status-icon {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .status-valid {
            background: #d4edda;
            color: #155724;
        }

        .status-invalid {
            background: #f8d7da;
            color: #721c24;
        }

        .password-strength {
            margin-top: 10px;
        }

        .strength-bar {
            height: 4px;
            background: #e9ecef;
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 5px;
        }

        .strength-fill {
            height: 100%;
            transition: all 0.3s ease;
        }

        .strength-weak {
            background: #dc3545;
            width: 25%;
        }

        .strength-medium {
            background: #ffc107;
            width: 50%;
        }

        .strength-strong {
            background: #28a745;
            width: 75%;
        }

        .strength-very-strong {
            background: #20c997;
            width: 100%;
        }

        .strength-text {
            font-size: 0.8em;
            color: #666;
        }

        @media (max-width: 768px) {
            .form-container {
                grid-template-columns: 1fr;
            }
            
            .form-actions {
                grid-column: 1;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>üë§ Áî®Êà∑Ê≥®ÂÜåÁ≥ªÁªü</h1>
            <p>Âü∫‰∫é httpPost ÊñπÊ≥ïÁöÑÂÆûÊàòÁ§∫‰æã - Ë°®ÂçïÊèê‰∫§‰∏éÊï∞ÊçÆÈ™åËØÅ</p>
        </div>

        <div class="content">
            <form id="registrationForm">
                <div class="form-container">
                    <!-- Âü∫Êú¨‰ø°ÊÅØ -->
                    <div class="form-section">
                        <h3>üìã Âü∫Êú¨‰ø°ÊÅØ</h3>
                        
                        <div class="form-group">
                            <label for="username">Áî®Êà∑Âêç *</label>
                            <input type="text" id="username" class="form-control" placeholder="ËØ∑ËæìÂÖ•Áî®Êà∑Âêç">
                            <div class="error-message" id="username-error">Áî®Êà∑Âêç‰∏çËÉΩ‰∏∫Á©∫‰∏îÈïøÂ∫¶Âú®3-20‰∏™Â≠óÁ¨¶‰πãÈó¥</div>
                            <div class="validation-status">
                                <span class="status-icon" id="username-status">?</span>
                                <span id="username-status-text">ËØ∑ËæìÂÖ•Áî®Êà∑Âêç</span>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="email">ÈÇÆÁÆ±Âú∞ÂùÄ *</label>
                            <input type="email" id="email" class="form-control" placeholder="ËØ∑ËæìÂÖ•ÈÇÆÁÆ±Âú∞ÂùÄ">
                            <div class="error-message" id="email-error">ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑÈÇÆÁÆ±Âú∞ÂùÄ</div>
                            <div class="validation-status">
                                <span class="status-icon" id="email-status">?</span>
                                <span id="email-status-text">ËØ∑ËæìÂÖ•ÈÇÆÁÆ±Âú∞ÂùÄ</span>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="password">ÂØÜÁ†Å *</label>
                            <input type="password" id="password" class="form-control" placeholder="ËØ∑ËæìÂÖ•ÂØÜÁ†Å">
                            <div class="error-message" id="password-error">ÂØÜÁ†ÅÈïøÂ∫¶Ëá≥Â∞ë8‰ΩçÔºåÂåÖÂê´Â≠óÊØçÂíåÊï∞Â≠ó</div>
                            <div class="password-strength">
                                <div class="strength-bar">
                                    <div class="strength-fill" id="strength-fill"></div>
                                </div>
                                <div class="strength-text" id="strength-text">ÂØÜÁ†ÅÂº∫Â∫¶ÔºöÊú™ËÆæÁΩÆ</div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="confirmPassword">Á°ÆËÆ§ÂØÜÁ†Å *</label>
                            <input type="password" id="confirmPassword" class="form-control" placeholder="ËØ∑ÂÜçÊ¨°ËæìÂÖ•ÂØÜÁ†Å">
                            <div class="error-message" id="confirmPassword-error">‰∏§Ê¨°ËæìÂÖ•ÁöÑÂØÜÁ†Å‰∏ç‰∏ÄËá¥</div>
                        </div>
                    </div>

                    <!-- ËØ¶ÁªÜ‰ø°ÊÅØ -->
                    <div class="form-section">
                        <h3>üë§ ËØ¶ÁªÜ‰ø°ÊÅØ</h3>
                        
                        <div class="form-group">
                            <label for="fullName">ÁúüÂÆûÂßìÂêç *</label>
                            <input type="text" id="fullName" class="form-control" placeholder="ËØ∑ËæìÂÖ•ÁúüÂÆûÂßìÂêç">
                            <div class="error-message" id="fullName-error">ËØ∑ËæìÂÖ•ÁúüÂÆûÂßìÂêç</div>
                        </div>

                        <div class="form-group">
                            <label>ÊÄßÂà´</label>
                            <div id="genderSelect"></div>
                        </div>

                        <div class="form-group">
                            <label>Âá∫ÁîüÊó•Êúü</label>
                            <div id="birthDatePicker"></div>
                        </div>

                        <div class="form-group">
                            <label for="phone">ÊâãÊú∫Âè∑Á†Å</label>
                            <input type="tel" id="phone" class="form-control" placeholder="ËØ∑ËæìÂÖ•ÊâãÊú∫Âè∑Á†Å">
                            <div class="error-message" id="phone-error">ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑÊâãÊú∫Âè∑Á†Å</div>
                        </div>

                        <div class="form-group">
                            <label>Áî®Êà∑Á±ªÂûã</label>
                            <div id="userTypeSelect"></div>
                        </div>

                        <div class="form-group">
                            <label>Ê≥®ÂÜåÊï∞Èáè</label>
                            <div id="quantityInput"></div>
                        </div>
                    </div>

                    <!-- ÂÅèÂ•ΩËÆæÁΩÆ -->
                    <div class="form-section">
                        <h3>‚öôÔ∏è ÂÅèÂ•ΩËÆæÁΩÆ</h3>
                        
                        <div class="form-group">
                            <label>ÂÖ¥Ë∂£Áà±Â•Ω</label>
                            <div id="interestsCheckbox"></div>
                        </div>

                        <div class="form-group">
                            <label>ÈÄöÁü•ËÆæÁΩÆ</label>
                            <div id="notificationCheckbox"></div>
                        </div>

                        <div class="form-group">
                            <label>Â§¥ÂÉè‰∏ä‰º†</label>
                            <div class="file-upload">
                                <input type="file" id="avatar" accept="image/*">
                                <label for="avatar" class="file-upload-label">
                                    üì∑ ÁÇπÂáªÈÄâÊã©Â§¥ÂÉèÊñá‰ª∂
                                </label>
                            </div>
                            <div class="file-preview" id="filePreview">
                                <img id="previewImage" src="" alt="È¢ÑËßà">
                            </div>
                            <div class="progress-bar" id="uploadProgress">
                                <div class="progress-fill" id="progressFill"></div>
                            </div>
                        </div>
                    </div>

                    <!-- ÂçèËÆÆÁ°ÆËÆ§ -->
                    <div class="form-section">
                        <h3>üìÑ ÂçèËÆÆÁ°ÆËÆ§</h3>
                        
                        <div class="form-group">
                            <div id="agreementCheckbox"></div>
                        </div>

                        <div class="form-group">
                            <label for="referralCode">Êé®ËçêÁ†ÅÔºàÂèØÈÄâÔºâ</label>
                            <input type="text" id="referralCode" class="form-control" placeholder="ËØ∑ËæìÂÖ•Êé®ËçêÁ†Å">
                        </div>
                    </div>
                </div>

                <!-- Ë°®ÂçïÊìç‰Ωú -->
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="resetForm()">ÈáçÁΩÆË°®Âçï</button>
                    <button type="button" class="btn btn-primary" onclick="validateAndSubmit()">Êèê‰∫§Ê≥®ÂÜå</button>
                    <button type="button" class="btn btn-success" onclick="generateDemoData()">ÁîüÊàêÊºîÁ§∫Êï∞ÊçÆ</button>
                </div>
            </form>

            <!-- Êèê‰∫§ÁªìÊûú -->
            <div class="result-container" id="resultContainer">
                <div class="result-title">‚úÖ Ê≥®ÂÜåÊàêÂäüÔºÅ</div>
                <div class="result-data" id="resultData"></div>
            </div>
        </div>
    </div>

    <!-- ÂºïÂÖ•Êèí‰ª∂ -->
    <script src="../../demo/plugins/modal/index.js"></script>
    <script src="../../demo/plugins/notification/index.js"></script>
    <script src="../../demo/plugins/select/index.js"></script>
    <script src="../../demo/plugins/checkbox/index.js"></script>
    <script src="../../demo/plugins/datetime-picker/index.js"></script>
    <script src="../../demo/plugins/input-number/index.js"></script>

    <script>
        // ÂÖ®Â±ÄÂèòÈáè
        let modal, notification;
        let genderSelect, userTypeSelect, birthDatePicker, quantityInput;
        let interestsCheckbox, notificationCheckbox, agreementCheckbox;
        let formData = {};
        let avatarFile = null;

        // httpPost ÊñπÊ≥ï
        const httpPost = (url, data, callback, error = console.error) => {
            const request = new XMLHttpRequest();
            request.open('POST', url, true);
            request.setRequestHeader('Content-type', 'application/json; charset=utf-8');
            request.onload = () => callback(request.responseText);
            request.onerror = () => error(request);
            request.send(data);
        };

        // ÂàùÂßãÂåñÂ∫îÁî®
        function initApp() {
            // ÂàùÂßãÂåñÊèí‰ª∂
            modal = new Modal();
            notification = new Notification({ position: 'top-right' });

            // ÂàùÂßãÂåñÈÄâÊã©Âô®
            genderSelect = new Select({
                container: document.getElementById('genderSelect'),
                options: [
                    { value: 'male', label: 'Áî∑' },
                    { value: 'female', label: 'Â•≥' },
                    { value: 'other', label: 'ÂÖ∂‰ªñ' }
                ],
                placeholder: 'ÈÄâÊã©ÊÄßÂà´'
            });

            userTypeSelect = new Select({
                container: document.getElementById('userTypeSelect'),
                options: [
                    { value: 'personal', label: '‰∏™‰∫∫Áî®Êà∑' },
                    { value: 'business', label: '‰ºÅ‰∏öÁî®Êà∑' },
                    { value: 'developer', label: 'ÂºÄÂèëËÄÖ' },
                    { value: 'student', label: 'Â≠¶Áîü' }
                ],
                placeholder: 'ÈÄâÊã©Áî®Êà∑Á±ªÂûã'
            });

                         birthDatePicker = new DateTimePicker({
                 container: document.getElementById('birthDatePicker'),
                 placeholder: 'ÈÄâÊã©Âá∫ÁîüÊó•Êúü',
                 format: 'YYYY-MM-DD HH:mm:ss'
             });

            quantityInput = new InputNumber({
                container: document.getElementById('quantityInput'),
                min: 1,
                max: 10,
                value: 1,
                step: 1
            });

            // ÂàùÂßãÂåñÂ§çÈÄâÊ°ÜÁªÑ
            interestsCheckbox = Checkbox.createCheckboxGroup({
                container: document.getElementById('interestsCheckbox'),
                items: [
                    { label: 'ÊäÄÊúØÂºÄÂèë', checked: false },
                    { label: 'ËÆæËÆ°ÂàõÊÑè', checked: false },
                    { label: 'ÂïÜ‰∏öÁÆ°ÁêÜ', checked: false },
                    { label: 'ÊïôËÇ≤ÂüπËÆ≠', checked: false },
                    { label: 'ÂÅ•Â∫∑ËøêÂä®', checked: false },
                    { label: 'ÊóÖÊ∏∏ÊëÑÂΩ±', checked: false }
                ]
            });

            notificationCheckbox = Checkbox.createCheckboxGroup({
                container: document.getElementById('notificationCheckbox'),
                items: [
                    { label: 'ÈÇÆ‰ª∂ÈÄöÁü•', checked: true },
                    { label: 'Áü≠‰ø°ÈÄöÁü•', checked: false },
                    { label: 'Êé®ÈÄÅÈÄöÁü•', checked: true },
                    { label: 'Á≥ªÁªüÂÖ¨Âëä', checked: true }
                ]
            });

                         // ÂàõÂª∫Âçï‰∏™ÂçèËÆÆÂêåÊÑèÂ§çÈÄâÊ°Ü
             agreementCheckbox = new Checkbox({
                 label: 'ÊàëÂ∑≤ÈòÖËØªÂπ∂ÂêåÊÑè„ÄäÁî®Êà∑ÂçèËÆÆ„ÄãÂíå„ÄäÈöêÁßÅÊîøÁ≠ñ„Äã',
                 checked: false,
                 onChange: (checked) => {
                     console.log('ÂçèËÆÆÂêåÊÑèÁä∂ÊÄÅ:', checked);
                 }
             });
             agreementCheckbox.mount(document.getElementById('agreementCheckbox'));

            // ËÆæÁΩÆ‰∫ã‰ª∂ÁõëÂê¨Âô®
            setupEventListeners();
        }

        // ËÆæÁΩÆ‰∫ã‰ª∂ÁõëÂê¨Âô®
        function setupEventListeners() {
            // Áî®Êà∑ÂêçÈ™åËØÅ
            document.getElementById('username').addEventListener('input', validateUsername);
            document.getElementById('username').addEventListener('blur', validateUsername);

            // ÈÇÆÁÆ±È™åËØÅ
            document.getElementById('email').addEventListener('input', validateEmail);
            document.getElementById('email').addEventListener('blur', validateEmail);

            // ÂØÜÁ†ÅÈ™åËØÅ
            document.getElementById('password').addEventListener('input', validatePassword);
            document.getElementById('confirmPassword').addEventListener('input', validateConfirmPassword);

            // ÂÖ∂‰ªñÂ≠óÊÆµÈ™åËØÅ
            document.getElementById('fullName').addEventListener('blur', validateFullName);
            document.getElementById('phone').addEventListener('blur', validatePhone);

            // Êñá‰ª∂‰∏ä‰º†
            document.getElementById('avatar').addEventListener('change', handleFileUpload);
        }

        // Áî®Êà∑ÂêçÈ™åËØÅ
        function validateUsername() {
            const input = document.getElementById('username');
            const value = input.value.trim();
            const errorElement = document.getElementById('username-error');
            const statusElement = document.getElementById('username-status');
            const statusText = document.getElementById('username-status-text');

            if (!value) {
                showError(input, errorElement, statusElement, statusText, 'ËØ∑ËæìÂÖ•Áî®Êà∑Âêç');
                return false;
            }

            if (value.length < 3 || value.length > 20) {
                showError(input, errorElement, statusElement, statusText, 'Áî®Êà∑ÂêçÈïøÂ∫¶Â∫îÂú®3-20‰∏™Â≠óÁ¨¶‰πãÈó¥');
                return false;
            }

            if (!/^[a-zA-Z0-9_]+$/.test(value)) {
                showError(input, errorElement, statusElement, statusText, 'Áî®Êà∑ÂêçÂè™ËÉΩÂåÖÂê´Â≠óÊØç„ÄÅÊï∞Â≠óÂíå‰∏ãÂàíÁ∫ø');
                return false;
            }

            showSuccess(input, errorElement, statusElement, statusText, 'Áî®Êà∑ÂêçÂèØÁî®');
            return true;
        }

        // ÈÇÆÁÆ±È™åËØÅ
        function validateEmail() {
            const input = document.getElementById('email');
            const value = input.value.trim();
            const errorElement = document.getElementById('email-error');
            const statusElement = document.getElementById('email-status');
            const statusText = document.getElementById('email-status-text');

            if (!value) {
                showError(input, errorElement, statusElement, statusText, 'ËØ∑ËæìÂÖ•ÈÇÆÁÆ±Âú∞ÂùÄ');
                return false;
            }

            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(value)) {
                showError(input, errorElement, statusElement, statusText, 'ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑÈÇÆÁÆ±Âú∞ÂùÄ');
                return false;
            }

            showSuccess(input, errorElement, statusElement, statusText, 'ÈÇÆÁÆ±Ê†ºÂºèÊ≠£Á°Æ');
            return true;
        }

        // ÂØÜÁ†ÅÈ™åËØÅ
        function validatePassword() {
            const input = document.getElementById('password');
            const value = input.value;
            const errorElement = document.getElementById('password-error');
            const strengthFill = document.getElementById('strength-fill');
            const strengthText = document.getElementById('strength-text');

            if (!value) {
                showError(input, errorElement, null, null, 'ËØ∑ËæìÂÖ•ÂØÜÁ†Å');
                updatePasswordStrength('', '');
                return false;
            }

            if (value.length < 8) {
                showError(input, errorElement, null, null, 'ÂØÜÁ†ÅÈïøÂ∫¶Ëá≥Â∞ë8‰Ωç');
                updatePasswordStrength('weak', 'Âº±');
                return false;
            }

            const hasLetter = /[a-zA-Z]/.test(value);
            const hasNumber = /\d/.test(value);
            const hasSpecial = /[!@#$%^&*(),.?":{}|<>]/.test(value);

            let strength = 'weak';
            let strengthLabel = 'Âº±';

            if (value.length >= 12 && hasLetter && hasNumber && hasSpecial) {
                strength = 'very-strong';
                strengthLabel = 'ÈùûÂ∏∏Âº∫';
            } else if (value.length >= 10 && hasLetter && hasNumber) {
                strength = 'strong';
                strengthLabel = 'Âº∫';
            } else if (value.length >= 8 && (hasLetter || hasNumber)) {
                strength = 'medium';
                strengthLabel = '‰∏≠Á≠â';
            }

            updatePasswordStrength(strength, strengthLabel);
            showSuccess(input, errorElement, null, null, 'ÂØÜÁ†ÅÊ†ºÂºèÊ≠£Á°Æ');
            return true;
        }

        // Êõ¥Êñ∞ÂØÜÁ†ÅÂº∫Â∫¶ÊòæÁ§∫
        function updatePasswordStrength(strength, label) {
            const strengthFill = document.getElementById('strength-fill');
            const strengthText = document.getElementById('strength-text');

            strengthFill.className = 'strength-fill';
            if (strength) {
                strengthFill.classList.add(`strength-${strength}`);
            }
            strengthText.textContent = `ÂØÜÁ†ÅÂº∫Â∫¶Ôºö${label}`;
        }

        // Á°ÆËÆ§ÂØÜÁ†ÅÈ™åËØÅ
        function validateConfirmPassword() {
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const input = document.getElementById('confirmPassword');
            const errorElement = document.getElementById('confirmPassword-error');

            if (!confirmPassword) {
                showError(input, errorElement, null, null, 'ËØ∑Á°ÆËÆ§ÂØÜÁ†Å');
                return false;
            }

            if (password !== confirmPassword) {
                showError(input, errorElement, null, null, '‰∏§Ê¨°ËæìÂÖ•ÁöÑÂØÜÁ†Å‰∏ç‰∏ÄËá¥');
                return false;
            }

            showSuccess(input, errorElement, null, null, 'ÂØÜÁ†ÅÁ°ÆËÆ§Ê≠£Á°Æ');
            return true;
        }

        // ÁúüÂÆûÂßìÂêçÈ™åËØÅ
        function validateFullName() {
            const input = document.getElementById('fullName');
            const value = input.value.trim();
            const errorElement = document.getElementById('fullName-error');

            if (!value) {
                showError(input, errorElement, null, null, 'ËØ∑ËæìÂÖ•ÁúüÂÆûÂßìÂêç');
                return false;
            }

            if (value.length < 2) {
                showError(input, errorElement, null, null, 'ÂßìÂêçÈïøÂ∫¶Ëá≥Â∞ë2‰∏™Â≠óÁ¨¶');
                return false;
            }

            showSuccess(input, errorElement, null, null, 'ÂßìÂêçÊ†ºÂºèÊ≠£Á°Æ');
            return true;
        }

        // ÊâãÊú∫Âè∑È™åËØÅ
        function validatePhone() {
            const input = document.getElementById('phone');
            const value = input.value.trim();
            const errorElement = document.getElementById('phone-error');

            if (!value) {
                showSuccess(input, errorElement, null, null, 'ÊâãÊú∫Âè∑ÂèØÈÄâ');
                return true;
            }

            const phoneRegex = /^1[3-9]\d{9}$/;
            if (!phoneRegex.test(value)) {
                showError(input, errorElement, null, null, 'ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑÊâãÊú∫Âè∑Á†Å');
                return false;
            }

            showSuccess(input, errorElement, null, null, 'ÊâãÊú∫Âè∑Ê†ºÂºèÊ≠£Á°Æ');
            return true;
        }

        // ÊòæÁ§∫ÈîôËØØÁä∂ÊÄÅ
        function showError(input, errorElement, statusElement, statusText, message) {
            input.classList.remove('success');
            input.classList.add('error');
            if (errorElement) {
                errorElement.classList.add('show');
                errorElement.textContent = message;
            }
            if (statusElement) {
                statusElement.className = 'status-icon status-invalid';
                statusElement.textContent = '‚úï';
            }
            if (statusText) {
                statusText.textContent = message;
            }
        }

        // ÊòæÁ§∫ÊàêÂäüÁä∂ÊÄÅ
        function showSuccess(input, errorElement, statusElement, statusText, message) {
            input.classList.remove('error');
            input.classList.add('success');
            if (errorElement) {
                errorElement.classList.remove('show');
            }
            if (statusElement) {
                statusElement.className = 'status-icon status-valid';
                statusElement.textContent = '‚úì';
            }
            if (statusText) {
                statusText.textContent = message;
            }
        }

        // Â§ÑÁêÜÊñá‰ª∂‰∏ä‰º†
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            // È™åËØÅÊñá‰ª∂Á±ªÂûã
            if (!file.type.startsWith('image/')) {
                notification.error('ËØ∑ÈÄâÊã©ÂõæÁâáÊñá‰ª∂');
                return;
            }

            // È™åËØÅÊñá‰ª∂Â§ßÂ∞èÔºàÊúÄÂ§ß5MBÔºâ
            if (file.size > 5 * 1024 * 1024) {
                notification.error('Êñá‰ª∂Â§ßÂ∞è‰∏çËÉΩË∂ÖËøá5MB');
                return;
            }

            avatarFile = file;

            // ÊòæÁ§∫È¢ÑËßà
            const reader = new FileReader();
            reader.onload = function(e) {
                const previewImage = document.getElementById('previewImage');
                const filePreview = document.getElementById('filePreview');
                previewImage.src = e.target.result;
                filePreview.classList.add('show');
            };
            reader.readAsDataURL(file);

            notification.success('Êñá‰ª∂ÈÄâÊã©ÊàêÂäü');
        }

        // Êî∂ÈõÜË°®ÂçïÊï∞ÊçÆ
        function collectFormData() {
            const formData = {
                username: document.getElementById('username').value.trim(),
                email: document.getElementById('email').value.trim(),
                password: document.getElementById('password').value,
                fullName: document.getElementById('fullName').value.trim(),
                gender: genderSelect.getValue(),
                                 birthDate: formatDateOnlyFromPicker(birthDatePicker.getValue()),
                phone: document.getElementById('phone').value.trim(),
                userType: userTypeSelect.getValue(),
                quantity: quantityInput.getValue(),
                interests: interestsCheckbox.checkboxes.map((cb, index) => cb.isChecked() ? interestsCheckbox.checkboxes[index].options.label : null).filter(Boolean),
                notifications: notificationCheckbox.checkboxes.map((cb, index) => cb.isChecked() ? notificationCheckbox.checkboxes[index].options.label : null).filter(Boolean),
                                 agreement: agreementCheckbox.isChecked(),
                referralCode: document.getElementById('referralCode').value.trim(),
                avatar: avatarFile ? avatarFile.name : null,
                                 registrationTime: formatDateTime(new Date())
            };

            return formData;
        }

        // È™åËØÅÂπ∂Êèê‰∫§Ë°®Âçï
        function validateAndSubmit() {
            // È™åËØÅÂøÖÂ°´Â≠óÊÆµ
            const validations = [
                validateUsername(),
                validateEmail(),
                validatePassword(),
                validateConfirmPassword(),
                validateFullName(),
                validatePhone()
            ];

            if (validations.some(v => !v)) {
                notification.error('ËØ∑Ê£ÄÊü•Ë°®Âçï‰∏≠ÁöÑÈîôËØØ‰ø°ÊÅØ');
                return;
            }

                         // Ê£ÄÊü•ÂçèËÆÆÂêåÊÑè
             if (!agreementCheckbox.isChecked()) {
                 notification.error('ËØ∑ÂÖàÂêåÊÑèÁî®Êà∑ÂçèËÆÆÂíåÈöêÁßÅÊîøÁ≠ñ');
                 return;
             }

            // Êî∂ÈõÜË°®ÂçïÊï∞ÊçÆ
            const data = collectFormData();

            // ÊòæÁ§∫Á°ÆËÆ§ÂØπËØùÊ°Ü
            modal.confirm('Á°ÆËÆ§Êèê‰∫§Ê≥®ÂÜå‰ø°ÊÅØÂêóÔºü').then(confirmed => {
                if (confirmed) {
                    submitForm(data);
                }
            });
        }

        // Êèê‰∫§Ë°®Âçï
        function submitForm(data) {
            // ÊòæÁ§∫‰∏ä‰º†ËøõÂ∫¶
            const progressBar = document.getElementById('uploadProgress');
            const progressFill = document.getElementById('progressFill');
            progressBar.classList.add('show');

            // Ê®°Êãü‰∏ä‰º†ËøõÂ∫¶
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 20;
                if (progress > 90) progress = 90;
                progressFill.style.width = progress + '%';
            }, 200);

            // ÂèëÈÄÅPOSTËØ∑Ê±Ç
            const jsonData = JSON.stringify(data);
        httpPost(
            'https://jsonplaceholder.typicode.com/posts/',
                jsonData,
                (responseText) => {
                    clearInterval(progressInterval);
                    progressFill.style.width = '100%';

                    setTimeout(() => {
                        progressBar.classList.remove('show');
                        showResult(data, responseText);
                        notification.success('Ê≥®ÂÜåÊàêÂäüÔºÅ');
                    }, 500);
                },
                (error) => {
                    clearInterval(progressInterval);
                    progressBar.classList.remove('show');
                    notification.error('Ê≥®ÂÜåÂ§±Ë¥•ÔºåËØ∑ÈáçËØï');
                    console.error('Submit error:', error);
                }
            );
        }

        // ÊòæÁ§∫ÁªìÊûú
        function showResult(formData, responseText) {
            const resultContainer = document.getElementById('resultContainer');
            const resultData = document.getElementById('resultData');

            let template = '';
            for (const [key, value] of Object.entries(formData)) {
                if (value !== null && value !== undefined && value !== '') {
                                         let displayValue = value;
                     if (Array.isArray(value)) {
                         displayValue = value.join(', ');
                     } else if (typeof value === 'boolean') {
                         displayValue = value ? 'ÊòØ' : 'Âê¶';
                     } else if (key === 'birthDate') {
                         // Ê†ºÂºèÂåñÂá∫ÁîüÊó•ÊúüÔºà‰ªÖÊòæÁ§∫Êó•ÊúüÈÉ®ÂàÜÔºâ
                         try {
                             if (typeof value === 'string' && value.includes('T')) {
                                 const date = new Date(value);
                                 if (!isNaN(date.getTime())) {
                                     displayValue = formatDateOnly(date);
                                 }
                             } else if (typeof value === 'string' && value.match(/^\d{4}-\d{2}-\d{2}/)) {
                                 displayValue = value;
                             } else {
                                 displayValue = value;
                             }
                         } catch (e) {
                             displayValue = value;
                         }
                     } else if (key === 'registrationTime') {
                         // Ê†ºÂºèÂåñÊ≥®ÂÜåÊó∂Èó¥ÔºàÊòæÁ§∫ÂÆåÊï¥ÁöÑÊó•ÊúüÊó∂Èó¥Ôºâ
                         try {
                             if (typeof value === 'string' && value.includes('T')) {
                                 const date = new Date(value);
                                 if (!isNaN(date.getTime())) {
                                     displayValue = formatDateTime(date);
                                 }
                             } else if (typeof value === 'string' && value.match(/^\d{4}-\d{2}-\d{2}/)) {
                                 displayValue = value;
                             } else {
                                 displayValue = value;
                             }
                         } catch (e) {
                             displayValue = value;
                         }
                     }
                    
                        template += `
                        <div class="result-row">
                            <div class="result-label">${getFieldLabel(key)}:</div>
                            <div class="result-value">${displayValue}</div>
                            </div>
                    `;
                }
            }

            resultData.innerHTML = template;
            resultContainer.classList.add('show');
            resultContainer.scrollIntoView({ behavior: 'smooth' });
        }

                 // Ê†ºÂºèÂåñÊó•ÊúüÊó∂Èó¥
         function formatDateTime(date) {
             const year = date.getFullYear();
             const month = String(date.getMonth() + 1).padStart(2, '0');
             const day = String(date.getDate()).padStart(2, '0');
             const hours = String(date.getHours()).padStart(2, '0');
             const minutes = String(date.getMinutes()).padStart(2, '0');
             const seconds = String(date.getSeconds()).padStart(2, '0');
             return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
         }

         // Ê†ºÂºèÂåñÊó•ÊúüÈÄâÊã©Âô®ÁöÑÂÄº
         function formatDateTimeFromPicker(pickerValue) {
             if (!pickerValue) return '';
             // Â∞Ü YYYY-MM-DDTHH:mm Ê†ºÂºèËΩ¨Êç¢‰∏∫ YYYY-MM-DD HH:mm:ss
             const date = new Date(pickerValue);
             if (isNaN(date.getTime())) return pickerValue;
             return formatDateTime(date);
         }

         // Ê†ºÂºèÂåñÊó•ÊúüÔºà‰ªÖÊó•ÊúüÈÉ®ÂàÜÔºâ
         function formatDateOnly(date) {
             const year = date.getFullYear();
             const month = String(date.getMonth() + 1).padStart(2, '0');
             const day = String(date.getDate()).padStart(2, '0');
             return `${year}-${month}-${day}`;
         }

         // Ê†ºÂºèÂåñÊó•ÊúüÈÄâÊã©Âô®ÁöÑÂÄº‰∏∫‰ªÖÊó•ÊúüÊ†ºÂºè
         function formatDateOnlyFromPicker(pickerValue) {
             if (!pickerValue) return '';
             const date = new Date(pickerValue);
             if (isNaN(date.getTime())) return pickerValue;
             return formatDateOnly(date);
         }

         // Ëé∑ÂèñÂ≠óÊÆµÊ†áÁ≠æ
         function getFieldLabel(key) {
            const labels = {
                username: 'Áî®Êà∑Âêç',
                email: 'ÈÇÆÁÆ±Âú∞ÂùÄ',
                password: 'ÂØÜÁ†Å',
                fullName: 'ÁúüÂÆûÂßìÂêç',
                gender: 'ÊÄßÂà´',
                birthDate: 'Âá∫ÁîüÊó•Êúü',
                phone: 'ÊâãÊú∫Âè∑Á†Å',
                userType: 'Áî®Êà∑Á±ªÂûã',
                quantity: 'Ê≥®ÂÜåÊï∞Èáè',
                interests: 'ÂÖ¥Ë∂£Áà±Â•Ω',
                notifications: 'ÈÄöÁü•ËÆæÁΩÆ',
                agreement: 'ÂçèËÆÆÂêåÊÑè',
                referralCode: 'Êé®ËçêÁ†Å',
                avatar: 'Â§¥ÂÉèÊñá‰ª∂',
                registrationTime: 'Ê≥®ÂÜåÊó∂Èó¥'
            };
            return labels[key] || key;
        }

        // ÈáçÁΩÆË°®Âçï
        function resetForm() {
            modal.confirm('Á°ÆÂÆöË¶ÅÈáçÁΩÆË°®ÂçïÂêóÔºüÊâÄÊúâÊï∞ÊçÆÂ∞Ü‰∏¢Â§±„ÄÇ').then(confirmed => {
                if (confirmed) {
                    document.getElementById('registrationForm').reset();
                    
                    // ÈáçÁΩÆÊèí‰ª∂
                    genderSelect.setValue('');
                    userTypeSelect.setValue('');
                    birthDatePicker.setValue('');
                    quantityInput.setValue(1);
                    
                    // ÈáçÁΩÆÂ§çÈÄâÊ°Ü
                    interestsCheckbox.checkboxes.forEach(cb => cb.setChecked(false));
                    notificationCheckbox.checkboxes.forEach(cb => cb.setChecked(false));
                                         agreementCheckbox.setChecked(false);

                    // Ê∏ÖÈô§Êñá‰ª∂È¢ÑËßà
                    document.getElementById('filePreview').classList.remove('show');
                    avatarFile = null;

                    // ÈöêËóèÁªìÊûú
                    document.getElementById('resultContainer').classList.remove('show');

                    // Ê∏ÖÈô§È™åËØÅÁä∂ÊÄÅ
                    document.querySelectorAll('.form-control').forEach(input => {
                        input.classList.remove('error', 'success');
                    });
                    document.querySelectorAll('.error-message').forEach(error => {
                        error.classList.remove('show');
                    });

                    notification.info('Ë°®ÂçïÂ∑≤ÈáçÁΩÆ');
                }
            });
        }

        // ÁîüÊàêÊºîÁ§∫Êï∞ÊçÆ
        function generateDemoData() {
            const demoData = {
                username: 'demo_user_' + Math.floor(Math.random() * 1000),
                email: `demo${Math.floor(Math.random() * 1000)}@example.com`,
                password: 'DemoPass123!',
                fullName: 'ÊºîÁ§∫Áî®Êà∑',
                phone: '13800138000'
            };

            // Â°´ÂÖÖË°®Âçï
            document.getElementById('username').value = demoData.username;
            document.getElementById('email').value = demoData.email;
            document.getElementById('password').value = demoData.password;
            document.getElementById('confirmPassword').value = demoData.password;
            document.getElementById('fullName').value = demoData.fullName;
            document.getElementById('phone').value = demoData.phone;

            // ËÆæÁΩÆÊèí‰ª∂ÂÄº
            genderSelect.setValue('male');
            userTypeSelect.setValue('personal');
                         birthDatePicker.setValue('1990-01-01T00:00:00');
            quantityInput.setValue(1);

            // ËÆæÁΩÆÂ§çÈÄâÊ°Ü
            interestsCheckbox.checkboxes[0].setChecked(true);
            interestsCheckbox.checkboxes[2].setChecked(true);
            notificationCheckbox.checkboxes[0].setChecked(true);
            notificationCheckbox.checkboxes[2].setChecked(true);
                         agreementCheckbox.setChecked(true);

            // Ëß¶ÂèëÈ™åËØÅ
            validateUsername();
            validateEmail();
            validatePassword();
            validateConfirmPassword();
            validateFullName();
            validatePhone();

            notification.success('ÊºîÁ§∫Êï∞ÊçÆÂ∑≤ÁîüÊàê');
        }

        // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>

</html>