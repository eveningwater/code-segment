<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>智能代码格式化与文档生成系统 - indentString函数实战示例</title>
    <link rel="stylesheet" href="../../demo/plugins/modal/style.css">
    <link rel="stylesheet" href="../../demo/plugins/notification/style.css">
    <link rel="stylesheet" href="../../demo/plugins/select/style.css">
    <link rel="stylesheet" href="../../demo/plugins/checkbox/style.css">
    <link rel="stylesheet" href="../../demo/plugins/datetime-picker/style.css">
    <link rel="stylesheet" href="../../demo/plugins/input-number/style.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
        }

        .control-panel {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            border: 2px solid #e9ecef;
            margin-bottom: 30px;
        }

        .control-section {
            margin-bottom: 25px;
        }

        .control-section h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.1em;
            border-bottom: 2px solid #667eea;
            padding-bottom: 8px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 0.9em;
        }

        .controls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 14px;
            margin: 5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(40, 167, 69, 0.4);
        }

        .btn-warning {
            background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%);
            color: #212529;
        }

        .btn-warning:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 193, 7, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, #dc3545 0%, #e74c3c 100%);
            color: white;
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(220, 53, 69, 0.4);
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 15px;
            padding: 25px;
            transition: all 0.3s ease;
        }

        .card:hover {
            border-color: #667eea;
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e9ecef;
        }

        .card-icon {
            font-size: 1.5em;
        }

        .card-title {
            font-size: 1.2em;
            font-weight: 600;
            color: #333;
        }

        .editor-container {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .editor-toolbar {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .code-editor {
            width: 100%;
            min-height: 300px;
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
            resize: vertical;
            background: #2d3748;
            color: #e2e8f0;
        }

        .code-editor:focus {
            outline: none;
            border-color: #667eea;
        }

        .output-container {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .output-display {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            min-height: 200px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
            white-space: pre-wrap;
            overflow-x: auto;
        }

        .template-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .template-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .template-card:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .template-card.selected {
            border-color: #28a745;
            background: #f8fff9;
        }

        .template-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .template-icon {
            font-size: 1.2em;
        }

        .template-name {
            font-weight: 600;
            color: #333;
        }

        .template-description {
            color: #666;
            font-size: 0.9em;
            line-height: 1.4;
        }

        .formatting-options {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .option-group {
            margin-bottom: 15px;
        }

        .option-label {
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            display: block;
        }

        .option-controls {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .indent-preview {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            margin-top: 10px;
            white-space: pre;
            overflow-x: auto;
        }

        .document-generator {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .generator-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .generated-document {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            min-height: 300px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
            white-space: pre-wrap;
            overflow-x: auto;
        }

        .stats-panel {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            max-height: 300px;
            overflow-y: auto;
        }

        .stats-entry {
            margin-bottom: 8px;
            padding: 5px 0;
            border-bottom: 1px solid #4a5568;
        }

        .stats-time {
            color: #a0aec0;
            margin-right: 10px;
        }

        .stats-action {
            color: #63b3ed;
        }

        .stats-result {
            margin-left: 10px;
        }

        .stats-result.success {
            color: #68d391;
        }

        .stats-result.warning {
            color: #f6ad55;
        }

        .stats-result.error {
            color: #fc8181;
        }

        .code-snippets {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .snippet-item {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .snippet-item:hover {
            border-color: #667eea;
            transform: translateX(5px);
        }

        .snippet-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .snippet-name {
            font-weight: 600;
            color: #333;
        }

        .snippet-language {
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .language-js {
            background: #f7df1e;
            color: #000;
        }

        .language-python {
            background: #3776ab;
            color: white;
        }

        .language-html {
            background: #e34c26;
            color: white;
        }

        .language-css {
            background: #1572b6;
            color: white;
        }

        .snippet-code {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            color: #333;
            white-space: pre-wrap;
            max-height: 100px;
            overflow-y: auto;
        }

        .comparison-view {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .comparison-panel {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
        }

        .comparison-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
            text-align: center;
        }

        .comparison-content {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 10px;
            min-height: 200px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            white-space: pre-wrap;
            overflow-x: auto;
        }

        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .controls-grid {
                grid-template-columns: 1fr;
            }
            
            .template-grid {
                grid-template-columns: 1fr;
            }
            
            .comparison-view {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>💻 智能代码格式化与文档生成系统</h1>
            <p>基于 indentString 函数的实战示例 - 代码缩进、格式化、文档生成</p>
        </div>

        <div class="content">
            <!-- 控制面板 -->
            <div class="control-panel">
                <div class="control-section">
                    <h3>⚙️ 格式化配置</h3>
                    <div class="controls-grid">
                        <div class="form-group">
                            <label>缩进类型</label>
                            <div id="indentTypeSelect"></div>
                        </div>
                        <div class="form-group">
                            <label>缩进数量</label>
                            <div id="indentCountInput"></div>
                        </div>
                        <div class="form-group">
                            <label>语言类型</label>
                            <div id="languageTypeSelect"></div>
                        </div>
                        <div class="form-group">
                            <label>自动格式化</label>
                            <div id="autoFormatCheckbox"></div>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="formatCode()">格式化代码</button>
                    <button class="btn btn-success" onclick="generateDocument()">生成文档</button>
                    <button class="btn btn-warning" onclick="applyTemplate()">应用模板</button>
                    <button class="btn btn-danger" onclick="clearAll()">清除全部</button>
                </div>
            </div>

            <!-- 仪表板 -->
            <div class="dashboard">
                <!-- 代码编辑器 -->
                <div class="card">
                    <div class="card-header">
                        <span class="card-icon">📝</span>
                        <span class="card-title">代码编辑器</span>
                    </div>
                    <div class="editor-container">
                        <div class="editor-toolbar">
                            <button class="btn btn-primary" onclick="loadSnippet()">加载代码片段</button>
                            <button class="btn btn-success" onclick="saveSnippet()">保存代码</button>
                            <button class="btn btn-warning" onclick="clearEditor()">清空编辑器</button>
                        </div>
                        <textarea id="codeEditor" class="code-editor" placeholder="在这里输入代码..."></textarea>
                    </div>
                </div>

                <!-- 格式化选项 -->
                <div class="card">
                    <div class="card-header">
                        <span class="card-icon">🔧</span>
                        <span class="card-title">格式化选项</span>
                    </div>
                    <div class="formatting-options">
                        <div class="option-group">
                            <label class="option-label">缩进字符</label>
                            <div class="option-controls">
                                <div id="indentCharSelect"></div>
                                <div id="indentSizeInput"></div>
                            </div>
                        </div>
                        <div class="option-group">
                            <label class="option-label">缩进预览</label>
                            <div class="indent-preview" id="indentPreview">
function example() {
    if (condition) {
        console.log('Hello World');
    }
}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 代码片段库 -->
                <div class="card">
                    <div class="card-header">
                        <span class="card-icon">📚</span>
                        <span class="card-title">代码片段库</span>
                    </div>
                    <div class="code-snippets" id="codeSnippets">
                        <!-- 代码片段将在这里显示 -->
                    </div>
                </div>
            </div>

            <!-- 模板选择 -->
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">📋</span>
                    <span class="card-title">文档模板</span>
                </div>
                <div class="template-grid" id="templateGrid">
                    <!-- 模板卡片将在这里生成 -->
                </div>
            </div>

            <!-- 文档生成器 -->
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">📄</span>
                    <span class="card-title">文档生成器</span>
                </div>
                <div class="document-generator">
                    <div class="generator-form">
                        <div class="form-group">
                            <label>项目名称</label>
                            <div id="projectNameInput"></div>
                        </div>
                        <div class="form-group">
                            <label>作者</label>
                            <div id="authorInput"></div>
                        </div>
                        <div class="form-group">
                            <label>版本</label>
                            <div id="versionInput"></div>
                        </div>
                        <div class="form-group">
                            <label>描述</label>
                            <div id="descriptionInput"></div>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="generateReadme()">生成 README</button>
                    <button class="btn btn-success" onclick="generateApiDoc()">生成 API 文档</button>
                    <div class="generated-document" id="generatedDocument">
                        <!-- 生成的文档将在这里显示 -->
                    </div>
                </div>
            </div>

            <!-- 对比视图 -->
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">🔍</span>
                    <span class="card-title">格式化对比</span>
                </div>
                <div class="comparison-view">
                    <div class="comparison-panel">
                        <div class="comparison-title">原始代码</div>
                        <div class="comparison-content" id="originalCode">
                            <!-- 原始代码将在这里显示 -->
                        </div>
                    </div>
                    <div class="comparison-panel">
                        <div class="comparison-title">格式化后</div>
                        <div class="comparison-content" id="formattedCode">
                            <!-- 格式化后的代码将在这里显示 -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- 输出结果 -->
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">📤</span>
                    <span class="card-title">输出结果</span>
                </div>
                <div class="output-container">
                    <div class="output-display" id="outputDisplay">
                        <!-- 输出结果将在这里显示 -->
                    </div>
                </div>
            </div>

            <!-- 操作统计 -->
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">📈</span>
                    <span class="card-title">操作统计</span>
                </div>
                <div class="stats-panel" id="statsPanel">
                    <!-- 统计信息将在这里显示 -->
                </div>
            </div>
        </div>
    </div>

    <!-- 引入插件 -->
    <script src="../../demo/plugins/modal/index.js"></script>
    <script src="../../demo/plugins/notification/index.js"></script>
    <script src="../../demo/plugins/select/index.js"></script>
    <script src="../../demo/plugins/checkbox/index.js"></script>
    <script src="../../demo/plugins/datetime-picker/index.js"></script>
    <script src="../../demo/plugins/input-number/index.js"></script>

    <script>
        // 全局变量
        let modal, notification;
        let indentTypeSelect, indentCountInput, languageTypeSelect, autoFormatCheckbox;
        let indentCharSelect, indentSizeInput;
        let projectNameInput, authorInput, versionInput, descriptionInput;
        let codeSnippets = [];
        let templates = [];
        let operationHistory = [];

        // indentString 函数
        const indentString = (str, count, indent = ' ') => str.replace(/^/gm, indent.repeat(count));

        // 初始化应用
        function initApp() {
            // 初始化插件
            modal = new Modal();
            notification = new Notification({ position: 'top-right' });

            // 初始化选择控件
            indentTypeSelect = new Select({
                container: document.getElementById('indentTypeSelect'),
                options: [
                    { value: 'space', label: '空格' },
                    { value: 'tab', label: '制表符' },
                    { value: 'custom', label: '自定义' }
                ],
                placeholder: '选择缩进类型'
            });

            indentCountInput = new InputNumber({
                container: document.getElementById('indentCountInput'),
                min: 1,
                max: 8,
                value: 2,
                step: 1
            });

            languageTypeSelect = new Select({
                container: document.getElementById('languageTypeSelect'),
                options: [
                    { value: 'javascript', label: 'JavaScript' },
                    { value: 'python', label: 'Python' },
                    { value: 'html', label: 'HTML' },
                    { value: 'css', label: 'CSS' },
                    { value: 'json', label: 'JSON' }
                ],
                placeholder: '选择语言类型'
            });

            autoFormatCheckbox = new Checkbox({
                label: '启用自动格式化',
                checked: true,
                onChange: (checked) => {
                    console.log('自动格式化状态:', checked);
                }
            });
            autoFormatCheckbox.mount(document.getElementById('autoFormatCheckbox'));

            // 初始化格式化选项控件
            indentCharSelect = new Select({
                container: document.getElementById('indentCharSelect'),
                options: [
                    { value: ' ', label: '空格' },
                    { value: '\t', label: '制表符' },
                    { value: '  ', label: '双空格' },
                    { value: '    ', label: '四个空格' }
                ],
                placeholder: '选择缩进字符'
            });

            indentSizeInput = new InputNumber({
                container: document.getElementById('indentSizeInput'),
                min: 1,
                max: 8,
                value: 2,
                step: 1
            });

            // 初始化文档生成器控件
            projectNameInput = new InputNumber({
                container: document.getElementById('projectNameInput'),
                placeholder: '输入项目名称'
            });

            authorInput = new InputNumber({
                container: document.getElementById('authorInput'),
                placeholder: '输入作者名称'
            });

            versionInput = new InputNumber({
                container: document.getElementById('versionInput'),
                placeholder: '输入版本号'
            });

            descriptionInput = new InputNumber({
                container: document.getElementById('descriptionInput'),
                placeholder: '输入项目描述'
            });

            // 初始化数据
            initializeData();

            // 初始化界面
            updateCodeSnippets();
            updateTemplates();
            updateIndentPreview();
            addStatsLog('系统初始化完成', 'info');

            // 绑定事件
            indentCharSelect.onChange = updateIndentPreview;
            indentSizeInput.onChange = updateIndentPreview;
        }

        // 初始化数据
        function initializeData() {
            // 初始化代码片段
            codeSnippets = [
                {
                    id: 1,
                    name: 'JavaScript 函数',
                    language: 'js',
                    code: `function calculateSum(a, b) {
return a + b;
}

function processData(data) {
const result = data.map(item => {
return item * 2;
});
return result;
}`
                },
                {
                    id: 2,
                    name: 'Python 类',
                    language: 'python',
                    code: `class Calculator:
def __init__(self):
self.result = 0

def add(self, x, y):
return x + y

def multiply(self, x, y):
return x * y

def get_result(self):
return self.result`
                },
                {
                    id: 3,
                    name: 'HTML 结构',
                    language: 'html',
                    code: `<div class="container">
<div class="header">
<h1>标题</h1>
</div>
<div class="content">
<p>内容</p>
</div>
</div>`
                },
                {
                    id: 4,
                    name: 'CSS 样式',
                    language: 'css',
                    code: `.container {
background: #fff;
padding: 20px;
}

.header {
color: #333;
font-size: 24px;
}

.content {
margin: 10px 0;
}`
                }
            ];

            // 初始化模板
            templates = [
                {
                    id: 1,
                    name: 'README.md',
                    icon: '📖',
                    description: '标准的项目 README 文档模板',
                    content: `# {projectName}

{description}

## 安装

\`\`\`bash
npm install {projectName}
\`\`\`

## 使用方法

\`\`\`javascript
const {projectName} = require('{projectName}');
\`\`\`

## 作者

{author}

## 版本

{version}`
                },
                {
                    id: 2,
                    name: 'API 文档',
                    icon: '📚',
                    description: 'API 接口文档模板',
                    content: `# {projectName} API 文档

## 概述

{description}

## 接口列表

### GET /api/data

获取数据列表

**参数:**
- page: 页码
- limit: 每页数量

**响应:**
\`\`\`json
{
  "code": 200,
  "data": [],
  "message": "success"
}
\`\`\`

## 版本信息

- 版本: {version}
- 作者: {author}`
                },
                {
                    id: 3,
                    name: '配置文件',
                    icon: '⚙️',
                    description: '项目配置文件模板',
                    content: `{
  "name": "{projectName}",
  "version": "{version}",
  "description": "{description}",
  "author": "{author}",
  "main": "index.js",
  "scripts": {
    "start": "node index.js",
    "test": "jest",
    "build": "webpack"
  },
  "dependencies": {
    "express": "^4.17.1"
  },
  "devDependencies": {
    "jest": "^27.0.0"
  }
}`
                }
            ];
        }

        // 更新代码片段
        function updateCodeSnippets() {
            const container = document.getElementById('codeSnippets');
            container.innerHTML = '';

            codeSnippets.forEach(snippet => {
                const item = document.createElement('div');
                item.className = 'snippet-item';
                item.onclick = () => loadSnippetById(snippet.id);

                item.innerHTML = `
                    <div class="snippet-header">
                        <span class="snippet-name">${snippet.name}</span>
                        <span class="snippet-language language-${snippet.language}">${snippet.language.toUpperCase()}</span>
                    </div>
                    <div class="snippet-code">${snippet.code}</div>
                `;

                container.appendChild(item);
            });
        }

        // 更新模板
        function updateTemplates() {
            const container = document.getElementById('templateGrid');
            container.innerHTML = '';

            templates.forEach(template => {
                const card = document.createElement('div');
                card.className = 'template-card';
                card.onclick = () => selectTemplate(template.id);

                card.innerHTML = `
                    <div class="template-header">
                        <span class="template-icon">${template.icon}</span>
                        <span class="template-name">${template.name}</span>
                    </div>
                    <div class="template-description">${template.description}</div>
                `;

                container.appendChild(card);
            });
        }

        // 更新缩进预览
        function updateIndentPreview() {
            const indentChar = indentCharSelect.getValue() || ' ';
            const indentSize = indentSizeInput.getValue() || 2;
            const previewCode = `function example() {
if (condition) {
console.log('Hello World');
}
}`;

            const formattedCode = indentString(previewCode, indentSize, indentChar);
            document.getElementById('indentPreview').textContent = formattedCode;
        }

        // 格式化代码
        function formatCode() {
            const code = document.getElementById('codeEditor').value;
            const indentType = indentTypeSelect.getValue();
            const indentCount = indentCountInput.getValue();
            const language = languageTypeSelect.getValue();

            if (!code.trim()) {
                notification.error('请先输入代码');
                return;
            }

            let indentChar = ' ';
            if (indentType === 'tab') {
                indentChar = '\t';
            } else if (indentType === 'custom') {
                indentChar = indentCharSelect.getValue() || ' ';
            }

            const formattedCode = indentString(code, indentCount, indentChar);

            // 更新对比视图
            document.getElementById('originalCode').textContent = code;
            document.getElementById('formattedCode').textContent = formattedCode;

            // 更新输出显示
            document.getElementById('outputDisplay').textContent = formattedCode;

            // 更新编辑器
            document.getElementById('codeEditor').value = formattedCode;

            addStatsLog(`格式化代码 (${language}, ${indentCount}${indentType})`, 'success');
            notification.success('代码格式化完成');
        }

        // 生成文档
        function generateDocument() {
            const projectName = projectNameInput.getValue() || 'MyProject';
            const author = authorInput.getValue() || 'Developer';
            const version = versionInput.getValue() || '1.0.0';
            const description = descriptionInput.getValue() || 'A wonderful project';

            const template = templates.find(t => t.selected);
            if (!template) {
                notification.error('请先选择一个模板');
                return;
            }

            let content = template.content;
            content = content.replace(/{projectName}/g, projectName);
            content = content.replace(/{author}/g, author);
            content = content.replace(/{version}/g, version);
            content = content.replace(/{description}/g, description);

            document.getElementById('generatedDocument').textContent = content;
            addStatsLog(`生成文档: ${template.name}`, 'success');
            notification.success('文档生成完成');
        }

        // 应用模板
        function applyTemplate() {
            const template = templates.find(t => t.selected);
            if (!template) {
                notification.error('请先选择一个模板');
                return;
            }

            const code = document.getElementById('codeEditor').value;
            const indentCount = indentCountInput.getValue();
            const indentChar = indentCharSelect.getValue() || ' ';

            const formattedTemplate = indentString(template.content, indentCount, indentChar);
            document.getElementById('codeEditor').value = formattedTemplate;

            addStatsLog(`应用模板: ${template.name}`, 'success');
            notification.success('模板应用完成');
        }

        // 选择模板
        function selectTemplate(templateId) {
            templates.forEach(t => t.selected = false);
            const template = templates.find(t => t.id === templateId);
            if (template) {
                template.selected = true;
            }

            // 更新UI
            document.querySelectorAll('.template-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.target.closest('.template-card').classList.add('selected');
        }

        // 加载代码片段
        function loadSnippet() {
            const snippets = codeSnippets.map(s => ({ value: s.id, label: s.name }));
            modal.prompt('选择代码片段:', snippets).then(snippetId => {
                if (snippetId) {
                    loadSnippetById(parseInt(snippetId));
                }
            });
        }

        // 根据ID加载代码片段
        function loadSnippetById(snippetId) {
            const snippet = codeSnippets.find(s => s.id === snippetId);
            if (snippet) {
                document.getElementById('codeEditor').value = snippet.code;
                languageTypeSelect.setValue(snippet.language);
                addStatsLog(`加载代码片段: ${snippet.name}`, 'info');
                notification.success(`已加载 ${snippet.name}`);
            }
        }

        // 保存代码片段
        function saveSnippet() {
            const code = document.getElementById('codeEditor').value.trim();
            if (!code) {
                notification.error('请先输入代码');
                return;
            }

            modal.prompt('输入代码片段名称:').then(name => {
                if (name) {
                    const newSnippet = {
                        id: codeSnippets.length + 1,
                        name: name,
                        language: languageTypeSelect.getValue() || 'js',
                        code: code
                    };
                    codeSnippets.push(newSnippet);
                    updateCodeSnippets();
                    addStatsLog(`保存代码片段: ${name}`, 'success');
                    notification.success('代码片段保存成功');
                }
            });
        }

        // 生成 README
        function generateReadme() {
            const projectName = projectNameInput.getValue() || 'MyProject';
            const author = authorInput.getValue() || 'Developer';
            const version = versionInput.getValue() || '1.0.0';
            const description = descriptionInput.getValue() || 'A wonderful project';

            const readmeContent = `# ${projectName}

${description}

## 安装

\`\`\`bash
npm install ${projectName}
\`\`\`

## 使用方法

\`\`\`javascript
const ${projectName} = require('${projectName}');
\`\`\`

## 作者

${author}

## 版本

${version}`;

            document.getElementById('generatedDocument').textContent = readmeContent;
            addStatsLog('生成 README 文档', 'success');
            notification.success('README 生成完成');
        }

        // 生成 API 文档
        function generateApiDoc() {
            const projectName = projectNameInput.getValue() || 'MyProject';
            const author = authorInput.getValue() || 'Developer';
            const version = versionInput.getValue() || '1.0.0';
            const description = descriptionInput.getValue() || 'A wonderful project';

            const apiContent = `# ${projectName} API 文档

## 概述

${description}

## 接口列表

### GET /api/data

获取数据列表

**参数:**
- page: 页码
- limit: 每页数量

**响应:**
\`\`\`json
{
  "code": 200,
  "data": [],
  "message": "success"
}
\`\`\`

## 版本信息

- 版本: ${version}
- 作者: ${author}`;

            document.getElementById('generatedDocument').textContent = apiContent;
            addStatsLog('生成 API 文档', 'success');
            notification.success('API 文档生成完成');
        }

        // 清除编辑器
        function clearEditor() {
            modal.confirm('确定要清空编辑器吗？').then(confirmed => {
                if (confirmed) {
                    document.getElementById('codeEditor').value = '';
                    notification.success('编辑器已清空');
                }
            });
        }

        // 清除全部
        function clearAll() {
            modal.confirm('确定要清除所有内容吗？').then(confirmed => {
                if (confirmed) {
                    document.getElementById('codeEditor').value = '';
                    document.getElementById('outputDisplay').textContent = '';
                    document.getElementById('generatedDocument').textContent = '';
                    document.getElementById('originalCode').textContent = '';
                    document.getElementById('formattedCode').textContent = '';
                    addStatsLog('清除所有内容', 'info');
                    notification.success('所有内容已清除');
                }
            });
        }

        // 添加统计日志
        function addStatsLog(action, status) {
            const timestamp = new Date();
            const logEntry = {
                time: timestamp,
                action: action,
                status: status
            };

            operationHistory.unshift(logEntry);
            if (operationHistory.length > 50) {
                operationHistory.pop();
            }

            updateStatsPanel();
        }

        // 更新统计面板
        function updateStatsPanel() {
            const container = document.getElementById('statsPanel');
            
            container.innerHTML = operationHistory.map(entry => `
                <div class="stats-entry">
                    <span class="stats-time">${formatDateTime(entry.time)}</span>
                    <span class="stats-action">${entry.action}</span>
                    <span class="stats-result ${entry.status}">${entry.status}</span>
                </div>
            `).join('');
        }

        // 格式化日期时间
        function formatDateTime(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const hours = String(date.getHours()).padStart(2, '0');
            const minutes = String(date.getMinutes()).padStart(2, '0');
            const seconds = String(date.getSeconds()).padStart(2, '0');
            return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
        }

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>

</html>