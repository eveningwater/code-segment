<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äº¤æ˜“è®°å½•åˆ†æç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        header {
            background-color: #1890ff;
            color: white;
            padding: 20px;
            text-align: center;
        }

        h1 {
            font-size: 24px;
            margin-bottom: 10px;
        }

        .description {
            font-size: 14px;
            opacity: 0.9;
        }

        .main-content {
            display: flex;
            flex-wrap: wrap;
        }

        .filter-panel {
            flex: 1;
            min-width: 300px;
            padding: 20px;
            border-right: 1px solid #eee;
        }

        .result-panel {
            flex: 2;
            min-width: 300px;
            padding: 20px;
        }

        h2 {
            color: #1890ff;
            margin-bottom: 20px;
            font-size: 18px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            font-size: 14px;
        }

        input,
        select {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #d9d9d9;
            border-radius: 4px;
            font-size: 14px;
        }

        input:focus,
        select:focus {
            outline: none;
            border-color: #1890ff;
            box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);
        }

        .btn {
            background-color: #1890ff;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }

        .btn:hover {
            background-color: #40a9ff;
        }

        .btn-secondary {
            background-color: #f5f5f5;
            color: #333;
            margin-left: 10px;
        }

        .btn-secondary:hover {
            background-color: #e6e6e6;
        }

        .transaction-list {
            margin-top: 20px;
        }

        .transaction-card {
            background-color: #fafafa;
            border-radius: 4px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid #1890ff;
            transition: transform 0.3s;
        }

        .transaction-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .transaction-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .transaction-title {
            font-weight: 500;
            font-size: 16px;
        }

        .transaction-amount {
            font-weight: bold;
            font-size: 16px;
        }

        .amount-income {
            color: #52c41a;
        }

        .amount-expense {
            color: #f5222d;
        }

        .transaction-details {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            color: #666;
        }

        .transaction-category {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 12px;
            margin-right: 5px;
        }

        .category-shopping {
            background-color: #fff7e6;
            color: #fa8c16;
        }

        .category-food {
            background-color: #f6ffed;
            color: #52c41a;
        }

        .category-transport {
            background-color: #e6f7ff;
            color: #1890ff;
        }

        .category-entertainment {
            background-color: #f9f0ff;
            color: #722ed1;
        }

        .category-housing {
            background-color: #fff2e8;
            color: #fa541c;
        }

        .category-income {
            background-color: #e6fffb;
            color: #13c2c2;
        }

        .empty-state {
            text-align: center;
            padding: 40px 0;
            color: #999;
        }

        .empty-state i {
            font-size: 48px;
            margin-bottom: 10px;
            display: block;
        }

        .summary-panel {
            background-color: #f0f5ff;
            border-radius: 4px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .summary-title {
            font-weight: 500;
            margin-bottom: 10px;
            color: #1890ff;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }

        .summary-label {
            color: #666;
        }

        .summary-value {
            font-weight: 500;
        }

        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }

            .filter-panel {
                border-right: none;
                border-bottom: 1px solid #eee;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <h1>äº¤æ˜“è®°å½•åˆ†æç³»ç»Ÿ</h1>
            <p class="description">å¿«é€ŸæŸ¥æ‰¾å’Œåˆ†ææ‚¨çš„æœ€è¿‘äº¤æ˜“è®°å½•</p>
        </header>

        <div class="main-content">
            <div class="filter-panel">
                <h2>ç­›é€‰æ¡ä»¶</h2>
                <div class="form-group">
                    <label for="transaction-type">äº¤æ˜“ç±»å‹</label>
                    <select id="transaction-type">
                        <option value="all">å…¨éƒ¨</option>
                        <option value="income">æ”¶å…¥</option>
                        <option value="expense">æ”¯å‡º</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="category">äº¤æ˜“ç±»åˆ«</label>
                    <select id="category">
                        <option value="all">å…¨éƒ¨ç±»åˆ«</option>
                        <option value="shopping">è´­ç‰©</option>
                        <option value="food">é¤é¥®</option>
                        <option value="transport">äº¤é€š</option>
                        <option value="entertainment">å¨±ä¹</option>
                        <option value="housing">ä½æˆ¿</option>
                        <option value="income">å·¥èµ„æ”¶å…¥</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="min-amount">æœ€å°é‡‘é¢</label>
                    <input type="number" id="min-amount" placeholder="0">
                </div>
                <div class="form-group">
                    <label for="max-amount">æœ€å¤§é‡‘é¢</label>
                    <input type="number" id="max-amount" placeholder="ä¸é™">
                </div>
                <div class="form-group">
                    <label for="result-count">æ˜¾ç¤ºç»“æœæ•°é‡</label>
                    <input type="number" id="result-count" value="3" min="1" max="10">
                </div>
                <div>
                    <button id="search-btn" class="btn">æŸ¥æ‰¾äº¤æ˜“</button>
                    <button id="reset-btn" class="btn btn-secondary">é‡ç½®</button>
                </div>
            </div>

            <div class="result-panel">
                <h2>åˆ†æç»“æœ</h2>
                <div id="summary-container"></div>
                <div id="transaction-list" class="transaction-list">
                    <div class="empty-state">
                        <i>ğŸ“Š</i>
                        <p>è¯·ä½¿ç”¨å·¦ä¾§ç­›é€‰æ¡ä»¶æŸ¥æ‰¾äº¤æ˜“è®°å½•</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // findLastN æ–¹æ³•ï¼šä»æ•°ç»„æœ«å°¾å¼€å§‹æŸ¥æ‰¾ç¬¦åˆæ¡ä»¶çš„å…ƒç´ 
        const findLastN = (arr, matcher, n = 1) => {
            const res = [];
            for (let i = arr.length - 1; i >= 0; i--) {
                const el = arr[i];
                const match = matcher(el, i, arr);
                if (match) {
                    res.unshift(el);
                }
                if (res.length === n) {
                    return res;
                }
            }
            return res;
        };

        // æ¨¡æ‹Ÿäº¤æ˜“æ•°æ®
        const transactions = [
            {
                id: 1,
                title: 'è¶…å¸‚è´­ç‰©',
                amount: -258.75,
                type: 'expense',
                category: 'shopping',
                date: '2023-06-15',
                description: 'å‘¨æœ«é‡‡è´­ç”Ÿæ´»ç”¨å“'
            },
            {
                id: 2,
                title: 'å·¥èµ„æ”¶å…¥',
                amount: 8500,
                type: 'income',
                category: 'income',
                date: '2023-06-10',
                description: '6æœˆä»½å·¥èµ„'
            },
            {
                id: 3,
                title: 'é¤å…æ™šé¤',
                amount: -368,
                type: 'expense',
                category: 'food',
                date: '2023-06-08',
                description: 'å’Œæœ‹å‹èšé¤'
            },
            {
                id: 4,
                title: 'ç”µå½±ç¥¨',
                amount: -80,
                type: 'expense',
                category: 'entertainment',
                date: '2023-06-05',
                description: 'è§‚çœ‹æ–°ä¸Šæ˜ ç”µå½±'
            },
            {
                id: 5,
                title: 'å…¬äº¤å¡å……å€¼',
                amount: -100,
                type: 'expense',
                category: 'transport',
                date: '2023-06-03',
                description: 'æœˆåº¦äº¤é€šå¡å……å€¼'
            },
            {
                id: 6,
                title: 'æˆ¿ç§Ÿæ”¯å‡º',
                amount: -2800,
                type: 'expense',
                category: 'housing',
                date: '2023-06-01',
                description: '6æœˆä»½æˆ¿ç§Ÿ'
            },
            {
                id: 7,
                title: 'å…¼èŒæ”¶å…¥',
                amount: 1200,
                type: 'income',
                category: 'income',
                date: '2023-05-28',
                description: 'å‘¨æœ«å…¼èŒæ”¶å…¥'
            },
            {
                id: 8,
                title: 'ç½‘ä¸Šè´­ç‰©',
                amount: -499,
                type: 'expense',
                category: 'shopping',
                date: '2023-05-25',
                description: 'è´­ä¹°æ–°è¡£æœ'
            },
            {
                id: 9,
                title: 'å¤–å–åˆé¤',
                amount: -45,
                type: 'expense',
                category: 'food',
                date: '2023-05-22',
                description: 'å·¥ä½œæ—¥åˆé¤'
            },
            {
                id: 10,
                title: 'å‡ºç§Ÿè½¦',
                amount: -38,
                type: 'expense',
                category: 'transport',
                date: '2023-05-20',
                description: 'åŠ ç­å›å®¶'
            },
            {
                id: 11,
                title: 'æ¸¸æˆè´­ä¹°',
                amount: -199,
                type: 'expense',
                category: 'entertainment',
                date: '2023-05-18',
                description: 'è´­ä¹°æ–°æ¸¸æˆ'
            },
            {
                id: 12,
                title: 'æ°´ç”µè´¹',
                amount: -350,
                type: 'expense',
                category: 'housing',
                date: '2023-05-15',
                description: 'æœˆåº¦æ°´ç”µè´¹'
            },
            {
                id: 13,
                title: 'å¥–é‡‘æ”¶å…¥',
                amount: 2000,
                type: 'income',
                category: 'income',
                date: '2023-05-10',
                description: 'å­£åº¦ç»©æ•ˆå¥–é‡‘'
            },
            {
                id: 14,
                title: 'è¶…å¸‚è´­ç‰©',
                amount: -312.5,
                type: 'expense',
                category: 'shopping',
                date: '2023-05-08',
                description: 'æ—¥å¸¸ç”Ÿæ´»ç”¨å“'
            },
            {
                id: 15,
                title: 'é¤å…èšé¤',
                amount: -520,
                type: 'expense',
                category: 'food',
                date: '2023-05-05',
                description: 'æœ‹å‹ç”Ÿæ—¥èšé¤'
            }
        ];

        // æ ¼å¼åŒ–é‡‘é¢
        const formatAmount = (amount) => {
            const absAmount = Math.abs(amount);
            return absAmount.toFixed(2);
        };

        // æ ¼å¼åŒ–æ—¥æœŸ
        const formatDate = (dateString) => {
            const date = new Date(dateString);
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}å¹´${month}æœˆ${day}æ—¥`;
        };

        // æ¸²æŸ“äº¤æ˜“è®°å½•
        const renderTransactions = (transactions) => {
            const container = document.getElementById('transaction-list');

            if (transactions.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i>ğŸ”</i>
                        <p>æœªæ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„äº¤æ˜“è®°å½•</p>
                    </div>
                `;
                return;
            }

            let html = '';

            transactions.forEach(transaction => {
                const amountClass = transaction.type === 'income' ? 'amount-income' : 'amount-expense';
                const amountSign = transaction.type === 'income' ? '+' : '-';
                const categoryClass = `category-${transaction.category}`;

                html += `
                    <div class="transaction-card">
                        <div class="transaction-header">
                            <div class="transaction-title">${transaction.title}</div>
                            <div class="transaction-amount ${amountClass}">${amountSign}ï¿¥${formatAmount(transaction.amount)}</div>
                        </div>
                        <div class="transaction-details">
                            <div>
                                <span class="transaction-category ${categoryClass}">${getCategoryName(transaction.category)}</span>
                                <span class="transaction-date">${formatDate(transaction.date)}</span>
                            </div>
                            <div class="transaction-description">${transaction.description}</div>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        };

        // è·å–ç±»åˆ«åç§°
        const getCategoryName = (category) => {
            const categoryNames = {
                'shopping': 'è´­ç‰©',
                'food': 'é¤é¥®',
                'transport': 'äº¤é€š',
                'entertainment': 'å¨±ä¹',
                'housing': 'ä½æˆ¿',
                'income': 'æ”¶å…¥'
            };
            return categoryNames[category] || category;
        };

        // æ¸²æŸ“ç»“æœæ‘˜è¦
        const renderSummary = (transactions) => {
            const container = document.getElementById('summary-container');

            if (transactions.length === 0) {
                container.innerHTML = '';
                return;
            }

            // è®¡ç®—æ€»é‡‘é¢
            const totalAmount = transactions.reduce((sum, transaction) => sum + transaction.amount, 0);

            // è®¡ç®—æœ€å¤§äº¤æ˜“
            const maxTransaction = transactions.reduce((max, transaction) =>
                Math.abs(transaction.amount) > Math.abs(max.amount) ? transaction : max, transactions[0]);

            // è®¡ç®—æœ€æ—©å’Œæœ€æ™šæ—¥æœŸ
            const dates = transactions.map(t => new Date(t.date));
            const earliestDate = new Date(Math.min(...dates));
            const latestDate = new Date(Math.max(...dates));

            const html = `
                <div class="summary-panel">
                    <div class="summary-title">æŸ¥è¯¢ç»“æœæ‘˜è¦</div>
                    <div class="summary-item">
                        <span class="summary-label">ç¬¦åˆæ¡ä»¶çš„äº¤æ˜“:</span>
                        <span class="summary-value">${transactions.length}ç¬”</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">æ€»é‡‘é¢:</span>
                        <span class="summary-value ${totalAmount >= 0 ? 'amount-income' : 'amount-expense'}">ï¿¥${formatAmount(totalAmount)}</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">æœ€å¤§äº¤æ˜“:</span>
                        <span class="summary-value">${maxTransaction.title} (ï¿¥${formatAmount(maxTransaction.amount)})</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">æ—¥æœŸèŒƒå›´:</span>
                        <span class="summary-value">${formatDate(earliestDate)} - ${formatDate(latestDate)}</span>
                    </div>
                </div>
            `;

            container.innerHTML = html;
        };

        // æœç´¢äº¤æ˜“è®°å½•
        const searchTransactions = () => {
            const transactionType = document.getElementById('transaction-type').value;
            const category = document.getElementById('category').value;
            const minAmount = document.getElementById('min-amount').value;
            const maxAmount = document.getElementById('max-amount').value;
            const resultCount = parseInt(document.getElementById('result-count').value, 10) || 3;

            // ä½¿ç”¨ findLastN æ–¹æ³•æŸ¥æ‰¾ç¬¦åˆæ¡ä»¶çš„äº¤æ˜“è®°å½•
            const results = findLastN(transactions, transaction => {
                // äº¤æ˜“ç±»å‹ç­›é€‰
                if (transactionType !== 'all' && transaction.type !== transactionType) {
                    return false;
                }

                // ç±»åˆ«ç­›é€‰
                if (category !== 'all' && transaction.category !== category) {
                    return false;
                }

                // é‡‘é¢èŒƒå›´ç­›é€‰
                const amount = Math.abs(transaction.amount);
                if (minAmount && amount < parseFloat(minAmount)) {
                    return false;
                }
                if (maxAmount && amount > parseFloat(maxAmount)) {
                    return false;
                }

                return true;
            }, resultCount);

            renderTransactions(results);
            renderSummary(results);
        };

        // é‡ç½®ç­›é€‰æ¡ä»¶
        const resetFilters = () => {
            document.getElementById('transaction-type').value = 'all';
            document.getElementById('category').value = 'all';
            document.getElementById('min-amount').value = '';
            document.getElementById('max-amount').value = '';
            document.getElementById('result-count').value = '3';

            document.getElementById('transaction-list').innerHTML = `
                <div class="empty-state">
                    <i>ğŸ“Š</i>
                    <p>è¯·ä½¿ç”¨å·¦ä¾§ç­›é€‰æ¡ä»¶æŸ¥æ‰¾äº¤æ˜“è®°å½•</p>
                </div>
            `;

            document.getElementById('summary-container').innerHTML = '';
        };

        // åˆå§‹åŒ–åº”ç”¨
        const initApp = () => {
            // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
            document.getElementById('search-btn').addEventListener('click', searchTransactions);
            document.getElementById('reset-btn').addEventListener('click', resetFilters);
        };

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–åº”ç”¨
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>

</html>