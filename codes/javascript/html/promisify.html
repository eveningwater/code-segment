<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>promisify - å›è°ƒå‡½æ•°è½¬ Promise å·¥å…·</title>
    <!-- å¼•å…¥æ’ä»¶æ ·å¼ -->
    <link rel="stylesheet" href="../../demo/plugins/modal/style.css">
    <link rel="stylesheet" href="../../demo/plugins/notification/style.css">
    <link rel="stylesheet" href="../../demo/plugins/input-number/style.css">
    <link rel="stylesheet" href="../../demo/plugins/checkbox/style.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f9fafb;
            --text-primary: #1f2937;
            --text-secondary: #6b7280;
            --border-color: #e5e7eb;
            --card-shadow: 0 10px 30px rgba(15, 23, 42, 0.15);
            --accent-color: #3b82f6;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --error-color: #ef4444;
        }

        [data-theme="dark"] {
            --bg-primary: #1f2937;
            --bg-secondary: #111827;
            --text-primary: #f9fafb;
            --text-secondary: #d1d5db;
            --border-color: #374151;
            --card-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            --accent-color: #60a5fa;
            --success-color: #34d399;
            --warning-color: #fbbf24;
            --error-color: #f87171;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
            min-height: 100vh;
            color: var(--text-primary);
            line-height: 1.6;
            padding: 20px;
            transition: background 0.3s ease, color 0.3s ease;
        }

        [data-theme="dark"] body {
            background: linear-gradient(135deg, #1f2937 0%, #111827 100%);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 800;
            text-shadow: 0 3px 8px rgba(15, 23, 42, 0.35);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.95;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin-bottom: 24px;
        }

        .card {
            background: var(--bg-primary);
            border-radius: 15px;
            padding: 24px;
            box-shadow: var(--card-shadow);
            transition: all 0.3s ease;
        }

        .card h2 {
            font-size: 1.3rem;
            margin-bottom: 16px;
            color: var(--text-primary);
        }

        .input-group {
            margin-bottom: 16px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-primary);
            font-size: 0.9rem;
        }

        .input-field {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 0.95rem;
            font-family: 'Courier New', monospace;
            transition: border-color 0.3s ease;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--accent-color);
        }

        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn {
            flex: 1;
            min-width: 100px;
            padding: 10px 16px;
            border: none;
            border-radius: 8px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3b82f6, #1e40af);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #10b981, #047857);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #ef4444, #b91c1c);
            color: white;
        }

        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .info-box {
            background: var(--bg-secondary);
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 16px;
            border-left: 4px solid var(--accent-color);
        }

        .info-label {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .info-value {
            font-size: 1rem;
            color: var(--accent-color);
            font-weight: 700;
            font-family: 'Courier New', monospace;
            word-break: break-all;
        }

        .result-display {
            background: var(--bg-secondary);
            border-radius: 8px;
            padding: 12px;
            margin-top: 12px;
            max-height: 200px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            color: var(--text-primary);
            border: 2px solid var(--border-color);
        }

        .result-item {
            background: var(--bg-primary);
            padding: 10px;
            margin-bottom: 8px;
            border-radius: 6px;
            border-left: 3px solid var(--accent-color);
        }

        .result-item.success {
            border-left-color: var(--success-color);
            background: rgba(16, 185, 129, 0.05);
        }

        .result-item.error {
            border-left-color: var(--error-color);
            background: rgba(239, 68, 68, 0.05);
        }

        .result-item.warning {
            border-left-color: var(--warning-color);
            background: rgba(245, 158, 11, 0.05);
        }

        .feature-list {
            list-style: none;
            margin-top: 16px;
        }

        .feature-list li {
            padding: 10px;
            margin-bottom: 8px;
            background: var(--bg-secondary);
            border-radius: 6px;
            border-left: 3px solid var(--accent-color);
            font-size: 0.9rem;
        }

        .feature-list li:before {
            content: "âœ“ ";
            color: var(--success-color);
            font-weight: bold;
            margin-right: 8px;
        }

        .example-section {
            background: var(--bg-primary);
            border-radius: 15px;
            padding: 24px;
            box-shadow: var(--card-shadow);
            margin-top: 24px;
        }

        .example-section h2 {
            font-size: 1.3rem;
            margin-bottom: 16px;
            color: var(--text-primary);
        }

        .example-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 16px;
            margin-top: 16px;
        }

        .example-card {
            background: var(--bg-secondary);
            border-radius: 8px;
            padding: 16px;
            border: 2px solid var(--border-color);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .example-card:hover {
            border-color: var(--accent-color);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.1);
            transform: translateY(-2px);
        }

        .example-card h3 {
            font-size: 1rem;
            margin-bottom: 10px;
            color: var(--text-primary);
        }

        .example-desc {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .example-code {
            background: var(--bg-primary);
            padding: 8px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
            color: var(--accent-color);
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin-top: 16px;
        }

        .stat-item {
            background: linear-gradient(135deg, #3b82f6, #1e40af);
            color: white;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            font-weight: 600;
        }

        .stat-label {
            font-size: 0.8rem;
            opacity: 0.8;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            margin-top: 6px;
        }

        .code-block {
            background: #1e293b;
            color: #e2e8f0;
            padding: 16px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            overflow-x: auto;
            margin-top: 12px;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>âœ¨ å›è°ƒå‡½æ•°è½¬ Promise å·¥å…·</h1>
            <p>åŸºäº promisify å‡½æ•°çš„å›è°ƒè½¬ Promise å®æˆ˜ç¤ºä¾‹ - è®©å¼‚æ­¥ä»£ç æ›´ä¼˜é›…</p>
        </div>

        <div class="main-content">
            <!-- å‡½æ•°è¾“å…¥ -->
            <div class="card">
                <h2>ğŸ”„ å›è°ƒè½¬ Promise</h2>
                
                <div class="input-group">
                    <label>å»¶è¿Ÿæ—¶é—´ (æ¯«ç§’)</label>
                    <div id="delayInputContainer" style="margin-bottom: 16px;"></div>
                </div>

                <div class="input-group">
                    <label>æ“ä½œç»“æœ (é€‰æ‹©)</label>
                    <div id="resultSelectContainer" style="margin-bottom: 16px;"></div>
                </div>

                <div class="button-group">
                    <button class="btn btn-primary" onclick="testCallback()">æµ‹è¯•å›è°ƒ</button>
                    <button class="btn btn-success" onclick="testPromise()">æµ‹è¯• Promise</button>
                    <button class="btn btn-danger" onclick="testError()">æµ‹è¯•é”™è¯¯</button>
                </div>

                <div class="info-box">
                    <div class="info-label">æ‰§è¡ŒçŠ¶æ€ï¼š</div>
                    <div class="info-value" id="statusDisplay">å°±ç»ª</div>
                </div>

                <div class="stats">
                    <div class="stat-item">
                        <div class="stat-label">æ€»æ‰§è¡Œæ¬¡æ•°</div>
                        <div class="stat-value" id="totalCount">0</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">æˆåŠŸæ¬¡æ•°</div>
                        <div class="stat-value" id="successCount">0</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">å¤±è´¥æ¬¡æ•°</div>
                        <div class="stat-value" id="failCount">0</div>
                    </div>
                </div>
            </div>

            <!-- ç»“æœæ˜¾ç¤º -->
            <div class="card">
                <h2>ğŸ“Š æ‰§è¡Œç»“æœ</h2>
                
                <div style="margin-top: 16px;">
                    <h3 style="color: var(--text-primary); margin-bottom: 12px;">ğŸ“ˆ æ‰§è¡Œæ—¥å¿—ï¼š</h3>
                    <div class="result-display" id="resultLog">
                        <div class="result-item">å‡†å¤‡å°±ç»ªï¼Œç‚¹å‡»æŒ‰é’®å¼€å§‹æµ‹è¯•</div>
                    </div>
                </div>

                <h3 style="color: var(--text-primary); margin-top: 16px; margin-bottom: 12px;">ğŸ“‹ åŸºç¡€çŸ¥è¯†ï¼š</h3>
                <ul class="feature-list">
                    <li>promisify å°†å›è°ƒå‡½æ•°è½¬æ¢ä¸º Promise</li>
                    <li>æ”¯æŒ Node.js é£æ ¼çš„ (err, result) å›è°ƒ</li>
                    <li>è‡ªåŠ¨å¤„ç†é”™è¯¯å’ŒæˆåŠŸæƒ…å†µ</li>
                    <li>ä½¿ç”¨ async/await å¯ä»¥æ›´ä¼˜é›…åœ°å¤„ç†å¼‚æ­¥ä»£ç </li>
                </ul>
            </div>
        </div>

        <!-- åº”ç”¨ç¤ºä¾‹ -->
        <div class="example-section">
            <h2>ğŸ“š å®æˆ˜åº”ç”¨ç¤ºä¾‹</h2>
            <div class="example-grid">
                <div class="example-card" onclick="runExample('fileIO')">
                    <h3>ğŸ“ æ–‡ä»¶ I/O æ“ä½œ</h3>
                    <div class="example-desc">å°† fs.readFile è½¬ä¸º Promise</div>
                    <div class="example-code">fs.readFile â†’ Promise</div>
                </div>

                <div class="example-card" onclick="runExample('timer')">
                    <h3>â±ï¸ å®šæ—¶æ“ä½œ</h3>
                    <div class="example-desc">å°† setTimeout è½¬ä¸º Promise å»¶è¿Ÿ</div>
                    <div class="example-code">delay(ms) Promise</div>
                </div>

                <div class="example-card" onclick="runExample('network')">
                    <h3>ğŸŒ ç½‘ç»œè¯·æ±‚</h3>
                    <div class="example-desc">å°†å›è°ƒå¼è¯·æ±‚è½¬ä¸º Promise</div>
                    <div class="example-code">request â†’ Promise</div>
                </div>

                <div class="example-card" onclick="runExample('database')">
                    <h3>ğŸ—„ï¸ æ•°æ®åº“æŸ¥è¯¢</h3>
                    <div class="example-desc">å°† db.query å›è°ƒè½¬ä¸º Promise</div>
                    <div class="example-code">db.query â†’ Promise</div>
                </div>

                <div class="example-card" onclick="runExample('errorHandle')">
                    <h3>âš ï¸ é”™è¯¯å¤„ç†</h3>
                    <div class="example-desc">Promise ä¸­çš„é”™è¯¯æ•è·</div>
                    <div class="example-code">try/catch å¤„ç†</div>
                </div>

                <div class="example-card" onclick="runExample('parallel')">
                    <h3>ğŸš€ å¹¶è¡Œæ‰§è¡Œ</h3>
                    <div class="example-desc">ä½¿ç”¨ Promise.all å¹¶è¡Œå¤„ç†</div>
                    <div class="example-code">Promise.all()</div>
                </div>
            </div>
        </div>
    </div>

    <!-- å¼•å…¥æ’ä»¶è„šæœ¬ -->
    <script src="../../demo/plugins/modal/index.js"></script>
    <script src="../../demo/plugins/notification/index.js"></script>
    <script src="../../demo/plugins/input-number/index.js"></script>
    <script src="../../demo/plugins/checkbox/index.js"></script>

    <script src="../../demo/plugins/select/index.js"></script>

    <script>
        // promisify å‡½æ•°
        const promisify = func => (...args) =>
            new Promise((resolve, reject) =>
                func(...args, (err, result) => (err ? reject(err) : resolve(result)))
            );

        let stats = {
            totalCount: 0,
            successCount: 0,
            failCount: 0
        };

        let plugins = {
            modal: null,
            notification: null,
            delayInput: null,
            resultSelect: null
        };

        // åˆå§‹åŒ–æ’ä»¶
        function initPlugins() {
            try {
                plugins.modal = new Modal();
                plugins.notification = new Notification();
                
                plugins.delayInput = new InputNumber({
                    container: '#delayInputContainer',
                    min: 0,
                    max: 5000,
                    step: 100,
                    value: 1000,
                    placeholder: 'è¾“å…¥å»¶è¿Ÿæ—¶é—´'
                });

                plugins.resultSelect = new Select({
                    container: '#resultSelectContainer',
                    options: [
                        { value: 'success', label: 'âœ“ æˆåŠŸ' },
                        { value: 'error', label: 'âœ— é”™è¯¯' }
                    ],
                    placeholder: 'é€‰æ‹©æ“ä½œç»“æœ'
                });
                plugins.resultSelect.setValue('success');
            } catch (error) {
                console.warn('æ’ä»¶åŠ è½½å¤±è´¥:', error);
            }
        }

        // æ˜¾ç¤ºé€šçŸ¥
        function showNotification(message, type = 'info') {
            if (plugins.notification) {
                plugins.notification.show(message, type);
            } else {
                alert(message);
            }
        }

        // æ˜¾ç¤ºæ¨¡æ€æ¡†
        function showModal(content) {
            if (plugins.modal) {
                plugins.modal.alert(content);
            } else {
                alert(content);
            }
        }

        // æ·»åŠ æ—¥å¿—
        function addLog(message, type = 'info') {
            const logEl = document.getElementById('resultLog');
            const time = new Date().toLocaleTimeString('zh-CN');
            const item = document.createElement('div');
            item.className = `result-item ${type}`;
            item.textContent = `[${time}] ${message}`;
            logEl.appendChild(item);
            logEl.scrollTop = logEl.scrollHeight;
        }

        // ç¤ºä¾‹å›è°ƒå‡½æ•°
        function exampleCallback(delay, shouldError, callback) {
            setTimeout(() => {
                if (shouldError) {
                    callback(new Error('æ“ä½œå¤±è´¥'));
                } else {
                    callback(null, `æ“ä½œæˆåŠŸ (å»¶è¿Ÿ ${delay}ms)`);
                }
            }, delay);
        }

        // æµ‹è¯•å›è°ƒæ–¹å¼
        function testCallback() {
            const delay = parseInt(plugins.delayInput ? plugins.delayInput.getValue() : 1000);
            const resultType = plugins.resultSelect ? plugins.resultSelect.getValue() : 'success';
            const shouldError = resultType === 'error';

            document.getElementById('statusDisplay').textContent = 'æ‰§è¡Œä¸­...';
            addLog(`[å›è°ƒæ–¹å¼] å¼€å§‹æ‰§è¡Œï¼Œå»¶è¿Ÿ: ${delay}ms`, 'warning');

            exampleCallback(delay, shouldError, (err, result) => {
                stats.totalCount++;
                
                if (err) {
                    stats.failCount++;
                    document.getElementById('statusDisplay').textContent = 'âŒ æ‰§è¡Œå¤±è´¥';
                    addLog(`[å›è°ƒæ–¹å¼] é”™è¯¯: ${err.message}`, 'error');
                } else {
                    stats.successCount++;
                    document.getElementById('statusDisplay').textContent = 'âœ“ æ‰§è¡ŒæˆåŠŸ';
                    addLog(`[å›è°ƒæ–¹å¼] ${result}`, 'success');
                }

                updateStats();
            });
        }

        // æµ‹è¯• Promise æ–¹å¼
        async function testPromise() {
            const delay = parseInt(plugins.delayInput ? plugins.delayInput.getValue() : 1000);
            const resultType = plugins.resultSelect ? plugins.resultSelect.getValue() : 'success';
            const shouldError = resultType === 'error';

            document.getElementById('statusDisplay').textContent = 'æ‰§è¡Œä¸­...';
            addLog(`[Promise æ–¹å¼] å¼€å§‹æ‰§è¡Œï¼Œå»¶è¿Ÿ: ${delay}ms`, 'warning');

            const promisifiedCallback = promisify(exampleCallback);

            try {
                const result = await promisifiedCallback(delay, shouldError);
                stats.totalCount++;
                stats.successCount++;
                document.getElementById('statusDisplay').textContent = 'âœ“ æ‰§è¡ŒæˆåŠŸ';
                addLog(`[Promise æ–¹å¼] ${result}`, 'success');
            } catch (error) {
                stats.totalCount++;
                stats.failCount++;
                document.getElementById('statusDisplay').textContent = 'âŒ æ‰§è¡Œå¤±è´¥';
                addLog(`[Promise æ–¹å¼] é”™è¯¯: ${error.message}`, 'error');
            }

            updateStats();
        }

        // æµ‹è¯•é”™è¯¯å¤„ç†
        async function testError() {
            const delay = parseInt(plugins.delayInput ? plugins.delayInput.getValue() : 1000);
            
            document.getElementById('statusDisplay').textContent = 'æµ‹è¯•é”™è¯¯å¤„ç†ä¸­...';
            addLog(`[é”™è¯¯æµ‹è¯•] å¼€å§‹æµ‹è¯•é”™è¯¯å¤„ç†`, 'warning');

            const promisifiedCallback = promisify(exampleCallback);

            try {
                const result = await promisifiedCallback(delay, true);
                addLog(`[é”™è¯¯æµ‹è¯•] è¿™ä¸åº”è¯¥æ˜¾ç¤º`, 'info');
            } catch (error) {
                stats.totalCount++;
                stats.failCount++;
                document.getElementById('statusDisplay').textContent = 'âœ“ é”™è¯¯å·²æ­£ç¡®æ•è·';
                addLog(`[é”™è¯¯æµ‹è¯•] æˆåŠŸæ•è·é”™è¯¯: ${error.message}`, 'success');
            }

            updateStats();
        }

        // æ›´æ–°ç»Ÿè®¡
        function updateStats() {
            document.getElementById('totalCount').textContent = stats.totalCount;
            document.getElementById('successCount').textContent = stats.successCount;
            document.getElementById('failCount').textContent = stats.failCount;
        }

        // è¿è¡Œç¤ºä¾‹
        function runExample(type) {
            const examples = {
                fileIO: () => {
                    const msg = `ğŸ“ æ–‡ä»¶ I/O æ“ä½œ:\n\n` +
                        `åŸå§‹å›è°ƒæ–¹å¼ï¼š\n` +
                        `fs.readFile('file.txt', 'utf8', (err, data) => {\n` +
                        `  if (err) console.error(err);\n` +
                        `  else console.log(data);\n` +
                        `});\n\n` +
                        `ä½¿ç”¨ promisifyï¼š\n` +
                        `const readFile = promisify(fs.readFile);\n` +
                        `const data = await readFile('file.txt', 'utf8');\n\n` +
                        `ä¼˜åŠ¿ï¼š\n` +
                        `â€¢ æ”¯æŒ async/await\n` +
                        `â€¢ é”™è¯¯å¤„ç†æ›´æ¸…æ™°\n` +
                        `â€¢ å¯ä»¥ä½¿ç”¨ Promise.all/race\n` +
                        `â€¢ ä»£ç æ›´æ˜“è¯»æ˜“ç»´æŠ¤`;
                    showModal(msg);
                },

                timer: () => {
                    const msg = `â±ï¸ å®šæ—¶æ“ä½œ:\n\n` +
                        `åˆ›å»º Promise å»¶è¿Ÿï¼š\n` +
                        `function delay(ms, callback) {\n` +
                        `  setTimeout(() => callback(null, ms), ms);\n` +
                        `}\n\n` +
                        `è½¬æ¢ä¸º Promiseï¼š\n` +
                        `const delayPromise = promisify(delay);\n` +
                        `await delayPromise(1000);\n\n` +
                        `å®é™…åº”ç”¨ï¼š\n` +
                        `async function workflow() {\n` +
                        `  await delayPromise(1000); // ç­‰å¾… 1 ç§’\n` +
                        `  await doSomething();\n` +
                        `  await delayPromise(500);\n` +
                        `  await doMore();\n` +
                        `}\n\n` +
                        `ä½¿ç”¨åœºæ™¯ï¼š\n` +
                        `â€¢ æ§åˆ¶å¼‚æ­¥æµç¨‹\n` +
                        `â€¢ å®ç°é‡è¯•æœºåˆ¶\n` +
                        `â€¢ æµé‡æ§åˆ¶`;
                    showModal(msg);
                },

                network: () => {
                    const msg = `ğŸŒ ç½‘ç»œè¯·æ±‚:\n\n` +
                        `åŸå§‹å›è°ƒæ–¹å¼ï¼š\n` +
                        `request(url, (err, res, body) => {\n` +
                        `  if (err) handleError(err);\n` +
                        `  else processData(body);\n` +
                        `});\n\n` +
                        `ä½¿ç”¨ promisifyï¼š\n` +
                        `const requestPromise = promisify(request);\n` +
                        `const res = await requestPromise(url);\n\n` +
                        `ä¸ fetch å¯¹æ¯”ï¼š\n` +
                        `// Fetch å·²æ˜¯åŸç”Ÿ Promise API\n` +
                        `const res = await fetch(url);\n` +
                        `const data = await res.json();\n\n` +
                        `åº”ç”¨åœºæ™¯ï¼š\n` +
                        `â€¢ æ—§é¡¹ç›®å‡çº§\n` +
                        `â€¢ ä¾èµ–åº“é€‚é…\n` +
                        `â€¢ æ¸è¿›å¼è¿ç§»`;
                    showModal(msg);
                },

                database: () => {
                    const msg = `ğŸ—„ï¸ æ•°æ®åº“æŸ¥è¯¢:\n\n` +
                        `MongoDB å›è°ƒæ–¹å¼ï¼š\n` +
                        `db.collection('users').findOne({id: 1}, (err, doc) => {\n` +
                        `  if (err) throw err;\n` +
                        `  console.log(doc);\n` +
                        `});\n\n` +
                        `ä½¿ç”¨ promisifyï¼š\n` +
                        `const findOne = promisify(db.collection('users').findOne.bind(db.collection('users')));\n` +
                        `const doc = await findOne({id: 1});\n\n` +
                        `MySQL ç¤ºä¾‹ï¼š\n` +
                        `const query = promisify(connection.query.bind(connection));\n` +
                        `const results = await query('SELECT * FROM users');\n\n` +
                        `ä¼˜åŠ¿ï¼š\n` +
                        `â€¢ ç»Ÿä¸€æ¥å£\n` +
                        `â€¢ äº‹åŠ¡å¤„ç†æ›´æ˜“\n` +
                        `â€¢ è¿æ¥æ± ç®¡ç†\n` +
                        `â€¢ é”™è¯¯å¤„ç†ä¸€è‡´`;
                    showModal(msg);
                },

                errorHandle: () => {
                    const msg = `âš ï¸ é”™è¯¯å¤„ç†:\n\n` +
                        `åŸºæœ¬ try/catchï¼š\n` +
                        `try {\n` +
                        `  const result = await promisifiedFunc();\n` +
                        `} catch (error) {\n` +
                        `  console.error('é”™è¯¯:', error.message);\n` +
                        `}\n\n` +
                        `å¤šæ“ä½œé”™è¯¯å¤„ç†ï¼š\n` +
                        `try {\n` +
                        `  const [user, post] = await Promise.all([\n` +
                        `    getUser(),\n` +
                        `    getPost()\n` +
                        `  ]);\n` +
                        `} catch (error) {\n` +
                        `  // ä»»ä½•ä¸€ä¸ªå¤±è´¥éƒ½ä¼šæ•è·\n` +
                        `}\n\n` +
                        `é”™è¯¯æ¢å¤ï¼š\n` +
                        `async function withRetry(fn, retries = 3) {\n` +
                        `  for (let i = 0; i < retries; i++) {\n` +
                        `    try {\n` +
                        `      return await fn();\n` +
                        `    } catch (e) {\n` +
                        `      if (i === retries - 1) throw e;\n` +
                        `    }\n` +
                        `  }\n` +
                        `}\n\n` +
                        `æœ€ä½³å®è·µï¼š\n` +
                        `â€¢ æ€»æ˜¯ä½¿ç”¨ try/catch\n` +
                        `â€¢ åŒºåˆ†å¯æ¢å¤å’Œä¸å¯æ¢å¤é”™è¯¯\n` +
                        `â€¢ è®°å½•å®Œæ•´é”™è¯¯ä¿¡æ¯`;
                    showModal(msg);
                },

                parallel: () => {
                    const msg = `ğŸš€ å¹¶è¡Œæ‰§è¡Œ:\n\n` +
                        `Promise.all - å…¨éƒ¨æˆåŠŸæ‰æˆåŠŸï¼š\n` +
                        `const [user, posts, comments] = await Promise.all([\n` +
                        `  getUser(id),\n` +
                        `  getPosts(id),\n` +
                        `  getComments(id)\n` +
                        `]);\n\n` +
                        `Promise.race - ç«é€Ÿï¼Œè°å…ˆå®Œæˆç”¨è°ï¼š\n` +
                        `const fastest = await Promise.race([\n` +
                        `  fetchFromServer1(),\n` +
                        `  fetchFromServer2(),\n` +
                        `  fetchFromServer3()\n` +
                        `]);\n\n` +
                        `Promise.allSettled - å…¨éƒ¨å®Œæˆï¼Œä¸è®ºæˆè´¥ï¼š\n` +
                        `const results = await Promise.allSettled([\n` +
                        `  operation1(),\n` +
                        `  operation2(),\n` +
                        `  operation3()\n` +
                        `]);\n\n` +
                        `å®é™…åº”ç”¨ï¼š\n` +
                        `â€¢ å¤šä¸ª API å¹¶è¡Œè¯·æ±‚\n` +
                        `â€¢ è¶…æ—¶æ§åˆ¶\n` +
                        `â€¢ è´Ÿè½½å‡è¡¡\n` +
                        `â€¢ å®¹é”™æœºåˆ¶`;
                    showModal(msg);
                }
            };

            examples[type]?.();
        }

        // åˆå§‹åŒ–
        window.addEventListener('load', () => {
            initPlugins();
            addLog('ç³»ç»Ÿå·²åˆå§‹åŒ–ï¼Œå¯ä»¥å¼€å§‹æµ‹è¯•', 'info');
        });
    </script>
</body>

</html>