<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ™ºèƒ½æ•°æ®èŒƒå›´ç®¡ç†ç³»ç»Ÿ - inRangeå‡½æ•°å®æˆ˜ç¤ºä¾‹</title>
    <link rel="stylesheet" href="../../demo/plugins/modal/style.css">
    <link rel="stylesheet" href="../../demo/plugins/notification/style.css">
    <link rel="stylesheet" href="../../demo/plugins/select/style.css">
    <link rel="stylesheet" href="../../demo/plugins/checkbox/style.css">
    <link rel="stylesheet" href="../../demo/plugins/datetime-picker/style.css">
    <link rel="stylesheet" href="../../demo/plugins/input-number/style.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
        }

        .control-panel {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            border: 2px solid #e9ecef;
            margin-bottom: 30px;
        }

        .control-section {
            margin-bottom: 25px;
        }

        .control-section h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.1em;
            border-bottom: 2px solid #667eea;
            padding-bottom: 8px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 0.9em;
        }

        .controls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 14px;
            margin: 5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(40, 167, 69, 0.4);
        }

        .btn-warning {
            background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%);
            color: #212529;
        }

        .btn-warning:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 193, 7, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, #dc3545 0%, #e74c3c 100%);
            color: white;
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(220, 53, 69, 0.4);
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 15px;
            padding: 25px;
            transition: all 0.3s ease;
        }

        .card:hover {
            border-color: #667eea;
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e9ecef;
        }

        .card-icon {
            font-size: 1.5em;
        }

        .card-title {
            font-size: 1.2em;
            font-weight: 600;
            color: #333;
        }

        .range-monitor {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            position: relative;
        }

        .range-bar {
            background: #e9ecef;
            height: 20px;
            border-radius: 10px;
            position: relative;
            overflow: hidden;
            margin: 10px 0;
        }

        .range-fill {
            height: 100%;
            background: linear-gradient(90deg, #28a745 0%, #20c997 100%);
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .range-fill.warning {
            background: linear-gradient(90deg, #ffc107 0%, #fd7e14 100%);
        }

        .range-fill.danger {
            background: linear-gradient(90deg, #dc3545 0%, #e74c3c 100%);
        }

        .range-marker {
            position: absolute;
            top: -5px;
            width: 4px;
            height: 30px;
            background: #333;
            border-radius: 2px;
            transform: translateX(-50%);
        }

        .range-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.8em;
            color: #666;
            margin-top: 5px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        .data-table th,
        .data-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }

        .data-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #333;
        }

        .data-table tr:hover {
            background: #f8f9fa;
        }

        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .status-normal {
            background: #d4edda;
            color: #155724;
        }

        .status-warning {
            background: #fff3cd;
            color: #856404;
        }

        .status-danger {
            background: #f8d7da;
            color: #721c24;
        }

        .alert-panel {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .alert-panel.danger {
            background: #f8d7da;
            border-color: #f5c6cb;
        }

        .alert-panel.success {
            background: #d4edda;
            border-color: #c3e6cb;
        }

        .alert-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .alert-list {
            list-style: none;
            padding: 0;
        }

        .alert-item {
            padding: 8px 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .alert-item:last-child {
            border-bottom: none;
        }

        .threshold-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .threshold-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 15px;
            transition: all 0.3s ease;
        }

        .threshold-card:hover {
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .threshold-card.active {
            border-color: #28a745;
            background: #f8fff9;
        }

        .threshold-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .threshold-name {
            font-weight: 600;
            color: #333;
        }

        .threshold-value {
            font-size: 1.2em;
            font-weight: bold;
            color: #667eea;
        }

        .real-time-data {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            max-height: 300px;
            overflow-y: auto;
        }

        .data-entry {
            margin-bottom: 8px;
            padding: 5px 0;
            border-bottom: 1px solid #4a5568;
        }

        .data-time {
            color: #a0aec0;
            margin-right: 10px;
        }

        .data-value {
            color: #68d391;
        }

        .data-status {
            margin-left: 10px;
        }

        .data-status.normal {
            color: #68d391;
        }

        .data-status.warning {
            color: #f6ad55;
        }

        .data-status.danger {
            color: #fc8181;
        }

        .validation-form {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .validation-result {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
            font-weight: 600;
        }

        .validation-result.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .validation-result.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .chart-container {
            height: 200px;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            position: relative;
        }

        .chart-line {
            height: 2px;
            background: #667eea;
            position: absolute;
            bottom: 50px;
            left: 20px;
            right: 20px;
        }

        .chart-point {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #667eea;
            border-radius: 50%;
            transform: translate(-50%, -50%);
        }

        .chart-point.warning {
            background: #ffc107;
        }

        .chart-point.danger {
            background: #dc3545;
        }

        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .controls-grid {
                grid-template-columns: 1fr;
            }
            
            .threshold-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¯ æ™ºèƒ½æ•°æ®èŒƒå›´ç®¡ç†ç³»ç»Ÿ</h1>
            <p>åŸºäº inRange å‡½æ•°çš„å®æˆ˜ç¤ºä¾‹ - æ•°æ®éªŒè¯ã€èŒƒå›´ç›‘æ§ã€é˜ˆå€¼ç®¡ç†</p>
        </div>

        <div class="content">
            <!-- æ§åˆ¶é¢æ¿ -->
            <div class="control-panel">
                <div class="control-section">
                    <h3>âš™ï¸ ç³»ç»Ÿé…ç½®</h3>
                    <div class="controls-grid">
                        <div class="form-group">
                            <label>ç›‘æ§ç±»å‹</label>
                            <div id="monitorTypeSelect"></div>
                        </div>
                        <div class="form-group">
                            <label>æ•°æ®æº</label>
                            <div id="dataSourceSelect"></div>
                        </div>
                        <div class="form-group">
                            <label>æ›´æ–°é¢‘ç‡ (ç§’)</label>
                            <div id="updateFrequencyInput"></div>
                        </div>
                        <div class="form-group">
                            <label>è‡ªåŠ¨ä¿å­˜</label>
                            <div id="autoSaveCheckbox"></div>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="startMonitoring()">å¼€å§‹ç›‘æ§</button>
                    <button class="btn btn-warning" onclick="pauseMonitoring()">æš‚åœç›‘æ§</button>
                    <button class="btn btn-success" onclick="addThreshold()">æ·»åŠ é˜ˆå€¼</button>
                    <button class="btn btn-danger" onclick="clearAlerts()">æ¸…é™¤è­¦æŠ¥</button>
                </div>
            </div>

            <!-- ä»ªè¡¨æ¿ -->
            <div class="dashboard">
                <!-- å®æ—¶ç›‘æ§ -->
                <div class="card">
                    <div class="card-header">
                        <span class="card-icon">ğŸ“Š</span>
                        <span class="card-title">å®æ—¶æ•°æ®ç›‘æ§</span>
                    </div>
                    <div class="range-monitor" id="rangeMonitor">
                        <div class="range-bar">
                            <div class="range-fill" id="rangeFill"></div>
                            <div class="range-marker" id="currentValue"></div>
                        </div>
                        <div class="range-labels">
                            <span id="minLabel">0</span>
                            <span id="maxLabel">100</span>
                        </div>
                    </div>
                    <div id="currentStatus">
                        <p><strong>å½“å‰å€¼ï¼š</strong><span id="currentValueText">--</span></p>
                        <p><strong>çŠ¶æ€ï¼š</strong><span id="statusText">--</span></p>
                        <p><strong>èŒƒå›´ï¼š</strong><span id="rangeText">--</span></p>
                    </div>
                </div>

                <!-- é˜ˆå€¼ç®¡ç† -->
                <div class="card">
                    <div class="card-header">
                        <span class="card-icon">ğŸšï¸</span>
                        <span class="card-title">é˜ˆå€¼ç®¡ç†</span>
                    </div>
                    <div class="threshold-grid" id="thresholdGrid">
                        <!-- é˜ˆå€¼å¡ç‰‡å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>

                <!-- è­¦æŠ¥ç³»ç»Ÿ -->
                <div class="card">
                    <div class="card-header">
                        <span class="card-icon">ğŸš¨</span>
                        <span class="card-title">è­¦æŠ¥ç³»ç»Ÿ</span>
                    </div>
                    <div id="alertPanel" class="alert-panel">
                        <div class="alert-header">
                            <span>ğŸ“¢ ç³»ç»ŸçŠ¶æ€æ­£å¸¸</span>
                        </div>
                        <ul class="alert-list" id="alertList">
                            <!-- è­¦æŠ¥åˆ—è¡¨å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                        </ul>
                    </div>
                </div>
            </div>

            <!-- æ•°æ®éªŒè¯ -->
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">âœ…</span>
                    <span class="card-title">æ•°æ®éªŒè¯</span>
                </div>
                <div class="validation-form">
                    <div class="controls-grid">
                        <div class="form-group">
                            <label>æµ‹è¯•å€¼</label>
                            <div id="testValueInput"></div>
                        </div>
                        <div class="form-group">
                            <label>èŒƒå›´èµ·å§‹</label>
                            <div id="rangeStartInput"></div>
                        </div>
                        <div class="form-group">
                            <label>èŒƒå›´ç»“æŸ</label>
                            <div id="rangeEndInput"></div>
                        </div>
                        <div class="form-group">
                            <label>éªŒè¯æ¨¡å¼</label>
                            <div id="validationModeSelect"></div>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="validateData()">éªŒè¯æ•°æ®</button>
                    <button class="btn btn-success" onclick="batchValidate()">æ‰¹é‡éªŒè¯</button>
                    <div id="validationResult" class="validation-result" style="display: none;"></div>
                </div>
            </div>

            <!-- æ•°æ®å†å² -->
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">ğŸ“ˆ</span>
                    <span class="card-title">æ•°æ®å†å²</span>
                </div>
                <div class="real-time-data" id="realTimeData">
                    <!-- å®æ—¶æ•°æ®å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                </div>
            </div>

            <!-- æ•°æ®è¡¨æ ¼ -->
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">ğŸ“‹</span>
                    <span class="card-title">æ•°æ®è®°å½•</span>
                </div>
                <table class="data-table" id="dataTable">
                    <thead>
                        <tr>
                            <th>æ—¶é—´</th>
                            <th>å€¼</th>
                            <th>èŒƒå›´</th>
                            <th>çŠ¶æ€</th>
                            <th>æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody id="dataTableBody">
                        <!-- æ•°æ®è¡Œå°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- å¼•å…¥æ’ä»¶ -->
    <script src="../../demo/plugins/modal/index.js"></script>
    <script src="../../demo/plugins/notification/index.js"></script>
    <script src="../../demo/plugins/select/index.js"></script>
    <script src="../../demo/plugins/checkbox/index.js"></script>
    <script src="../../demo/plugins/datetime-picker/index.js"></script>
    <script src="../../demo/plugins/input-number/index.js"></script>

    <script>
        // å…¨å±€å˜é‡
        let modal, notification;
        let monitorTypeSelect, dataSourceSelect, updateFrequencyInput, autoSaveCheckbox;
        let testValueInput, rangeStartInput, rangeEndInput, validationModeSelect;
        let monitoringInterval;
        let isMonitoring = false;
        let dataHistory = [];
        let thresholds = [];
        let alerts = [];

        // inRange å‡½æ•°
        const inRange = (n, start, end = null) => {
            if (end && start > end) {
                [end, start] = [start, end];
            }
            return end === null ? n >= 0 && n < start : n >= start && n < end;
        };

        // åˆå§‹åŒ–åº”ç”¨
        function initApp() {
            // åˆå§‹åŒ–æ’ä»¶
            modal = new Modal();
            notification = new Notification({ position: 'top-right' });

            // åˆå§‹åŒ–é€‰æ‹©æ§ä»¶
            monitorTypeSelect = new Select({
                container: document.getElementById('monitorTypeSelect'),
                options: [
                    { value: 'temperature', label: 'æ¸©åº¦ç›‘æ§' },
                    { value: 'pressure', label: 'å‹åŠ›ç›‘æ§' },
                    { value: 'humidity', label: 'æ¹¿åº¦ç›‘æ§' },
                    { value: 'voltage', label: 'ç”µå‹ç›‘æ§' },
                    { value: 'custom', label: 'è‡ªå®šä¹‰ç›‘æ§' }
                ],
                placeholder: 'é€‰æ‹©ç›‘æ§ç±»å‹'
            });

            dataSourceSelect = new Select({
                container: document.getElementById('dataSourceSelect'),
                options: [
                    { value: 'sensor', label: 'ä¼ æ„Ÿå™¨æ•°æ®' },
                    { value: 'api', label: 'API æ•°æ®' },
                    { value: 'manual', label: 'æ‰‹åŠ¨è¾“å…¥' },
                    { value: 'simulation', label: 'æ¨¡æ‹Ÿæ•°æ®' }
                ],
                placeholder: 'é€‰æ‹©æ•°æ®æº'
            });

            updateFrequencyInput = new InputNumber({
                container: document.getElementById('updateFrequencyInput'),
                min: 1,
                max: 3600,
                value: 5,
                step: 1
            });

            autoSaveCheckbox = new Checkbox({
                label: 'è‡ªåŠ¨ä¿å­˜æ•°æ®',
                checked: true,
                onChange: (checked) => {
                    console.log('è‡ªåŠ¨ä¿å­˜çŠ¶æ€:', checked);
                }
            });
            autoSaveCheckbox.mount(document.getElementById('autoSaveCheckbox'));

            // åˆå§‹åŒ–éªŒè¯æ§ä»¶
            testValueInput = new InputNumber({
                container: document.getElementById('testValueInput'),
                min: -1000,
                max: 1000,
                value: 50,
                step: 1
            });

            rangeStartInput = new InputNumber({
                container: document.getElementById('rangeStartInput'),
                min: -1000,
                max: 1000,
                value: 0,
                step: 1
            });

            rangeEndInput = new InputNumber({
                container: document.getElementById('rangeEndInput'),
                min: -1000,
                max: 1000,
                value: 100,
                step: 1
            });

            validationModeSelect = new Select({
                container: document.getElementById('validationModeSelect'),
                options: [
                    { value: 'normal', label: 'æ­£å¸¸æ¨¡å¼ [start, end)' },
                    { value: 'inclusive', label: 'åŒ…å«æ¨¡å¼ [start, end]' },
                    { value: 'exclusive', label: 'æ’é™¤æ¨¡å¼ (start, end)' }
                ],
                placeholder: 'é€‰æ‹©éªŒè¯æ¨¡å¼'
            });

            // åˆå§‹åŒ–é»˜è®¤é˜ˆå€¼
            initializeThresholds();

            // åˆå§‹åŒ–ç•Œé¢
            updateRangeMonitor(50, 0, 100);
            addDataLog('ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ', 50, 'normal');
        }

        // åˆå§‹åŒ–é»˜è®¤é˜ˆå€¼
        function initializeThresholds() {
            thresholds = [
                { id: 1, name: 'ä½æ¸©è­¦å‘Š', min: 0, max: 10, type: 'warning', active: true },
                { id: 2, name: 'é«˜æ¸©è­¦å‘Š', min: 90, max: 100, type: 'warning', active: true },
                { id: 3, name: 'å±é™©ä½æ¸©', min: -10, max: 0, type: 'danger', active: true },
                { id: 4, name: 'å±é™©é«˜æ¸©', min: 100, max: 120, type: 'danger', active: true }
            ];
            updateThresholdGrid();
        }

        // æ›´æ–°é˜ˆå€¼ç½‘æ ¼
        function updateThresholdGrid() {
            const container = document.getElementById('thresholdGrid');
            container.innerHTML = '';

            thresholds.forEach(threshold => {
                const card = document.createElement('div');
                card.className = `threshold-card ${threshold.active ? 'active' : ''}`;
                card.onclick = () => toggleThreshold(threshold.id);

                card.innerHTML = `
                    <div class="threshold-header">
                        <span class="threshold-name">${threshold.name}</span>
                        <span class="status-badge status-${threshold.type}">${threshold.type}</span>
                    </div>
                    <div class="threshold-value">${threshold.min} - ${threshold.max}</div>
                    <div style="font-size: 0.8em; color: #666;">
                        ${threshold.active ? 'å·²å¯ç”¨' : 'å·²ç¦ç”¨'}
                    </div>
                `;

                container.appendChild(card);
            });
        }

        // åˆ‡æ¢é˜ˆå€¼çŠ¶æ€
        function toggleThreshold(id) {
            const threshold = thresholds.find(t => t.id === id);
            if (threshold) {
                threshold.active = !threshold.active;
                updateThresholdGrid();
                addDataLog(`é˜ˆå€¼ ${threshold.name} ${threshold.active ? 'å¯ç”¨' : 'ç¦ç”¨'}`, null, 'info');
            }
        }

        // æ·»åŠ é˜ˆå€¼
        function addThreshold() {
            modal.prompt('è¯·è¾“å…¥é˜ˆå€¼åç§°:', 'æ–°é˜ˆå€¼').then(name => {
                if (name) {
                    modal.prompt('è¯·è¾“å…¥æœ€å°å€¼:', '0').then(min => {
                        if (min !== null) {
                            modal.prompt('è¯·è¾“å…¥æœ€å¤§å€¼:', '100').then(max => {
                                if (max !== null) {
                                    const newThreshold = {
                                        id: Date.now(),
                                        name: name,
                                        min: parseFloat(min),
                                        max: parseFloat(max),
                                        type: 'warning',
                                        active: true
                                    };
                                    thresholds.push(newThreshold);
                                    updateThresholdGrid();
                                    addDataLog(`æ·»åŠ é˜ˆå€¼: ${name}`, null, 'info');
                                    notification.success('é˜ˆå€¼æ·»åŠ æˆåŠŸ');
                                }
                            });
                        }
                    });
                }
            });
        }

        // å¼€å§‹ç›‘æ§
        function startMonitoring() {
            if (isMonitoring) {
                notification.warning('ç›‘æ§å·²åœ¨è¿è¡Œä¸­');
                return;
            }

            const frequency = updateFrequencyInput.getValue();
            const monitorType = monitorTypeSelect.getValue();
            const dataSource = dataSourceSelect.getValue();

            if (!monitorType || !dataSource) {
                notification.error('è¯·é€‰æ‹©ç›‘æ§ç±»å‹å’Œæ•°æ®æº');
                return;
            }

            isMonitoring = true;
            addDataLog(`å¼€å§‹${monitorType}ç›‘æ§`, null, 'info');

            // æ¨¡æ‹Ÿæ•°æ®ç”Ÿæˆ
            monitoringInterval = setInterval(() => {
                const value = generateSimulatedData(monitorType);
                const status = checkValueStatus(value);
                
                updateRangeMonitor(value, 0, 100);
                addDataLog(`${monitorType}æ•°æ®`, value, status);
                
                // æ£€æŸ¥é˜ˆå€¼
                checkThresholds(value);
                
                // è‡ªåŠ¨ä¿å­˜
                if (autoSaveCheckbox.isChecked()) {
                    saveData(value, status);
                }
            }, frequency * 1000);

            notification.success('ç›‘æ§å·²å¼€å§‹');
        }

        // æš‚åœç›‘æ§
        function pauseMonitoring() {
            if (!isMonitoring) {
                notification.warning('ç›‘æ§æœªåœ¨è¿è¡Œ');
                return;
            }

            clearInterval(monitoringInterval);
            isMonitoring = false;
            addDataLog('ç›‘æ§å·²æš‚åœ', null, 'info');
            notification.success('ç›‘æ§å·²æš‚åœ');
        }

        // ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®
        function generateSimulatedData(type) {
            const baseValue = 50;
            const variation = Math.random() * 40 - 20; // -20 åˆ° 20 çš„éšæœºå˜åŒ–
            let value = baseValue + variation;

            switch (type) {
                case 'temperature':
                    value = Math.max(-10, Math.min(120, value));
                    break;
                case 'pressure':
                    value = Math.max(0, Math.min(200, value));
                    break;
                case 'humidity':
                    value = Math.max(0, Math.min(100, value));
                    break;
                case 'voltage':
                    value = Math.max(0, Math.min(500, value));
                    break;
                default:
                    value = Math.max(0, Math.min(100, value));
            }

            return Math.round(value * 10) / 10;
        }

        // æ£€æŸ¥å€¼çŠ¶æ€
        function checkValueStatus(value) {
            // æ£€æŸ¥å±é™©é˜ˆå€¼
            const dangerThresholds = thresholds.filter(t => t.active && t.type === 'danger');
            for (const threshold of dangerThresholds) {
                if (inRange(value, threshold.min, threshold.max)) {
                    return 'danger';
                }
            }

            // æ£€æŸ¥è­¦å‘Šé˜ˆå€¼
            const warningThresholds = thresholds.filter(t => t.active && t.type === 'warning');
            for (const threshold of warningThresholds) {
                if (inRange(value, threshold.min, threshold.max)) {
                    return 'warning';
                }
            }

            return 'normal';
        }

        // æ£€æŸ¥é˜ˆå€¼
        function checkThresholds(value) {
            const triggeredThresholds = thresholds.filter(t => 
                t.active && inRange(value, t.min, t.max)
            );

            triggeredThresholds.forEach(threshold => {
                const alert = {
                    id: Date.now(),
                    message: `${threshold.name}: å½“å‰å€¼ ${value} è¶…å‡ºèŒƒå›´ [${threshold.min}, ${threshold.max})`,
                    type: threshold.type,
                    timestamp: new Date(),
                    value: value
                };

                alerts.unshift(alert);
                if (alerts.length > 10) {
                    alerts.pop();
                }

                updateAlertPanel();
                notification[threshold.type === 'danger' ? 'error' : 'warning'](alert.message);
            });
        }

        // æ›´æ–°è­¦æŠ¥é¢æ¿
        function updateAlertPanel() {
            const panel = document.getElementById('alertPanel');
            const list = document.getElementById('alertList');

            if (alerts.length === 0) {
                panel.className = 'alert-panel success';
                panel.querySelector('.alert-header').innerHTML = '<span>ğŸ“¢ ç³»ç»ŸçŠ¶æ€æ­£å¸¸</span>';
                list.innerHTML = '<li class="alert-item">æš‚æ— è­¦æŠ¥</li>';
            } else {
                const hasDanger = alerts.some(a => a.type === 'danger');
                panel.className = `alert-panel ${hasDanger ? 'danger' : 'warning'}`;
                panel.querySelector('.alert-header').innerHTML = 
                    `<span>ğŸš¨ ${hasDanger ? 'å±é™©è­¦æŠ¥' : 'è­¦å‘Šä¿¡æ¯'} (${alerts.length})</span>`;

                list.innerHTML = alerts.map(alert => `
                    <li class="alert-item">
                        <div style="font-weight: 600; color: ${alert.type === 'danger' ? '#dc3545' : '#ffc107'};">
                            ${alert.type === 'danger' ? 'ğŸš¨' : 'âš ï¸'} ${alert.message}
                        </div>
                        <div style="font-size: 0.8em; color: #666;">
                            ${formatDateTime(alert.timestamp)}
                        </div>
                    </li>
                `).join('');
            }
        }

        // æ¸…é™¤è­¦æŠ¥
        function clearAlerts() {
            modal.confirm('ç¡®å®šè¦æ¸…é™¤æ‰€æœ‰è­¦æŠ¥å—ï¼Ÿ').then(confirmed => {
                if (confirmed) {
                    alerts = [];
                    updateAlertPanel();
                    addDataLog('æ‰€æœ‰è­¦æŠ¥å·²æ¸…é™¤', null, 'info');
                    notification.success('è­¦æŠ¥å·²æ¸…é™¤');
                }
            });
        }

        // æ›´æ–°èŒƒå›´ç›‘æ§å™¨
        function updateRangeMonitor(value, min, max) {
            const fill = document.getElementById('rangeFill');
            const marker = document.getElementById('currentValue');
            const range = max - min;
            const percentage = ((value - min) / range) * 100;

            fill.style.width = `${percentage}%`;
            marker.style.left = `${percentage}%`;

            // æ›´æ–°çŠ¶æ€é¢œè‰²
            const status = checkValueStatus(value);
            fill.className = `range-fill ${status !== 'normal' ? status : ''}`;

            // æ›´æ–°æ ‡ç­¾
            document.getElementById('minLabel').textContent = min;
            document.getElementById('maxLabel').textContent = max;
            document.getElementById('currentValueText').textContent = value;
            document.getElementById('statusText').innerHTML = `<span class="status-badge status-${status}">${status}</span>`;
            document.getElementById('rangeText').textContent = `[${min}, ${max})`;
        }

        // éªŒè¯æ•°æ®
        function validateData() {
            const value = testValueInput.getValue();
            const start = rangeStartInput.getValue();
            const end = rangeEndInput.getValue();
            const mode = validationModeSelect.getValue();

            if (value === null || start === null || end === null || !mode) {
                notification.error('è¯·å¡«å†™æ‰€æœ‰éªŒè¯å‚æ•°');
                return;
            }

            let isValid = false;
            let message = '';

            switch (mode) {
                case 'normal':
                    isValid = inRange(value, start, end);
                    message = `å€¼ ${value} æ˜¯å¦åœ¨èŒƒå›´ [${start}, ${end}) å†…`;
                    break;
                case 'inclusive':
                    isValid = value >= start && value <= end;
                    message = `å€¼ ${value} æ˜¯å¦åœ¨èŒƒå›´ [${start}, ${end}] å†…`;
                    break;
                case 'exclusive':
                    isValid = value > start && value < end;
                    message = `å€¼ ${value} æ˜¯å¦åœ¨èŒƒå›´ (${start}, ${end}) å†…`;
                    break;
            }

            const result = document.getElementById('validationResult');
            result.style.display = 'block';
            result.className = `validation-result ${isValid ? 'success' : 'error'}`;
            result.innerHTML = `
                <div>${message}</div>
                <div style="margin-top: 5px; font-size: 0.9em;">
                    ç»“æœ: <strong>${isValid ? 'âœ… éªŒè¯é€šè¿‡' : 'âŒ éªŒè¯å¤±è´¥'}</strong>
                </div>
            `;

            addDataLog(`æ•°æ®éªŒè¯: ${value}`, value, isValid ? 'normal' : 'warning');
        }

        // æ‰¹é‡éªŒè¯
        function batchValidate() {
            const testValues = [10, 25, 50, 75, 90, 110];
            const start = 0;
            const end = 100;
            
            let results = [];
            testValues.forEach(value => {
                const isValid = inRange(value, start, end);
                results.push({ value, isValid });
            });

            const content = `
                <div style="max-width: 500px;">
                    <h4>æ‰¹é‡éªŒè¯ç»“æœ</h4>
                    <table style="width: 100%; border-collapse: collapse; margin-top: 15px;">
                        <tr style="background: #f8f9fa;">
                            <th style="padding: 8px; border: 1px solid #dee2e6;">å€¼</th>
                            <th style="padding: 8px; border: 1px solid #dee2e6;">èŒƒå›´ [${start}, ${end})</th>
                            <th style="padding: 8px; border: 1px solid #dee2e6;">ç»“æœ</th>
                        </tr>
                        ${results.map(r => `
                            <tr>
                                <td style="padding: 8px; border: 1px solid #dee2e6;">${r.value}</td>
                                <td style="padding: 8px; border: 1px solid #dee2e6;">[${start}, ${end})</td>
                                <td style="padding: 8px; border: 1px solid #dee2e6;">
                                    <span style="color: ${r.isValid ? '#28a745' : '#dc3545'}; font-weight: bold;">
                                        ${r.isValid ? 'âœ… é€šè¿‡' : 'âŒ å¤±è´¥'}
                                    </span>
                                </td>
                            </tr>
                        `).join('')}
                    </table>
                </div>
            `;

            modal.alert(content, 'æ‰¹é‡éªŒè¯ç»“æœ');
        }

        // æ·»åŠ æ•°æ®æ—¥å¿—
        function addDataLog(message, value, status) {
            const timestamp = new Date();
            const logEntry = {
                time: timestamp,
                message: message,
                value: value,
                status: status
            };

            dataHistory.unshift(logEntry);
            if (dataHistory.length > 50) {
                dataHistory.pop();
            }

            updateRealTimeData();
            updateDataTable();
        }

        // æ›´æ–°å®æ—¶æ•°æ®æ˜¾ç¤º
        function updateRealTimeData() {
            const container = document.getElementById('realTimeData');
            
            container.innerHTML = dataHistory.slice(0, 20).map(entry => `
                <div class="data-entry">
                    <span class="data-time">${formatDateTime(entry.time)}</span>
                    <span class="data-value">${entry.value !== null ? entry.value : ''}</span>
                    <span class="data-status ${entry.status}">${entry.message}</span>
                </div>
            `).join('');
        }

        // æ›´æ–°æ•°æ®è¡¨æ ¼
        function updateDataTable() {
            const tbody = document.getElementById('dataTableBody');
            tbody.innerHTML = '';

            dataHistory.slice(0, 20).forEach(entry => {
                if (entry.value !== null) {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${formatDateTime(entry.time)}</td>
                        <td>${entry.value}</td>
                        <td>[0, 100)</td>
                        <td><span class="status-badge status-${entry.status}">${entry.status}</span></td>
                        <td>
                            <button onclick="deleteDataEntry('${entry.time.getTime()}')" 
                                    style="background: #dc3545; color: white; border: none; padding: 4px 8px; border-radius: 4px; cursor: pointer; font-size: 0.8em;">
                                åˆ é™¤
                            </button>
                        </td>
                    `;
                    tbody.appendChild(row);
                }
            });
        }

        // åˆ é™¤æ•°æ®æ¡ç›®
        function deleteDataEntry(timestamp) {
            const index = dataHistory.findIndex(entry => entry.time.getTime() == timestamp);
            if (index !== -1) {
                dataHistory.splice(index, 1);
                updateRealTimeData();
                updateDataTable();
                notification.success('æ•°æ®æ¡ç›®å·²åˆ é™¤');
            }
        }

        // ä¿å­˜æ•°æ®
        function saveData(value, status) {
            // è¿™é‡Œå¯ä»¥æ·»åŠ æ•°æ®ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨æˆ–å‘é€åˆ°æœåŠ¡å™¨çš„é€»è¾‘
            console.log('ä¿å­˜æ•°æ®:', { value, status, timestamp: new Date() });
        }

        // æ ¼å¼åŒ–æ—¥æœŸæ—¶é—´
        function formatDateTime(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const hours = String(date.getHours()).padStart(2, '0');
            const minutes = String(date.getMinutes()).padStart(2, '0');
            const seconds = String(date.getSeconds()).padStart(2, '0');
            return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>

</html>