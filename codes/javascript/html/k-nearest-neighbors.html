<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kè¿‘é‚»åˆ†ç±»å™¨å¯è§†åŒ–å¹³å° - kNearestNeighbors</title>
    <link rel="stylesheet" href="../../demo/plugins/modal/style.css">
    <link rel="stylesheet" href="../../demo/plugins/checkbox/style.css">
    <link rel="stylesheet" href="../../demo/plugins/notification/style.css">
    <link rel="stylesheet" href="../../demo/plugins/input-number/style.css">
    <link rel="stylesheet" href="../../demo/plugins/select/style.css">
    <!-- Highlight.js ä»£ç é«˜äº® -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
            padding-bottom: 40px;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .header h1 {
            font-size: 2.8rem;
            margin-bottom: 15px;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 900px;
            margin: 0 auto;
        }

        .main-content {
            display: grid;
            grid-template-columns: 400px 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin-bottom: 10px;
        }

        .card h2 {
            font-size: 1.6rem;
            margin-bottom: 25px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .input-section {
            margin-bottom: 25px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
            font-size: 1rem;
        }

        .input-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .input-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .button-group {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.4);
        }

        .btn-warning {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
        }

        .btn-warning:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(245, 158, 11, 0.4);
        }

        .btn-info {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
        }

        .btn-info:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(239, 68, 68, 0.4);
        }

        .btn:active {
            transform: scale(0.95);
        }

        .btn-block {
            width: 100%;
            justify-content: center;
        }

        .canvas-container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            min-height: 600px;
        }

        #knnCanvas {
            border: 2px solid #e9ecef;
            border-radius: 8px;
            cursor: crosshair;
            background: #f8f9fa;
        }

        .data-list {
            max-height: 200px;
            overflow-y: auto;
            background: #f8f9fa;
            border-radius: 8px;
            padding: 10px;
        }

        .data-item {
            background: white;
            padding: 8px 12px;
            margin-bottom: 6px;
            border-radius: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
        }

        .data-item .coords {
            font-family: 'Monaco', 'Menlo', monospace;
            color: #667eea;
        }

        .class-label {
            padding: 4px 12px;
            border-radius: 6px;
            font-size: 0.85rem;
            font-weight: 600;
            color: white;
        }

        .class-A { background: #ef4444; }
        .class-B { background: #3b82f6; }
        .class-C { background: #10b981; }

        .remove-btn {
            background: #ef4444;
            color: white;
            border: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }

        .remove-btn:hover {
            background: #dc2626;
            transform: scale(1.1);
        }

        .prediction-result {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin-top: 15px;
        }

        .prediction-result.success {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }

        .prediction-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .prediction-class {
            font-size: 2.5rem;
            font-weight: 700;
            margin: 10px 0;
        }

        .neighbors-list {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }

        .neighbors-list h3 {
            font-size: 1.1rem;
            margin-bottom: 12px;
            color: #495057;
        }

        .neighbor-item {
            padding: 10px;
            background: #f8f9fa;
            border-radius: 6px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .stats-section {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #6c757d;
        }

        .code-block {
            margin-top: 15px;
            border-radius: 8px;
            overflow: hidden;
        }

        .code-block pre {
            margin: 0;
            padding: 20px;
            overflow-x: auto;
            background: #282c34;
            border-radius: 8px;
        }

        .code-block pre code {
            font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
            font-size: 0.85rem;
            line-height: 1.6;
            display: block;
        }

        .hljs {
            background: #282c34;
            padding: 0;
        }

        .advanced-options {
            margin-top: 25px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
        }

        .options-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: #495057;
        }

        .legend {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 12px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-shape {
            width: 20px;
            height: 20px;
            border-radius: 50%;
        }

        .legend-shape.square {
            border-radius: 4px;
        }

        .modal-content {
            max-height: 400px;
            overflow-y: auto;
        }

        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 2.2rem;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¯ Kè¿‘é‚»åˆ†ç±»å™¨å¯è§†åŒ–å¹³å°</h1>
            <p>åŸºäº K-Nearest Neighbors ç®—æ³•çš„æ™ºèƒ½åˆ†ç±»å·¥å…·ï¼Œæ”¯æŒå¯è§†åŒ–è®­ç»ƒæ•°æ®ã€å®æ—¶åˆ†ç±»é¢„æµ‹ã€åŠ¨æ€è°ƒæ•´Kå€¼</p>
        </div>

        <div class="main-content">
            <!-- å·¦ä¾§ï¼šæ§åˆ¶é¢æ¿ -->
            <div class="sidebar">
                <div class="card">
                    <h2>âš™ï¸ åˆ†ç±»å™¨é…ç½®</h2>
                    <div class="input-section">
                        <div class="input-group">
                            <label for="kValue">Kå€¼ï¼ˆé‚»å±…æ•°é‡ï¼‰</label>
                            <div id="kValueInput"></div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h2>ğŸ“š è®­ç»ƒæ•°æ®</h2>
                    <div class="input-section">
                        <div class="input-group">
                            <label>ç±»åˆ«é€‰æ‹©</label>
                            <div id="classSelect"></div>
                        </div>

                        <div class="input-group">
                            <label>æ‰‹åŠ¨æ·»åŠ è®­ç»ƒç‚¹</label>
                            <div class="input-row">
                                <input type="number" id="trainX" placeholder="X åæ ‡" step="0.1">
                                <input type="number" id="trainY" placeholder="Y åæ ‡" step="0.1">
                            </div>
                        </div>

                        <div class="button-group">
                            <button class="btn btn-success" onclick="window.knnTool?.addTrainingPoint()">â• æ·»åŠ è®­ç»ƒç‚¹</button>
                        </div>

                        <div class="button-group">
                            <button class="btn btn-info" onclick="window.knnTool?.generateTrainingData()">ğŸ² ç”Ÿæˆè®­ç»ƒæ•°æ®</button>
                            <button class="btn btn-warning" onclick="window.knnTool?.loadSample()">ğŸ“„ åŠ è½½ç¤ºä¾‹</button>
                        </div>
                    </div>

                    <div class="input-group">
                        <label>è®­ç»ƒæ•°æ®åˆ—è¡¨ (<span id="trainCount">0</span>)</label>
                        <div class="data-list" id="trainingDataList">
                            <div style="text-align: center; padding: 20px; color: #6c757d;">
                                æš‚æ— è®­ç»ƒæ•°æ®
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h2>ğŸ¯ æµ‹è¯•ç‚¹é¢„æµ‹</h2>
                    <div class="input-section">
                        <div class="input-group">
                            <label>æµ‹è¯•ç‚¹åæ ‡</label>
                            <div class="input-row">
                                <input type="number" id="testX" placeholder="X åæ ‡" step="0.1">
                                <input type="number" id="testY" placeholder="Y åæ ‡" step="0.1">
                            </div>
                        </div>

                        <div class="button-group">
                            <button class="btn btn-primary btn-block" onclick="window.knnTool?.predictPoint()">ğŸš€ é¢„æµ‹åˆ†ç±»</button>
                        </div>

                        <div class="button-group">
                            <button class="btn btn-danger" onclick="window.knnTool?.clearAll()">ğŸ—‘ï¸ æ¸…ç©ºæ‰€æœ‰</button>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h2>âš™ï¸ é«˜çº§é€‰é¡¹</h2>
                    <div class="advanced-options">
                        <div id="checkboxGroup"></div>
                    </div>
                </div>
            </div>

            <!-- å³ä¾§ï¼šå¯è§†åŒ–åŒºåŸŸ -->
            <div class="visualization">
                <div class="card">
                    <h2>ğŸ¨ åˆ†ç±»å¯è§†åŒ–</h2>
                    <div class="canvas-container">
                        <canvas id="knnCanvas" width="800" height="600"></canvas>
                        
                        <div class="legend" id="legend">
                            <div style="font-weight: 600; margin-right: 15px;">å›¾ä¾‹ï¼š</div>
                            <div class="legend-item">
                                <div class="legend-shape" style="background: #ef4444;"></div>
                                <span>ç±»åˆ« Aï¼ˆè®­ç»ƒï¼‰</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-shape" style="background: #3b82f6;"></div>
                                <span>ç±»åˆ« Bï¼ˆè®­ç»ƒï¼‰</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-shape" style="background: #10b981;"></div>
                                <span>ç±»åˆ« Cï¼ˆè®­ç»ƒï¼‰</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-shape square" style="background: #f59e0b;"></div>
                                <span>æµ‹è¯•ç‚¹</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card" id="resultSection" style="display: none;">
                    <h2>ğŸ“Š é¢„æµ‹ç»“æœ</h2>
                    <div class="prediction-result success">
                        <div class="prediction-title">é¢„æµ‹ç±»åˆ«</div>
                        <div class="prediction-class" id="predictedClass">-</div>
                        <div id="classInfo" style="font-size: 0.9rem; opacity: 0.9;"></div>
                    </div>

                    <div class="neighbors-list" id="neighborsList">
                        <h3>æœ€è¿‘çš„ K ä¸ªé‚»å±…</h3>
                        <div id="neighborsContent"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ç»Ÿè®¡ä¿¡æ¯ -->
        <div class="card">
            <h2>ğŸ“ˆ ç»Ÿè®¡ä¿¡æ¯</h2>
            <div class="stats-section">
                <div class="stats-grid" id="statsGrid">
                    <!-- ç»Ÿè®¡ä¿¡æ¯å°†åŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
        </div>

        <!-- ä»£ç é¢„è§ˆ -->
        <div class="card" id="codeSection" style="display: none;">
            <h2>ğŸ’» æ‰§è¡Œä»£ç </h2>
            <div class="code-block">
                <pre><code class="language-javascript" id="codePreview">// ä»£ç å°†åœ¨è¿™é‡Œæ˜¾ç¤º</code></pre>
            </div>
        </div>

        <!-- ä½¿ç”¨è¯´æ˜ -->
        <div class="card">
            <h2>ğŸ“– ç®—æ³•è¯´æ˜</h2>
            <div style="background: #f8f9fa; padding: 20px; border-radius: 12px;">
                <h3 style="color: #667eea; margin-bottom: 15px;">K-Nearest Neighbors (KNN) ç®—æ³•</h3>
                <div class="code-block">
                    <pre><code class="language-javascript">const kNearestNeighbors = (data, labels, point, k = 3) => {
    const kNearest = data
        .map((el, i) => ({
            dist: Math.hypot(...Object.keys(el).map(key => 
                point[key] - el[key]
            )),
            label: labels[i]
        }))
        .sort((a, b) => a.dist - b.dist)
        .slice(0, k);

    return kNearest.reduce(
        (acc, { label }, i) => {
            acc.classCounts[label] =
                Object.keys(acc.classCounts).indexOf(label) !== -1
                    ? acc.classCounts[label] + 1
                    : 1;
            if (acc.classCounts[label] > acc.topClassCount) {
                acc.topClassCount = acc.classCounts[label];
                acc.topClass = label;
            }
            return acc;
        },
        {
            classCounts: {},
            topClass: kNearest[0].label,
            topClassCount: 0
        }
    ).topClass;
};</code></pre>
                </div>

                <h3 style="color: #667eea; margin: 20px 0 15px 0;">ç®—æ³•æ­¥éª¤</h3>
                <ol style="color: #495057; padding-left: 20px; line-height: 1.8;">
                    <li><strong>è®¡ç®—è·ç¦»</strong>ï¼šè®¡ç®—æµ‹è¯•ç‚¹åˆ°æ‰€æœ‰è®­ç»ƒæ•°æ®çš„æ¬§æ°è·ç¦»</li>
                    <li><strong>æ’åºé€‰æ‹©</strong>ï¼šæŒ‰è·ç¦»å‡åºæ’åˆ—ï¼Œé€‰æ‹©æœ€è¿‘çš„ K ä¸ªé‚»å±…</li>
                    <li><strong>æŠ•ç¥¨åˆ†ç±»</strong>ï¼šç»Ÿè®¡ K ä¸ªé‚»å±…ä¸­å„ç±»åˆ«çš„æ•°é‡</li>
                    <li><strong>å¤šæ•°è¡¨å†³</strong>ï¼šé€‰æ‹©å‡ºç°æ¬¡æ•°æœ€å¤šçš„ç±»åˆ«ä½œä¸ºé¢„æµ‹ç»“æœ</li>
                </ol>

                <h3 style="color: #667eea; margin: 20px 0 15px 0;">ä½¿ç”¨è¯´æ˜</h3>
                <ul style="color: #495057; padding-left: 20px; line-height: 1.8;">
                    <li>ğŸ“Š <strong>æ·»åŠ è®­ç»ƒæ•°æ®</strong>ï¼šé€‰æ‹©ç±»åˆ«ï¼Œç‚¹å‡»ç”»å¸ƒæˆ–æ‰‹åŠ¨è¾“å…¥åæ ‡</li>
                    <li>ğŸ² <strong>ç”Ÿæˆæ•°æ®</strong>ï¼šè‡ªåŠ¨ç”Ÿæˆåˆ†å¸ƒåœ¨ä¸åŒåŒºåŸŸçš„è®­ç»ƒæ•°æ®</li>
                    <li>ğŸ“„ <strong>åŠ è½½ç¤ºä¾‹</strong>ï¼šåŠ è½½é¢„è®¾çš„ç¤ºä¾‹è®­ç»ƒæ•°æ®</li>
                    <li>ğŸ“ <strong>è®¾ç½® K å€¼</strong>ï¼šè°ƒæ•´é‚»å±…æ•°é‡ï¼ˆ1-15ï¼‰</li>
                    <li>ğŸ¯ <strong>æµ‹è¯•é¢„æµ‹</strong>ï¼šè¾“å…¥æµ‹è¯•ç‚¹åæ ‡è¿›è¡Œåˆ†ç±»é¢„æµ‹</li>
                    <li>ğŸ¨ <strong>å¯è§†åŒ–</strong>ï¼šåœ†ç‚¹è¡¨ç¤ºè®­ç»ƒæ•°æ®ï¼Œæ–¹å—è¡¨ç¤ºæµ‹è¯•ç‚¹</li>
                </ul>

                <h3 style="color: #667eea; margin: 20px 0 15px 0;">åº”ç”¨åœºæ™¯</h3>
                <ul style="color: #495057; padding-left: 20px; line-height: 1.8;">
                    <li>ğŸ·ï¸ <strong>æ–‡æœ¬åˆ†ç±»</strong>ï¼šåƒåœ¾é‚®ä»¶è¯†åˆ«ã€æƒ…æ„Ÿåˆ†æ</li>
                    <li>ğŸ–¼ï¸ <strong>å›¾åƒè¯†åˆ«</strong>ï¼šæ‰‹å†™æ•°å­—è¯†åˆ«ã€å›¾åƒåˆ†ç±»</li>
                    <li>ğŸ¥ <strong>åŒ»ç–—è¯Šæ–­</strong>ï¼šç–¾ç—…é¢„æµ‹ã€ç—‡çŠ¶åˆ†ç±»</li>
                    <li>ğŸ’° <strong>ä¿¡ç”¨è¯„ä¼°</strong>ï¼šå®¢æˆ·ä¿¡ç”¨ç­‰çº§åˆ¤å®š</li>
                    <li>ğŸ¬ <strong>æ¨èç³»ç»Ÿ</strong>ï¼šç›¸ä¼¼ç”¨æˆ·/å•†å“æ¨è</li>
                </ul>

                <h3 style="color: #667eea; margin: 20px 0 15px 0;">K å€¼é€‰æ‹©å»ºè®®</h3>
                <ul style="color: #495057; padding-left: 20px; line-height: 1.8;">
                    <li><strong>K = 1</strong>ï¼šå¯¹å™ªå£°æ•æ„Ÿï¼Œå¯èƒ½è¿‡æ‹Ÿåˆ</li>
                    <li><strong>K = 3-7</strong>ï¼šä¸€èˆ¬æƒ…å†µä¸‹çš„è‰¯å¥½é€‰æ‹©</li>
                    <li><strong>K è¿‡å¤§</strong>ï¼šå¯èƒ½å¯¼è‡´æ¬ æ‹Ÿåˆï¼Œè¾¹ç•Œæ¨¡ç³Š</li>
                    <li><strong>å¥‡æ•° K</strong>ï¼šäºŒåˆ†ç±»æ—¶é¿å…å¹³ç¥¨</li>
                </ul>
            </div>
        </div>
    </div>

    <script src="../../demo/plugins/modal/index.js"></script>
    <script src="../../demo/plugins/checkbox/index.js"></script>
    <script src="../../demo/plugins/notification/index.js"></script>
    <script src="../../demo/plugins/input-number/index.js"></script>
    <script src="../../demo/plugins/select/index.js"></script>
    <!-- Highlight.js ä»£ç é«˜äº® -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
        // æ ¸å¿ƒ K-Nearest Neighbors åˆ†ç±»ç®—æ³•
        const kNearestNeighbors = (data, labels, point, k = 3) => {
  const kNearest = data
    .map((el, i) => ({
      dist: Math.hypot(...Object.keys(el).map(key => point[key] - el[key])),
      label: labels[i]
    }))
    .sort((a, b) => a.dist - b.dist)
    .slice(0, k);

  return kNearest.reduce(
    (acc, { label }, i) => {
      acc.classCounts[label] =
        Object.keys(acc.classCounts).indexOf(label) !== -1
          ? acc.classCounts[label] + 1
          : 1;
      if (acc.classCounts[label] > acc.topClassCount) {
        acc.topClassCount = acc.classCounts[label];
        acc.topClass = label;
      }
      return acc;
    },
    {
      classCounts: {},
      topClass: kNearest[0].label,
      topClassCount: 0
    }
  ).topClass;
};

        // KNN åˆ†ç±»å™¨å¯è§†åŒ–å·¥å…·ç±»
        class KNNTool {
            constructor() {
                this.plugins = {};
                this.trainingData = [];
                this.trainingLabels = [];
                this.testPoint = null;
                this.prediction = null;
                this.neighbors = null;
                this.k = 3;
                this.currentClass = 'A';
                this.canvas = null;
                this.ctx = null;
                this.stats = {
                    totalTrainingPoints: 0,
                    totalPredictions: 0,
                    classCounts: { A: 0, B: 0, C: 0 }
                };
                this.classColors = {
                    A: '#ef4444',
                    B: '#3b82f6',
                    C: '#10b981'
                };
                this.init();
            }

            // åˆå§‹åŒ–
            async init() {
                try {
                    await this.loadPlugins();
                    this.setupCanvas();
                    this.setupInputNumber();
                    this.setupSelect();
                    this.setupCheckboxes();
                    this.initHighlight();
                    this.updateStats();
                    this.showWelcomeMessage();
                } catch (error) {
                    console.error('åˆå§‹åŒ–å¤±è´¥:', error);
                    this.showError('åˆå§‹åŒ–å¤±è´¥: ' + error.message);
                }
            }

            // åˆå§‹åŒ–ä»£ç é«˜äº®
            initHighlight() {
                if (window.hljs) {
                    document.querySelectorAll('pre code').forEach((block) => {
                        hljs.highlightElement(block);
                    });
                    console.log('Highlight.js åˆå§‹åŒ–å®Œæˆ');
                } else {
                    console.warn('Highlight.js æœªåŠ è½½');
                }
            }

            // åŠ è½½æ’ä»¶
            async loadPlugins() {
                try {
                    this.plugins.modal = new Modal();
                    this.plugins.notification = new Notification();
                } catch (error) {
                    console.warn('éƒ¨åˆ†æ’ä»¶åŠ è½½å¤±è´¥:', error);
                }
            }

            // è®¾ç½® Canvas
            setupCanvas() {
                this.canvas = document.getElementById('knnCanvas');
                if (!this.canvas) return;
                
                this.ctx = this.canvas.getContext('2d');
                
                // ç‚¹å‡»äº‹ä»¶ï¼šæ·»åŠ è®­ç»ƒæ•°æ®ç‚¹
                this.canvas.addEventListener('click', (e) => {
                    if (this.getCheckboxValue('clickToAdd')) {
                        const rect = this.canvas.getBoundingClientRect();
                        const x = e.clientX - rect.left;
                        const y = e.clientY - rect.top;
                        this.addTrainingData({ x, y }, this.currentClass);
                    }
                });

                this.drawCanvas();
            }

            // è®¾ç½® InputNumber
            setupInputNumber() {
                const kValueInput = document.getElementById('kValueInput');
                if (!kValueInput) return;

                try {
                    this.plugins.kValueInput = new InputNumber({
                        container: kValueInput,
                        value: 3,
                        min: 1,
                        max: 15,
                        step: 1,
                        onChange: (value) => {
                            this.k = value;
                        }
                    });
                } catch (error) {
                    console.warn('InputNumber æ’ä»¶åŠ è½½å¤±è´¥ï¼Œä½¿ç”¨åŸç”Ÿè¾“å…¥:', error);
                    kValueInput.innerHTML = '<input type="number" id="kValueNative" value="3" min="1" max="15" step="1">';
                    const nativeInput = document.getElementById('kValueNative');
                    if (nativeInput) {
                        nativeInput.addEventListener('change', (e) => {
                            this.k = parseInt(e.target.value) || 3;
                        });
                    }
                }
            }

            // è®¾ç½® Select
            setupSelect() {
                const classSelect = document.getElementById('classSelect');
                if (!classSelect) return;

                try {
                    const classOptions = [
                        { value: 'A', label: 'ç±»åˆ« A (çº¢è‰²)' },
                        { value: 'B', label: 'ç±»åˆ« B (è“è‰²)' },
                        { value: 'C', label: 'ç±»åˆ« C (ç»¿è‰²)' }
                    ];

                    this.plugins.classSelect = new Select({
                        container: classSelect,
                        options: classOptions,
                        placeholder: 'é€‰æ‹©ç±»åˆ«',
                        onChange: (value) => {
                            this.currentClass = value;
                        }
                    });

                    this.plugins.classSelect.setValue('A');
                } catch (error) {
                    console.warn('Select æ’ä»¶åŠ è½½å¤±è´¥ï¼Œä½¿ç”¨åŸç”Ÿä¸‹æ‹‰æ¡†:', error);
                    classSelect.innerHTML = `
                        <select id="classSelectNative" style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 12px; font-size: 1rem;">
                            <option value="A">ç±»åˆ« A (çº¢è‰²)</option>
                            <option value="B">ç±»åˆ« B (è“è‰²)</option>
                            <option value="C">ç±»åˆ« C (ç»¿è‰²)</option>
                        </select>
                    `;
                    const nativeSelect = document.getElementById('classSelectNative');
                    if (nativeSelect) {
                        nativeSelect.addEventListener('change', (e) => {
                            this.currentClass = e.target.value;
                        });
                    }
                }
            }

            // è®¾ç½®å¤é€‰æ¡†
            setupCheckboxes() {
                const checkboxGroup = document.getElementById('checkboxGroup');
                if (!checkboxGroup) return;

                const options = [
                    { id: 'clickToAdd', label: 'ç‚¹å‡»ç”»å¸ƒæ·»åŠ è®­ç»ƒç‚¹', checked: true },
                    { id: 'showNeighbors', label: 'æ˜¾ç¤ºæœ€è¿‘é‚»å±…è¿çº¿', checked: true },
                    { id: 'showNotifications', label: 'æ˜¾ç¤ºé€šçŸ¥æé†’', checked: true },
                    { id: 'showCode', label: 'æ˜¾ç¤ºæ‰§è¡Œä»£ç ', checked: true }
                ];

                try {
                    const checkboxGroupInstance = Checkbox.createCheckboxGroup({
                        items: options.map(option => ({
                            id: option.id,
                            label: option.label,
                            checked: option.checked
                        })),
                        onChange: (checkedStates) => {
                            this.drawCanvas();
                        }
                    });

                    checkboxGroup.appendChild(checkboxGroupInstance.container);
                    this.plugins.checkboxGroup = checkboxGroupInstance;
                    this.checkboxOptions = options;
                } catch (error) {
                    console.warn('è‡ªå®šä¹‰å¤é€‰æ¡†åŠ è½½å¤±è´¥ï¼Œä½¿ç”¨åŸç”Ÿå¤é€‰æ¡†:', error);
                    this.setupNativeCheckboxes(options, checkboxGroup);
                }
            }

            // è®¾ç½®åŸç”Ÿå¤é€‰æ¡†
            setupNativeCheckboxes(options, container) {
                options.forEach(option => {
                    const checkboxItem = document.createElement('div');
                    checkboxItem.style.marginBottom = '10px';
                    checkboxItem.innerHTML = `
                        <input type="checkbox" id="${option.id}" ${option.checked ? 'checked' : ''}>
                        <label for="${option.id}" style="margin-left: 8px; cursor: pointer;">${option.label}</label>
                    `;
                    container.appendChild(checkboxItem);
                    
                    const checkbox = checkboxItem.querySelector('input');
                    if (checkbox) {
                        checkbox.addEventListener('change', () => {
                            this.drawCanvas();
                        });
                    }
                });
            }

            // è·å–å¤é€‰æ¡†å€¼
            getCheckboxValue(checkboxId) {
                if (this.plugins.checkboxGroup && this.checkboxOptions) {
                    try {
                        const optionIndex = this.checkboxOptions.findIndex(option => option.id === checkboxId);
                        if (optionIndex !== -1) {
                            const checkedStates = this.plugins.checkboxGroup.getAllChecked();
                            return checkedStates[optionIndex] || false;
                        }
                    } catch (error) {
                        console.warn('è·å–å¤é€‰æ¡†å€¼å¤±è´¥ï¼Œä½¿ç”¨åŸç”Ÿæ–¹æ³•:', error);
                    }
                }

                const checkbox = document.getElementById(checkboxId);
                return checkbox ? checkbox.checked : false;
            }

            // æ·»åŠ è®­ç»ƒæ•°æ®
            addTrainingData(point, label) {
                this.trainingData.push([point.x, point.y]);
                this.trainingLabels.push(label);
                this.stats.totalTrainingPoints++;
                this.stats.classCounts[label]++;
                
                this.updateTrainingDataList();
                this.drawCanvas();
                this.updateStats();
                
                this.showNotification(`å·²æ·»åŠ è®­ç»ƒç‚¹ (ç±»åˆ« ${label})`, 'success');
            }

            // æ‰‹åŠ¨æ·»åŠ è®­ç»ƒç‚¹
            addTrainingPoint() {
                const trainX = document.getElementById('trainX');
                const trainY = document.getElementById('trainY');

                if (!trainX || !trainY) return;

                const x = parseFloat(trainX.value);
                const y = parseFloat(trainY.value);

                if (isNaN(x) || isNaN(y)) {
                    this.showError('è¯·è¾“å…¥æœ‰æ•ˆçš„åæ ‡å€¼');
                    return;
                }

                const clampedX = Math.max(0, Math.min(this.canvas.width, x));
                const clampedY = Math.max(0, Math.min(this.canvas.height, y));

                this.addTrainingData({ x: clampedX, y: clampedY }, this.currentClass);
                
                trainX.value = '';
                trainY.value = '';
                trainX.focus();
            }

            // ç”Ÿæˆè®­ç»ƒæ•°æ®
            generateTrainingData() {
                const regions = [
                    { center: [150, 150], label: 'A', count: 15 },
                    { center: [650, 150], label: 'B', count: 15 },
                    { center: [400, 450], label: 'C', count: 15 }
                ];

                regions.forEach(region => {
                    for (let i = 0; i < region.count; i++) {
                        const angle = Math.random() * Math.PI * 2;
                        const radius = Math.random() * 80 + 20;
                        const x = region.center[0] + Math.cos(angle) * radius;
                        const y = region.center[1] + Math.sin(angle) * radius;
                        
                        this.trainingData.push([
                            Math.max(0, Math.min(this.canvas.width, x)),
                            Math.max(0, Math.min(this.canvas.height, y))
                        ]);
                        this.trainingLabels.push(region.label);
                        this.stats.totalTrainingPoints++;
                        this.stats.classCounts[region.label]++;
                    }
                });

                this.updateTrainingDataList();
                this.drawCanvas();
                this.updateStats();
                this.showNotification('å·²ç”Ÿæˆ 45 ä¸ªè®­ç»ƒæ•°æ®ç‚¹', 'success');
            }

            // åŠ è½½ç¤ºä¾‹æ•°æ®
            loadSample() {
                const sampleData = [
                    [[100, 100], 'A'], [[120, 110], 'A'], [[95, 115], 'A'],
                    [[130, 105], 'A'], [[110, 125], 'A'], [[85, 95], 'A'],
                    [[650, 150], 'B'], [[670, 160], 'B'], [[640, 145], 'B'],
                    [[680, 155], 'B'], [[660, 170], 'B'], [[625, 140], 'B'],
                    [[400, 450], 'C'], [[420, 460], 'C'], [[390, 445], 'C'],
                    [[410, 470], 'C'], [[380, 455], 'C'], [[430, 440], 'C']
                ];

                sampleData.forEach(([point, label]) => {
                    this.trainingData.push(point);
                    this.trainingLabels.push(label);
                    this.stats.totalTrainingPoints++;
                    this.stats.classCounts[label]++;
                });

                this.updateTrainingDataList();
                this.drawCanvas();
                this.updateStats();
                this.showNotification('ç¤ºä¾‹æ•°æ®å·²åŠ è½½', 'success');
            }

            // æ›´æ–°è®­ç»ƒæ•°æ®åˆ—è¡¨
            updateTrainingDataList() {
                const list = document.getElementById('trainingDataList');
                const trainCount = document.getElementById('trainCount');

                if (!list) return;

                if (trainCount) {
                    trainCount.textContent = this.trainingData.length;
                }

                if (this.trainingData.length === 0) {
                    list.innerHTML = '<div style="text-align: center; padding: 20px; color: #6c757d;">æš‚æ— è®­ç»ƒæ•°æ®</div>';
                    return;
                }

                let html = '';
                this.trainingData.forEach((point, index) => {
                    const label = this.trainingLabels[index];
                    html += `
                        <div class="data-item">
                            <span class="coords">(${point[0].toFixed(1)}, ${point[1].toFixed(1)})</span>
                            <div style="display: flex; gap: 8px; align-items: center;">
                                <span class="class-label class-${label}">ç±»åˆ« ${label}</span>
                                <button class="remove-btn" onclick="window.knnTool?.removeTrainingPoint(${index})" title="åˆ é™¤">Ã—</button>
                            </div>
                        </div>
                    `;
                });

                list.innerHTML = html;
            }

            // ç§»é™¤è®­ç»ƒç‚¹
            removeTrainingPoint(index) {
                if (index >= 0 && index < this.trainingData.length) {
                    const label = this.trainingLabels[index];
                    this.trainingData.splice(index, 1);
                    this.trainingLabels.splice(index, 1);
                    this.stats.classCounts[label]--;
                    
                    this.updateTrainingDataList();
                    this.drawCanvas();
                    this.updateStats();
                }
            }

            // æ¸…ç©ºæ‰€æœ‰æ•°æ®
            clearAll() {
                this.trainingData = [];
                this.trainingLabels = [];
                this.testPoint = null;
                this.prediction = null;
                this.neighbors = null;
                this.stats.totalTrainingPoints = 0;
                this.stats.classCounts = { A: 0, B: 0, C: 0 };
                
                this.updateTrainingDataList();
                this.drawCanvas();
                this.updateStats();
                
                const resultSection = document.getElementById('resultSection');
                if (resultSection) resultSection.style.display = 'none';
                
                this.showNotification('æ‰€æœ‰æ•°æ®å·²æ¸…ç©º', 'info');
            }

            // ç»˜åˆ¶ Canvas
            drawCanvas() {
                if (!this.ctx) return;

                // æ¸…ç©ºç”»å¸ƒ
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);

                // ç»˜åˆ¶ç½‘æ ¼
                this.drawGrid();

                // ç»˜åˆ¶è®­ç»ƒæ•°æ®ç‚¹
                this.trainingData.forEach((point, index) => {
                    const label = this.trainingLabels[index];
                    const color = this.classColors[label];
                    
                    this.ctx.beginPath();
                    this.ctx.arc(point[0], point[1], 6, 0, Math.PI * 2);
                    this.ctx.fillStyle = color;
                    this.ctx.fill();
                    this.ctx.strokeStyle = 'white';
                    this.ctx.lineWidth = 2;
                    this.ctx.stroke();
                });

                // ç»˜åˆ¶æµ‹è¯•ç‚¹
                if (this.testPoint) {
                    this.ctx.fillStyle = '#f59e0b';
                    this.ctx.fillRect(this.testPoint.x - 8, this.testPoint.y - 8, 16, 16);
                    this.ctx.strokeStyle = 'white';
                    this.ctx.lineWidth = 2;
                    this.ctx.strokeRect(this.testPoint.x - 8, this.testPoint.y - 8, 16, 16);

                    // ç»˜åˆ¶æœ€è¿‘é‚»å±…è¿çº¿
                    if (this.neighbors && this.getCheckboxValue('showNeighbors')) {
                        this.neighbors.forEach((neighbor, i) => {
                            const point = this.trainingData[neighbor.index];
                            
                            this.ctx.beginPath();
                            this.ctx.moveTo(this.testPoint.x, this.testPoint.y);
                            this.ctx.lineTo(point[0], point[1]);
                            this.ctx.strokeStyle = this.classColors[neighbor.label];
                            this.ctx.lineWidth = 2;
                            this.ctx.setLineDash([5, 5]);
                            this.ctx.stroke();
                            this.ctx.setLineDash([]);
                        });
                    }
                }
            }

            // ç»˜åˆ¶ç½‘æ ¼
            drawGrid() {
                this.ctx.strokeStyle = '#e9ecef';
                this.ctx.lineWidth = 1;
                
                for (let x = 0; x <= this.canvas.width; x += 50) {
                    this.ctx.beginPath();
                    this.ctx.moveTo(x, 0);
                    this.ctx.lineTo(x, this.canvas.height);
                    this.ctx.stroke();
                }
                
                for (let y = 0; y <= this.canvas.height; y += 50) {
                    this.ctx.beginPath();
                    this.ctx.moveTo(0, y);
                    this.ctx.lineTo(this.canvas.width, y);
                    this.ctx.stroke();
                }
            }

            // é¢„æµ‹åˆ†ç±»
            predictPoint() {
                if (this.trainingData.length === 0) {
                    this.showError('è¯·å…ˆæ·»åŠ è®­ç»ƒæ•°æ®');
                    return;
                }

                const testX = document.getElementById('testX');
                const testY = document.getElementById('testY');

                if (!testX || !testY) return;

                const x = parseFloat(testX.value);
                const y = parseFloat(testY.value);

                if (isNaN(x) || isNaN(y)) {
                    this.showError('è¯·è¾“å…¥æœ‰æ•ˆçš„æµ‹è¯•ç‚¹åæ ‡');
                    return;
                }

                const clampedX = Math.max(0, Math.min(this.canvas.width, x));
                const clampedY = Math.max(0, Math.min(this.canvas.height, y));

                this.testPoint = { x: clampedX, y: clampedY };

                // å‡†å¤‡æ•°æ®
                const data = this.trainingData.map(p => ({ x: p[0], y: p[1] }));
                const point = { x: clampedX, y: clampedY };

                // æ‰§è¡ŒKNNé¢„æµ‹
                try {
                    this.prediction = kNearestNeighbors(data, this.trainingLabels, point, this.k);
                    
                    // è®¡ç®—é‚»å±…ä¿¡æ¯
                    this.neighbors = data
                        .map((el, i) => ({
                            index: i,
                            dist: Math.hypot(point.x - el.x, point.y - el.y),
                            label: this.trainingLabels[i]
                        }))
                        .sort((a, b) => a.dist - b.dist)
                        .slice(0, this.k);

                    this.stats.totalPredictions++;
                    
                    this.displayPredictionResult();
                    this.drawCanvas();
                    this.updateStats();

                    if (this.getCheckboxValue('showCode')) {
                        this.showCode();
                    }

                    this.showNotification('é¢„æµ‹å®Œæˆï¼', 'success');
                } catch (error) {
                    this.showError('é¢„æµ‹å¤±è´¥: ' + error.message);
                    console.error('é¢„æµ‹é”™è¯¯:', error);
                }
            }

            // æ˜¾ç¤ºé¢„æµ‹ç»“æœ
            displayPredictionResult() {
                const resultSection = document.getElementById('resultSection');
                const predictedClass = document.getElementById('predictedClass');
                const classInfo = document.getElementById('classInfo');
                const neighborsContent = document.getElementById('neighborsContent');

                if (!resultSection) return;

                resultSection.style.display = 'block';

                if (predictedClass) {
                    predictedClass.textContent = `ç±»åˆ« ${this.prediction}`;
                    predictedClass.parentElement.style.background = 
                        `linear-gradient(135deg, ${this.classColors[this.prediction]}, ${this.classColors[this.prediction]}dd)`;
                }

                if (classInfo) {
                    const counts = {};
                    this.neighbors.forEach(n => {
                        counts[n.label] = (counts[n.label] || 0) + 1;
                    });
                    classInfo.textContent = `åŸºäºæœ€è¿‘çš„ ${this.k} ä¸ªé‚»å±…æŠ•ç¥¨ï¼š${Object.entries(counts).map(([label, count]) => `${label}(${count})`).join(', ')}`;
                }

                if (neighborsContent) {
                    let html = '';
                    this.neighbors.forEach((neighbor, i) => {
                        html += `
                            <div class="neighbor-item">
                                <div>
                                    <span style="font-weight: 600;">#${i + 1}</span>
                                    <span style="margin-left: 10px; font-family: Monaco, monospace;">
                                        (${this.trainingData[neighbor.index][0].toFixed(1)}, ${this.trainingData[neighbor.index][1].toFixed(1)})
                                    </span>
                                </div>
                                <div style="display: flex; gap: 10px; align-items: center;">
                                    <span class="class-label class-${neighbor.label}">ç±»åˆ« ${neighbor.label}</span>
                                    <span style="font-size: 0.85rem; color: #6c757d;">
                                        è·ç¦»: ${neighbor.dist.toFixed(2)}
                                    </span>
                                </div>
                            </div>
                        `;
                    });
                    neighborsContent.innerHTML = html;
                }

                setTimeout(() => {
                    resultSection.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                }, 100);
            }

            // æ˜¾ç¤ºä»£ç 
            showCode() {
                const codeSection = document.getElementById('codeSection');
                const codePreview = document.getElementById('codePreview');

                if (!codePreview) return;

                const code = `// è®­ç»ƒæ•°æ®
const trainingData = [
${this.trainingData.slice(0, 3).map(p => `    { x: ${p[0].toFixed(1)}, y: ${p[1].toFixed(1)} }`).join(',\n')}${this.trainingData.length > 3 ? ',\n    // ... æ›´å¤šæ•°æ®ç‚¹' : ''}
];

const trainingLabels = [${this.trainingLabels.slice(0, 3).map(l => `'${l}'`).join(', ')}${this.trainingLabels.length > 3 ? ', ...' : ''}];

// æµ‹è¯•ç‚¹
const testPoint = { x: ${this.testPoint.x.toFixed(1)}, y: ${this.testPoint.y.toFixed(1)} };

// è®¾ç½® K å€¼
const k = ${this.k};

// æ‰§è¡Œ KNN åˆ†ç±»
const prediction = kNearestNeighbors(trainingData, trainingLabels, testPoint, k);

// é¢„æµ‹ç»“æœ: '${this.prediction}'

// æœ€è¿‘çš„ ${this.k} ä¸ªé‚»å±…:
${this.neighbors ? this.neighbors.map((n, i) => `// #${i + 1}: ç±»åˆ« ${n.label}, è·ç¦» ${n.dist.toFixed(2)}`).join('\n') : ''}`;

                codePreview.textContent = code;
                if (window.hljs) {
                    hljs.highlightElement(codePreview);
                }

                if (codeSection) {
                    codeSection.style.display = 'block';
                }
            }

            // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
            updateStats() {
                const statsGrid = document.getElementById('statsGrid');
                if (!statsGrid) return;

                statsGrid.innerHTML = `
                    <div class="stat-card">
                        <div class="stat-number">${this.trainingData.length}</div>
                        <div class="stat-label">è®­ç»ƒæ•°æ®æ•°</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${this.k}</div>
                        <div class="stat-label">å½“å‰ K å€¼</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${this.stats.totalPredictions}</div>
                        <div class="stat-label">é¢„æµ‹æ¬¡æ•°</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${this.stats.classCounts.A}</div>
                        <div class="stat-label">ç±»åˆ« A æ•°é‡</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${this.stats.classCounts.B}</div>
                        <div class="stat-label">ç±»åˆ« B æ•°é‡</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${this.stats.classCounts.C}</div>
                        <div class="stat-label">ç±»åˆ« C æ•°é‡</div>
                    </div>
                `;
            }

            // æ˜¾ç¤ºé€šçŸ¥
            showNotification(message, type) {
                if (this.plugins.notification && this.getCheckboxValue('showNotifications')) {
                    this.plugins.notification.show(message, type);
                } else {
                    console.log(`${type.toUpperCase()}: ${message}`);
                }
            }

            // æ˜¾ç¤ºé”™è¯¯
            showError(message) {
                this.showNotification(message, 'error');
            }

            // æ˜¾ç¤ºæ¬¢è¿æ¶ˆæ¯
            showWelcomeMessage() {
                if (this.plugins.modal) {
                    this.plugins.modal.show({
                        title: 'ğŸ‰ æ¬¢è¿ä½¿ç”¨ Kè¿‘é‚»åˆ†ç±»å™¨å¯è§†åŒ–å¹³å°',
                        content: `
                            <div style="padding: 20px;">
                                <div style="text-align: center; margin-bottom: 20px;">
                                    <div style="font-size: 48px; margin-bottom: 15px;">ğŸ¯</div>
                                    <h3 style="margin: 0 0 10px 0; color: #667eea;">åŠŸèƒ½ç‰¹è‰²</h3>
                                </div>

                                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                                    <ul style="margin: 0; padding-left: 20px; color: #495057;">
                                        <li>å¼ºå¤§çš„ Kè¿‘é‚»åˆ†ç±»ç®—æ³•</li>
                                        <li>å¯è§†åŒ–è®­ç»ƒæ•°æ®å’Œæµ‹è¯•ç‚¹</li>
                                        <li>äº¤äº’å¼æ•°æ®æ·»åŠ ï¼ˆç‚¹å‡»ç”»å¸ƒï¼‰</li>
                                        <li>åŠ¨æ€è°ƒæ•´ K å€¼ï¼ˆ1-15ï¼‰</li>
                                        <li>å®æ—¶æ˜¾ç¤ºé¢„æµ‹ç»“æœ</li>
                                        <li>å±•ç¤ºæœ€è¿‘é‚»å±…å’Œè¿çº¿</li>
                                    </ul>
                                </div>

                                <div style="background: #e8f5e8; padding: 12px; border-radius: 6px; border-left: 4px solid #10b981; margin-bottom: 15px;">
                                    <p style="margin: 0; font-size: 14px; color: #16a34a;">
                                        <strong>ğŸ’¡ ä½¿ç”¨æ­¥éª¤ï¼š</strong>
                                    </p>
                                    <ol style="margin: 8px 0 0 0; padding-left: 20px; color: #16a34a; font-size: 14px;">
                                        <li>é€‰æ‹©ç±»åˆ«ï¼ˆA/B/Cï¼‰</li>
                                        <li>ç‚¹å‡»ç”»å¸ƒæˆ–æ‰‹åŠ¨è¾“å…¥åæ ‡æ·»åŠ è®­ç»ƒæ•°æ®</li>
                                        <li>æˆ–ä½¿ç”¨"ç”Ÿæˆæ•°æ®"/"åŠ è½½ç¤ºä¾‹"</li>
                                        <li>è®¾ç½® K å€¼ï¼ˆé‚»å±…æ•°é‡ï¼‰</li>
                                        <li>è¾“å…¥æµ‹è¯•ç‚¹åæ ‡å¹¶é¢„æµ‹åˆ†ç±»</li>
                                    </ol>
                                </div>

                                <div style="background: #fef3c7; padding: 12px; border-radius: 6px; border-left: 4px solid #f59e0b;">
                                    <p style="margin: 0; font-size: 14px; color: #d97706;">
                                        <strong>ğŸ¨ å¯è§†åŒ–è¯´æ˜ï¼š</strong> åœ†ç‚¹è¡¨ç¤ºè®­ç»ƒæ•°æ®ï¼ˆçº¢/è“/ç»¿ï¼‰ï¼Œæ–¹å—è¡¨ç¤ºæµ‹è¯•ç‚¹ï¼ˆæ©™è‰²ï¼‰ï¼Œè™šçº¿è¿æ¥æœ€è¿‘çš„ K ä¸ªé‚»å±…ã€‚
                                    </p>
                                </div>
                            </div>
                        `,
                        type: "alert"
                    });
                }
            }
        }

        // åˆå§‹åŒ–åº”ç”¨
        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOMå†…å®¹åŠ è½½å®Œæˆï¼Œå¼€å§‹åˆå§‹åŒ–...');
            window.knnTool = new KNNTool();
            console.log('Kè¿‘é‚»åˆ†ç±»å™¨å¯è§†åŒ–å¹³å°åˆå§‹åŒ–å®Œæˆ');
        });

        // å¦‚æœ DOMContentLoaded å·²ç»è§¦å‘ï¼Œç«‹å³æ‰§è¡Œ
        if (document.readyState === 'loading') {
            console.log('æ–‡æ¡£ä»åœ¨åŠ è½½ï¼Œç­‰å¾… DOMContentLoaded äº‹ä»¶...');
        } else {
            console.log('æ–‡æ¡£å·²åŠ è½½å®Œæˆï¼Œç«‹å³æ‰§è¡Œåˆå§‹åŒ–...');
            window.knnTool = new KNNTool();
        }
    </script>
</body>

</html>