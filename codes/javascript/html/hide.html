<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å›¾ç‰‡ç”»å»Šç®¡ç†ç³»ç»Ÿ - åŸºäº hide å‡½æ•°</title>
    <!-- å¼•å…¥è‡ªå®šä¹‰æ’ä»¶ -->
    <link rel="stylesheet" href="../../demo/plugins/modal/style.css">
    <link rel="stylesheet" href="../../demo/plugins/checkbox/style.css">
    <link rel="stylesheet" href="../../demo/plugins/datetime-picker/style.css">
    <link rel="stylesheet" href="../../demo/plugins/input-number/style.css">
    <link rel="stylesheet" href="../../demo/plugins/notification/style.css">
    <link rel="stylesheet" href="../../demo/plugins/select/style.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }

        .main-content {
            padding: 30px;
        }

        .modal-content {
            max-height: 400px;
            overflow-y: auto;
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            align-items: center;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #f8f9fa;
            color: #495057;
            border: 1px solid #dee2e6;
        }

        .btn-secondary:hover {
            background: #e9ecef;
        }

        .btn-success {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(40, 167, 69, 0.3);
        }

        .btn-danger {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
            color: white;
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(220, 53, 69, 0.3);
        }

        .btn-warning {
            background: linear-gradient(135deg, #ffc107 0%, #e0a800 100%);
            color: #212529;
        }

        .btn-warning:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(255, 193, 7, 0.3);
        }

        .stats {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .stat-card {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            flex: 1;
            min-width: 150px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }

        .stat-number {
            font-size: 2em;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #6c757d;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .gallery-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 30px;
        }

        .gallery-item {
            border: 2px solid #e9ecef;
            background: linear-gradient(135deg, #9495e9 10%, #3d35e2 90%);
            border-radius: 12px;
            width: 280px;
            height: 280px;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .gallery-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
        }

        .gallery-item.hidden {
            background: linear-gradient(135deg, #f8f9fa 10%, #e9ecef 90%);
        }

        .gallery-item.hidden .gallery-item-img {
            opacity: 0;
        }

        .gallery-item-img {
            object-fit: cover;
            width: 100%;
            height: 100%;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .gallery-item-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
            font-weight: 600;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .gallery-item.hidden .gallery-item-overlay {
            opacity: 1;
        }

        .gallery-item-overlay::after {
            content: attr(data-text);
        }

        .gallery-item-actions {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 5px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .gallery-item:hover .gallery-item-actions {
            opacity: 1;
        }

        .action-btn {
            width: 30px;
            height: 30px;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .action-btn-hide {
            background: #dc3545;
            color: white;
        }

        .action-btn-show {
            background: #28a745;
            color: white;
        }

        .action-btn-edit {
            background: #ffc107;
            color: #212529;
        }

        .action-btn:hover {
            transform: scale(1.1);
        }

        .gallery-item-info {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0,0,0,0.8));
            color: white;
            padding: 15px;
            font-size: 14px;
        }

        .gallery-item-title {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .gallery-item-category {
            opacity: 0.8;
            font-size: 12px;
        }

        .filters {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }

        .filter-row {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .filter-label {
            font-weight: 600;
            color: #2c3e50;
            font-size: 14px;
        }

        .filter-input {
            padding: 8px 12px;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .filter-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .plugin-container {
            position: relative;
        }

        .bulk-actions {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }

        .bulk-actions-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .select-all-checkbox {
            margin-right: 10px;
        }

        .bulk-actions-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }

        .form-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 14px;
            resize: vertical;
            min-height: 100px;
            transition: border-color 0.3s ease;
        }

        .form-textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .plugin-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
            font-size: 14px;
        }

        @media (max-width: 768px) {
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .stats {
                flex-direction: column;
            }
            
            .gallery-container {
                justify-content: center;
            }
            
            .gallery-item {
                width: 100%;
                max-width: 300px;
            }
            
            .filter-row {
                flex-direction: column;
                align-items: stretch;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ–¼ï¸ å›¾ç‰‡ç”»å»Šç®¡ç†ç³»ç»Ÿ</h1>
            <p>åŸºäº hide å‡½æ•°çš„å›¾ç‰‡å±•ç¤ºä¸æ§åˆ¶å·¥å…·</p>
        </div>

        <div class="main-content">
            <!-- æ§åˆ¶æŒ‰é’® -->
            <div class="controls">
                <button class="btn btn-primary" onclick="showAddImageModal()">
                    â• æ·»åŠ å›¾ç‰‡
                </button>
                <button class="btn btn-success" onclick="showCategoryManager()">
                    ğŸ“‚ åˆ†ç±»ç®¡ç†
                </button>
                <button class="btn btn-warning" onclick="showBulkOperations()">
                    ğŸ”§ æ‰¹é‡æ“ä½œ
                </button>
                <button class="btn btn-secondary" onclick="showGallerySettings()">
                    âš™ï¸ ç”»å»Šè®¾ç½®
                </button>
                <button class="btn btn-danger" onclick="resetGallery()">
                    ğŸ”„ é‡ç½®ç”»å»Š
                </button>
            </div>

            <!-- ç»Ÿè®¡ä¿¡æ¯ -->
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-number" id="totalImages">0</div>
                    <div class="stat-label">æ€»å›¾ç‰‡æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="visibleImages">0</div>
                    <div class="stat-label">å¯è§å›¾ç‰‡</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="hiddenImages">0</div>
                    <div class="stat-label">éšè—å›¾ç‰‡</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="categories">0</div>
                    <div class="stat-label">åˆ†ç±»æ•°é‡</div>
                </div>
            </div>

            <!-- ç­›é€‰å™¨ -->
            <div class="filters">
                <h3>ğŸ” ç­›é€‰ä¸æœç´¢</h3>
                <div class="filter-row">
                    <div class="filter-group">
                        <label class="filter-label">åˆ†ç±»ç­›é€‰</label>
                        <div class="plugin-container">
                            <div id="categoryFilter"></div>
                        </div>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">æ˜¾ç¤ºçŠ¶æ€</label>
                        <div class="plugin-container">
                            <div id="statusFilter"></div>
                        </div>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">æœç´¢å›¾ç‰‡</label>
                        <input type="text" class="filter-input" id="searchInput" placeholder="è¾“å…¥å›¾ç‰‡æ ‡é¢˜æˆ–æè¿°...">
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">æ’åºæ–¹å¼</label>
                        <div class="plugin-container">
                            <div id="sortFilter"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- æ‰¹é‡æ“ä½œ -->
            <div class="bulk-actions">
                            <div class="bulk-actions-header">
                <div class="plugin-container">
                    <div id="selectAllCheckbox"></div>
                </div>
                <span>å…¨é€‰</span>
                <span id="selectedCount">(0 ä¸ªå·²é€‰æ‹©)</span>
            </div>
                <div class="bulk-actions-buttons">
                    <button class="btn btn-success" onclick="bulkShow()">æ˜¾ç¤ºé€‰ä¸­</button>
                    <button class="btn btn-danger" onclick="bulkHide()">éšè—é€‰ä¸­</button>
                    <button class="btn btn-warning" onclick="bulkEdit()">æ‰¹é‡ç¼–è¾‘</button>
                    <button class="btn btn-secondary" onclick="bulkDelete()">åˆ é™¤é€‰ä¸­</button>
                </div>
            </div>

            <!-- å›¾ç‰‡ç”»å»Š -->
            <div class="gallery-container" id="galleryContainer">
                <!-- å›¾ç‰‡å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <script src="../../demo/plugins/modal/index.js"></script>
    <script src="../../demo/plugins/checkbox/index.js"></script>
    <script src="../../demo/plugins/datetime-picker/index.js"></script>
    <script src="../../demo/plugins/input-number/index.js"></script>
    <script src="../../demo/plugins/notification/index.js"></script>
    <script src="../../demo/plugins/select/index.js"></script>

    <script>
        // æ ¸å¿ƒ hide å‡½æ•° - ç”¨äºéšè— DOM å…ƒç´ 
        // è®¾è®¡é€»è¾‘ï¼š
        // 1. å•ä¸ªå›¾ç‰‡éšè—ï¼šåªéšè— img å…ƒç´ ï¼Œä¿æŒå¡ç‰‡å¯è§ä»¥ä¾¿åˆ‡æ¢
        // 2. æ‰¹é‡éšè—ï¼šéšè—é€‰ä¸­å›¾ç‰‡çš„ img å…ƒç´ 
        // 3. ç­›é€‰å™¨ï¼šéšè—ä¸ç¬¦åˆæ¡ä»¶çš„æ•´ä¸ªå¡ç‰‡
        // 4. é‡ç½®/åˆ é™¤ï¼šéšè—æ•´ä¸ªå¡ç‰‡
        const hide = (...elements) => elements.forEach(el => el.style.display = 'none');

        // å›¾ç‰‡ç”»å»Šç®¡ç†ç±»
        class GalleryManager {
            constructor() {
                this.images = [];
                this.categories = ['é£æ™¯', 'äººç‰©', 'åŠ¨ç‰©', 'å»ºç­‘', 'æŠ½è±¡', 'å…¶ä»–'];
                this.selectedImages = new Set();
                this.filters = {
                    category: 'all',
                    status: 'all',
                    search: '',
                    sort: 'name'
                };
                this.BASE_URL = "https://www.eveningwater.com/my-web-projects/jQuery/7/img/";
                this.init();
            }

            init() {
                this.loadDefaultImages();
                this.setupEventListeners();
                this.updateStats();
                this.initFilters();
            }

            // åŠ è½½é»˜è®¤å›¾ç‰‡
            loadDefaultImages() {
            for (let i = 0; i < 10; i++) {
                    this.images.push({
                        id: i + 1,
                        title: `å›¾ç‰‡ ${i + 1}`,
                        description: `è¿™æ˜¯ç¬¬ ${i + 1} å¼ å›¾ç‰‡çš„æè¿°`,
                        category: this.categories[i % this.categories.length],
                        url: `${this.BASE_URL}${i + 1}.jpg`,
                        visible: i < 2, // å‰ä¸¤å¼ å¯è§ï¼Œå…¶ä½™éšè—
                        createdAt: new Date(Date.now() - Math.random() * 30 * 24 * 60 * 60 * 1000)
                    });
                }
                this.renderGallery();
            }

            // è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
            setupEventListeners() {
                // æœç´¢è¾“å…¥
                document.getElementById('searchInput').addEventListener('input', (e) => {
                    this.filters.search = e.target.value;
                    this.applyFilters();
                });
            }

            // åˆå§‹åŒ–ç­›é€‰å™¨
            initFilters() {
                setTimeout(() => {
                    // å…¨é€‰å¤é€‰æ¡†
                    const selectAllCheckbox = new Checkbox({
                        label: 'å…¨é€‰'
                    });
                    selectAllCheckbox.onChange = (checked) => {
                        this.toggleSelectAll(checked);
                    };
                    selectAllCheckbox.mount('#selectAllCheckbox');
                    window.selectAllCheckbox = selectAllCheckbox;

                    // åˆ†ç±»ç­›é€‰
                    const categoryFilter = new Select({
                        container: '#categoryFilter',
                        options: [
                            { value: 'all', label: 'å…¨éƒ¨åˆ†ç±»' },
                            ...this.categories.map(cat => ({ value: cat, label: cat }))
                        ],
                        placeholder: 'é€‰æ‹©åˆ†ç±»'
                    });
                    categoryFilter.setValue('all');
                    categoryFilter.onChange = (value) => {
                        this.filters.category = value;
                        this.applyFilters();
                    };
                    window.categoryFilter = categoryFilter;

                    // çŠ¶æ€ç­›é€‰
                    const statusFilter = new Select({
                        container: '#statusFilter',
                        options: [
                            { value: 'all', label: 'å…¨éƒ¨çŠ¶æ€' },
                            { value: 'visible', label: 'å¯è§' },
                            { value: 'hidden', label: 'éšè—' }
                        ],
                        placeholder: 'é€‰æ‹©çŠ¶æ€'
                    });
                    statusFilter.setValue('all');
                    statusFilter.onChange = (value) => {
                        this.filters.status = value;
                        this.applyFilters();
                    };

                    // æ’åºç­›é€‰
                    const sortFilter = new Select({
                        container: '#sortFilter',
                        options: [
                            { value: 'name', label: 'æŒ‰åç§°æ’åº' },
                            { value: 'date', label: 'æŒ‰æ—¥æœŸæ’åº' },
                            { value: 'category', label: 'æŒ‰åˆ†ç±»æ’åº' }
                        ],
                        placeholder: 'é€‰æ‹©æ’åº'
                    });
                    sortFilter.setValue('name');
                    sortFilter.onChange = (value) => {
                        this.filters.sort = value;
                        this.applyFilters();
                    };
                }, 100);
            }

            // æ¸²æŸ“ç”»å»Š
            renderGallery() {
                const container = document.getElementById('galleryContainer');
                container.innerHTML = '';

                this.images.forEach(image => {
                    const item = document.createElement('div');
                    item.className = `gallery-item ${image.visible ? '' : 'hidden'}`;
                    item.dataset.id = image.id;

                    item.innerHTML = `
                        <img class="gallery-item-img" src="${image.url}" alt="${image.title}">
                        <div class="gallery-item-overlay" data-text="å·²éšè—"></div>
                        <div class="gallery-item-actions">
                            ${image.visible ? 
                                `<button class="action-btn action-btn-hide" onclick="galleryManager.hideImage(${image.id})">ğŸ‘ï¸</button>` :
                                `<button class="action-btn action-btn-show" onclick="galleryManager.showImage(${image.id})">ğŸ‘ï¸â€ğŸ—¨ï¸</button>`
                            }
                            <button class="action-btn action-btn-edit" onclick="galleryManager.editImage(${image.id})">âœï¸</button>
                        </div>
                        <div class="gallery-item-info">
                            <div class="gallery-item-title">${image.title}</div>
                            <div class="gallery-item-category">${image.category}</div>
                        </div>
                    `;

                    // æ·»åŠ é€‰æ‹©åŠŸèƒ½
                    item.addEventListener('click', (e) => {
                        if (!e.target.classList.contains('action-btn')) {
                            this.toggleImageSelection(image.id);
                        }
                    });

                    container.appendChild(item);
                });

                this.updateStats();
            }

            // éšè—å›¾ç‰‡
            hideImage(id) {
                const image = this.images.find(img => img.id === id);
                if (image) {
                    image.visible = false;
                    
                    // è·å–å¯¹åº”çš„ DOM å…ƒç´ 
                    const element = document.querySelector(`[data-id="${id}"]`);
                    if (element) {
                        // éšè—å›¾ç‰‡å…ƒç´ 
                        const imgElement = element.querySelector('.gallery-item-img');
                        if (imgElement) {
                            hide(imgElement);
                        }
                        
                        // æ˜¾ç¤ºå ä½èƒŒæ™¯å’Œéšè—æç¤º
                        element.classList.add('hidden');
                        
                        // æ›´æ–°æŒ‰é’®çŠ¶æ€
                        this.updateImageButton(element, image);
                    }
                    
                    // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
                    this.updateStats();
                    notification.show(`å›¾ç‰‡ "${image.title}" å·²éšè—`, 'success');
                }
            }

            // æ˜¾ç¤ºå›¾ç‰‡
            showImage(id) {
                const image = this.images.find(img => img.id === id);
                if (image) {
                    image.visible = true;
                    
                    // è·å–å¯¹åº”çš„ DOM å…ƒç´ 
                    const element = document.querySelector(`[data-id="${id}"]`);
                    if (element) {
                        // æ˜¾ç¤ºå›¾ç‰‡å…ƒç´ 
                        const imgElement = element.querySelector('.gallery-item-img');
                        if (imgElement) {
                            imgElement.style.display = 'block';
                        }
                        
                        // ç§»é™¤éšè—çŠ¶æ€
                        element.classList.remove('hidden');
                        
                        // æ›´æ–°æŒ‰é’®çŠ¶æ€
                        this.updateImageButton(element, image);
                    }
                    
                    // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
                    this.updateStats();
                    notification.show(`å›¾ç‰‡ "${image.title}" å·²æ˜¾ç¤º`, 'success');
                }
            }

            // æ›´æ–°å›¾ç‰‡æŒ‰é’®çŠ¶æ€
            updateImageButton(element, image) {
                const actionsContainer = element.querySelector('.gallery-item-actions');
                if (actionsContainer) {
                    const toggleButton = actionsContainer.querySelector('.action-btn-hide, .action-btn-show');
                    if (toggleButton) {
                        if (image.visible) {
                            // å½“å‰æ˜¯æ˜¾ç¤ºçŠ¶æ€ï¼ŒæŒ‰é’®åº”è¯¥æ˜¯éšè—æŒ‰é’®
                            toggleButton.className = 'action-btn action-btn-hide';
                            toggleButton.innerHTML = 'ğŸ‘ï¸';
                            toggleButton.onclick = () => this.hideImage(image.id);
                        } else {
                            // å½“å‰æ˜¯éšè—çŠ¶æ€ï¼ŒæŒ‰é’®åº”è¯¥æ˜¯æ˜¾ç¤ºæŒ‰é’®
                            toggleButton.className = 'action-btn action-btn-show';
                            toggleButton.innerHTML = 'ğŸ‘ï¸â€ğŸ—¨ï¸';
                            toggleButton.onclick = () => this.showImage(image.id);
                        }
                    }
                }
            }

            // ç¼–è¾‘å›¾ç‰‡
            editImage(id) {
                const image = this.images.find(img => img.id === id);
                if (!image) return;

                const modalContent = `
                    <div class="modal-body">
                        <form id="editImageForm">
                            <div class="form-group">
                                <label class="form-label">å›¾ç‰‡æ ‡é¢˜</label>
                                <input type="text" class="form-input" id="editTitle" value="${image.title}">
                            </div>
                            <div class="form-group">
                                <label class="form-label">å›¾ç‰‡æè¿°</label>
                                <textarea class="form-textarea" id="editDescription">${image.description}</textarea>
                            </div>
                            <div class="form-group">
                                <label class="plugin-label">åˆ†ç±»</label>
                                <div class="plugin-container">
                                    <div id="editCategory"></div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">å›¾ç‰‡URL</label>
                                <input type="text" class="form-input" id="editUrl" value="${image.url}">
                            </div>
                        </form>
                    </div>
                `;

                modal.show({
                    title: 'ç¼–è¾‘å›¾ç‰‡',
                    content: modalContent,
                    width: '600px',
                    onConfirm: () => {
                        this.saveImageEdit(id);
                    }
                });

                // åˆå§‹åŒ–åˆ†ç±»é€‰æ‹©å™¨
                setTimeout(() => {
                    const editCategory = new Select({
                        container: '#editCategory',
                        options: this.categories.map(cat => ({ value: cat, label: cat })),
                        placeholder: 'é€‰æ‹©åˆ†ç±»'
                    });
                    editCategory.setValue(image.category);
                    window.editCategory = editCategory;
                }, 100);
            }

            // ä¿å­˜å›¾ç‰‡ç¼–è¾‘
            saveImageEdit(id) {
                const image = this.images.find(img => img.id === id);
                if (!image) return;

                image.title = document.getElementById('editTitle').value;
                image.description = document.getElementById('editDescription').value;
                image.category = window.editCategory.getValue();
                image.url = document.getElementById('editUrl').value;

                this.renderGallery();
                notification.show(`å›¾ç‰‡ "${image.title}" å·²æ›´æ–°`, 'success');
                modal.hide();
            }

            // åˆ‡æ¢å›¾ç‰‡é€‰æ‹©çŠ¶æ€
            toggleImageSelection(id) {
                if (this.selectedImages.has(id)) {
                    this.selectedImages.delete(id);
                } else {
                    this.selectedImages.add(id);
                }
                this.updateSelectionUI();
            }

            // å…¨é€‰/å–æ¶ˆå…¨é€‰
            toggleSelectAll(checked) {
                if (checked) {
                    this.images.forEach(img => this.selectedImages.add(img.id));
                } else {
                    this.selectedImages.clear();
                }
                this.updateSelectionUI(true); // ä¼ å…¥ true è¡¨ç¤ºä¸æ›´æ–° checkbox çŠ¶æ€
            }

            // æ›´æ–°é€‰æ‹©UI
            updateSelectionUI(skipCheckboxUpdate = false) {
                const selectedCount = document.getElementById('selectedCount');
                
                selectedCount.textContent = `(${this.selectedImages.size} ä¸ªå·²é€‰æ‹©)`;
                
                // å¦‚æœè·³è¿‡ checkbox æ›´æ–°ï¼Œåˆ™ç›´æ¥è¿”å›
                if (skipCheckboxUpdate) {
                    return;
                }
                
                // æ›´æ–°å…¨é€‰å¤é€‰æ¡†çŠ¶æ€
                const visibleImages = this.images.filter(img => 
                    this.isImageVisible(img) && 
                    (this.filters.category === 'all' || img.category === this.filters.category) &&
                    (this.filters.status === 'all' || 
                     (this.filters.status === 'visible' && img.visible) ||
                     (this.filters.status === 'hidden' && !img.visible))
                );
                
                if (window.selectAllCheckbox) {
                    const allSelected = visibleImages.length > 0 && 
                        visibleImages.every(img => this.selectedImages.has(img.id));
                    const someSelected = visibleImages.length > 0 && 
                        this.selectedImages.size > 0 && 
                        this.selectedImages.size < visibleImages.length;
                    
                    if (allSelected) {
                        window.selectAllCheckbox.setChecked(true);
                    } else if (someSelected) {
                        // å¯¹äºè‡ªå®šä¹‰checkboxï¼Œæˆ‘ä»¬è®¾ç½®ä¸ºfalseä½†å¯ä»¥é€šè¿‡æ ·å¼è¡¨ç¤ºéƒ¨åˆ†é€‰ä¸­çŠ¶æ€
                        window.selectAllCheckbox.setChecked(false);
                    } else {
                        window.selectAllCheckbox.setChecked(false);
                    }
                }
            }

            // åº”ç”¨ç­›é€‰å™¨
            applyFilters() {
                const container = document.getElementById('galleryContainer');
                const items = container.querySelectorAll('.gallery-item');

                items.forEach(item => {
                    const imageId = parseInt(item.dataset.id);
                    const image = this.images.find(img => img.id === imageId);
                    
                    if (this.isImageVisible(image)) {
                        // æ˜¾ç¤ºæ•´ä¸ªå¡ç‰‡
                        item.style.display = 'block';
                        // ç¡®ä¿å›¾ç‰‡å¯è§
                        const imgElement = item.querySelector('.gallery-item-img');
                        if (imgElement) {
                            imgElement.style.display = 'block';
                        }
                    } else {
                        // éšè—æ•´ä¸ªå¡ç‰‡ï¼ˆå› ä¸ºä¸ç¬¦åˆç­›é€‰æ¡ä»¶ï¼‰
                        hide(item);
                    }
                });

                this.updateSelectionUI();
            }

            // æ£€æŸ¥å›¾ç‰‡æ˜¯å¦åº”è¯¥æ˜¾ç¤º
            isImageVisible(image) {
                // åˆ†ç±»ç­›é€‰
                if (this.filters.category !== 'all' && image.category !== this.filters.category) {
                    return false;
                }

                // çŠ¶æ€ç­›é€‰
                if (this.filters.status === 'visible' && !image.visible) {
                    return false;
                }
                if (this.filters.status === 'hidden' && image.visible) {
                    return false;
                }

                // æœç´¢ç­›é€‰
                if (this.filters.search) {
                    const searchTerm = this.filters.search.toLowerCase();
                    const matchesTitle = image.title.toLowerCase().includes(searchTerm);
                    const matchesDescription = image.description.toLowerCase().includes(searchTerm);
                    if (!matchesTitle && !matchesDescription) {
                        return false;
                    }
                }

                return true;
            }

            // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
            updateStats() {
                document.getElementById('totalImages').textContent = this.images.length;
                document.getElementById('visibleImages').textContent = this.images.filter(img => img.visible).length;
                document.getElementById('hiddenImages').textContent = this.images.filter(img => !img.visible).length;
                document.getElementById('categories').textContent = this.categories.length;
            }

            // æ‰¹é‡æ˜¾ç¤º
            bulkShow() {
                if (this.selectedImages.size === 0) {
                    notification.show('è¯·å…ˆé€‰æ‹©è¦æ˜¾ç¤ºçš„å›¾ç‰‡', 'warning');
                    return;
                }

                const selectedCount = this.selectedImages.size;
                this.selectedImages.forEach(id => {
                    const image = this.images.find(img => img.id === id);
                    if (image) {
                        image.visible = true;
                        // æ˜¾ç¤ºå¯¹åº”çš„ DOM å…ƒç´ 
                        const element = document.querySelector(`[data-id="${id}"]`);
                        if (element) {
                            const imgElement = element.querySelector('.gallery-item-img');
                            if (imgElement) {
                                imgElement.style.display = 'block';
                            }
                            element.classList.remove('hidden');
                            
                            // æ›´æ–°æŒ‰é’®çŠ¶æ€
                            this.updateImageButton(element, image);
                        }
                    }
                });

                // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
                this.updateStats();
                this.selectedImages.clear();
                this.updateSelectionUI();
                notification.show(`å·²æ˜¾ç¤º ${selectedCount} å¼ å›¾ç‰‡`, 'success');
            }

            // æ‰¹é‡éšè—
            bulkHide() {
                if (this.selectedImages.size === 0) {
                    notification.show('è¯·å…ˆé€‰æ‹©è¦éšè—çš„å›¾ç‰‡', 'warning');
                    return;
                }

                const selectedCount = this.selectedImages.size;
                const imgElements = [];
                
                this.selectedImages.forEach(id => {
                    const image = this.images.find(img => img.id === id);
                    if (image) {
                        image.visible = false;
                        // è·å–å¯¹åº”çš„ DOM å…ƒç´ 
                        const element = document.querySelector(`[data-id="${id}"]`);
                        if (element) {
                            const imgElement = element.querySelector('.gallery-item-img');
                            if (imgElement) {
                                imgElements.push(imgElement);
                            }
                            // æ·»åŠ éšè—çŠ¶æ€
                            element.classList.add('hidden');
                            
                            // æ›´æ–°æŒ‰é’®çŠ¶æ€
                            this.updateImageButton(element, image);
                        }
                    }
                });

                // ä½¿ç”¨æ ¸å¿ƒ hide å‡½æ•°éšè—å›¾ç‰‡å…ƒç´ 
                if (imgElements.length > 0) {
                    hide(...imgElements);
                }

                // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
                this.updateStats();
                this.selectedImages.clear();
                this.updateSelectionUI();
                notification.show(`å·²éšè— ${selectedCount} å¼ å›¾ç‰‡`, 'success');
            }

            // æ‰¹é‡ç¼–è¾‘
            bulkEdit() {
                if (this.selectedImages.size === 0) {
                    notification.show('è¯·å…ˆé€‰æ‹©è¦ç¼–è¾‘çš„å›¾ç‰‡', 'warning');
                    return;
                }

                const modalContent = `
                    <div class="modal-body">
                        <form id="bulkEditForm">
                            <div class="form-group">
                                <label class="plugin-label">æ‰¹é‡è®¾ç½®åˆ†ç±»</label>
                                <div class="plugin-container">
                                    <div id="bulkCategory"></div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="plugin-label">æ‰¹é‡è®¾ç½®çŠ¶æ€</label>
                                <div class="plugin-container">
                                    <div id="bulkStatus"></div>
                                </div>
                            </div>
                        </form>
                    </div>
                `;

                modal.show({
                    title: 'æ‰¹é‡ç¼–è¾‘',
                    content: modalContent,
                    width: '500px',
                    onConfirm: () => {
                        this.saveBulkEdit();
                    }
                });

                setTimeout(() => {
                    const bulkCategory = new Select({
                        container: '#bulkCategory',
                        options: this.categories.map(cat => ({ value: cat, label: cat })),
                        placeholder: 'é€‰æ‹©åˆ†ç±»'
                    });
                    window.bulkCategory = bulkCategory;

                    const bulkStatus = new Select({
                        container: '#bulkStatus',
                        options: [
                            { value: 'visible', label: 'æ˜¾ç¤º' },
                            { value: 'hidden', label: 'éšè—' }
                        ],
                        placeholder: 'é€‰æ‹©çŠ¶æ€'
                    });
                    window.bulkStatus = bulkStatus;
                }, 100);
            }

            // ä¿å­˜æ‰¹é‡ç¼–è¾‘
            saveBulkEdit() {
                const category = window.bulkCategory.getValue();
                const status = window.bulkStatus.getValue();

                this.selectedImages.forEach(id => {
                    const image = this.images.find(img => img.id === id);
                    if (image) {
                        if (category) image.category = category;
                        if (status !== undefined) {
                            const newVisible = status === 'visible';
                            image.visible = newVisible;
                            
                            // æ›´æ–°å¯¹åº”çš„ DOM å…ƒç´ 
                            const element = document.querySelector(`[data-id="${id}"]`);
                            if (element) {
                                const imgElement = element.querySelector('.gallery-item-img');
                                if (imgElement) {
                                    if (newVisible) {
                                        imgElement.style.display = 'block';
                                        element.classList.remove('hidden');
                                    } else {
                                        hide(imgElement);
                                        element.classList.add('hidden');
                                    }
                                }
                                
                                // æ›´æ–°æŒ‰é’®çŠ¶æ€
                                this.updateImageButton(element, image);
                            }
                        }
                    }
                });

                this.updateStats();
                this.selectedImages.clear();
                this.updateSelectionUI();
                notification.show('æ‰¹é‡ç¼–è¾‘å®Œæˆ', 'success');
                modal.hide();
            }

            // æ‰¹é‡åˆ é™¤
            bulkDelete() {
                if (this.selectedImages.size === 0) {
                    notification.show('è¯·å…ˆé€‰æ‹©è¦åˆ é™¤çš„å›¾ç‰‡', 'warning');
                    return;
                }

                const modalContent = `
                    <div class="modal-body">
                        <p>ç¡®å®šè¦åˆ é™¤é€‰ä¸­çš„ ${this.selectedImages.size} å¼ å›¾ç‰‡å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚</p>
                    </div>
                `;

                modal.show({
                    title: 'ç¡®è®¤åˆ é™¤',
                    content: modalContent,
                    width: '400px',
                    onConfirm: () => {
                        this.confirmBulkDelete();
                    }
                });
            }

            // ç¡®è®¤æ‰¹é‡åˆ é™¤
            confirmBulkDelete() {
                // ä½¿ç”¨æ ¸å¿ƒ hide å‡½æ•°éšè—è¦åˆ é™¤çš„å›¾ç‰‡
                const selectedElements = [];
                this.selectedImages.forEach(id => {
                    const element = document.querySelector(`[data-id="${id}"]`);
                    if (element) {
                        selectedElements.push(element);
                    }
                });
                
                if (selectedElements.length > 0) {
                    hide(...selectedElements);
                }
                
                this.images = this.images.filter(img => !this.selectedImages.has(img.id));
                this.renderGallery();
                this.selectedImages.clear();
                this.updateSelectionUI();
                notification.show('æ‰¹é‡åˆ é™¤å®Œæˆ', 'success');
                modal.hide();
            }

            // æ·»åŠ æ–°å›¾ç‰‡
            addImage(imageData) {
                const newImage = {
                    id: Date.now(),
                    title: imageData.title,
                    description: imageData.description,
                    category: imageData.category,
                    url: imageData.url,
                    visible: imageData.visible,
                    createdAt: new Date()
                };

                this.images.push(newImage);
                this.renderGallery();
                notification.show(`å›¾ç‰‡ "${newImage.title}" å·²æ·»åŠ `, 'success');
            }

            // é‡ç½®ç”»å»Š
            resetGallery() {
                const modalContent = `
                    <div class="modal-body">
                        <p>ç¡®å®šè¦é‡ç½®ç”»å»Šå—ï¼Ÿè¿™å°†åˆ é™¤æ‰€æœ‰è‡ªå®šä¹‰å›¾ç‰‡å¹¶æ¢å¤åˆ°é»˜è®¤çŠ¶æ€ã€‚</p>
                    </div>
                `;

                modal.show({
                    title: 'ç¡®è®¤é‡ç½®',
                    content: modalContent,
                    width: '400px',
                    onConfirm: () => {
                        this.confirmReset();
                    }
                });
            }

            // æ›´æ–°åˆ†ç±»ç­›é€‰å™¨
            updateCategoryFilters() {
                // æ›´æ–°åˆ†ç±»ç­›é€‰å™¨é€‰é¡¹
                if (window.categoryFilter) {
                    const newOptions = [
                        { value: 'all', label: 'å…¨éƒ¨åˆ†ç±»' },
                        ...this.categories.map(cat => ({ value: cat, label: cat }))
                    ];
                    window.categoryFilter.setOptions(newOptions);
                }
                
                // æ›´æ–°å…¶ä»–ä½¿ç”¨åˆ†ç±»çš„ç­›é€‰å™¨
                this.updateAllCategorySelectors();
            }

            // æ›´æ–°æ‰€æœ‰åˆ†ç±»é€‰æ‹©å™¨
            updateAllCategorySelectors() {
                // æ›´æ–°æ·»åŠ å›¾ç‰‡æ¨¡æ€æ¡†ä¸­çš„åˆ†ç±»é€‰æ‹©å™¨
                if (window.newCategory) {
                    const newOptions = this.categories.map(cat => ({ value: cat, label: cat }));
                    window.newCategory.setOptions(newOptions);
                }
                
                // æ›´æ–°ç¼–è¾‘å›¾ç‰‡æ¨¡æ€æ¡†ä¸­çš„åˆ†ç±»é€‰æ‹©å™¨
                if (window.editCategory) {
                    const newOptions = this.categories.map(cat => ({ value: cat, label: cat }));
                    window.editCategory.setOptions(newOptions);
                }
                
                // æ›´æ–°æ‰¹é‡ç¼–è¾‘æ¨¡æ€æ¡†ä¸­çš„åˆ†ç±»é€‰æ‹©å™¨
                if (window.bulkCategory) {
                    const newOptions = this.categories.map(cat => ({ value: cat, label: cat }));
                    window.bulkCategory.setOptions(newOptions);
                }
            }

            // ç¡®è®¤é‡ç½®
            confirmReset() {
                // ä½¿ç”¨æ ¸å¿ƒ hide å‡½æ•°éšè—æ‰€æœ‰å½“å‰å›¾ç‰‡
                const allItems = document.querySelectorAll('.gallery-item');
                if (allItems.length > 0) {
                    hide(...allItems);
                }
                
                this.images = [];
                this.selectedImages.clear();
                this.loadDefaultImages();
                this.updateSelectionUI();
                notification.show('ç”»å»Šå·²é‡ç½®', 'success');
                modal.hide();
            }
        }

        // å…¨å±€å˜é‡
        let galleryManager;
        let modal;
        let notification;

        // æ˜¾ç¤ºæ·»åŠ å›¾ç‰‡æ¨¡æ€æ¡†
        function showAddImageModal() {
            const modalContent = `
                <div class="modal-body">
                    <form id="addImageForm">
                        <div class="form-group">
                            <label class="form-label">å›¾ç‰‡æ ‡é¢˜</label>
                            <input type="text" class="form-input" id="newTitle" placeholder="è¾“å…¥å›¾ç‰‡æ ‡é¢˜">
                        </div>
                        <div class="form-group">
                            <label class="form-label">å›¾ç‰‡æè¿°</label>
                            <textarea class="form-textarea" id="newDescription" placeholder="è¾“å…¥å›¾ç‰‡æè¿°"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="plugin-label">åˆ†ç±»</label>
                            <div class="plugin-container">
                                <div id="newCategory"></div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">å›¾ç‰‡URL</label>
                            <input type="text" class="form-input" id="newUrl" placeholder="è¾“å…¥å›¾ç‰‡URL">
                        </div>
                        <div class="form-group">
                            <label class="plugin-label">åˆå§‹çŠ¶æ€</label>
                            <div class="plugin-container">
                                <div id="newStatus"></div>
                            </div>
                        </div>
                    </form>
                </div>
            `;

            modal.show({
                title: 'æ·»åŠ æ–°å›¾ç‰‡',
                content: modalContent,
                width: '600px',
                onConfirm: () => {
                    addNewImage();
                }
            });

            setTimeout(() => {
                const newCategory = new Select({
                    container: '#newCategory',
                    options: galleryManager.categories.map(cat => ({ value: cat, label: cat })),
                    placeholder: 'é€‰æ‹©åˆ†ç±»'
                });
                window.newCategory = newCategory;

                const newStatus = new Select({
                    container: '#newStatus',
                    options: [
                        { value: true, label: 'æ˜¾ç¤º' },
                        { value: false, label: 'éšè—' }
                    ],
                    placeholder: 'é€‰æ‹©çŠ¶æ€'
                });
                newStatus.setValue(true);
                window.newStatus = newStatus;
            }, 100);
        }

        // æ·»åŠ æ–°å›¾ç‰‡
        function addNewImage() {
            const title = document.getElementById('newTitle').value;
            const description = document.getElementById('newDescription').value;
            const url = document.getElementById('newUrl').value;

            if (!title || !url) {
                notification.show('è¯·å¡«å†™å›¾ç‰‡æ ‡é¢˜å’ŒURL', 'error');
                return;
            }

            const imageData = {
                title,
                description,
                category: window.newCategory.getValue() || galleryManager.categories[0],
                url,
                visible: window.newStatus.getValue()
            };

            galleryManager.addImage(imageData);
            modal.hide();
        }

        // æ˜¾ç¤ºåˆ†ç±»ç®¡ç†
        function showCategoryManager() {
            const modalContent = `
                <div class="modal-body">
                    <h4>å½“å‰åˆ†ç±» (${galleryManager.categories.length} ä¸ª)</h4>
                    <div style="margin: 20px 0;">
                        ${galleryManager.categories.map(cat => `
                            <div style="display: flex; align-items: center; gap: 10px; padding: 10px; background: #f8f9fa; border-radius: 8px; margin-bottom: 10px;">
                                <span style="flex: 1;">${cat}</span>
                                <button class="btn btn-danger" onclick="deleteCategory('${cat}')" style="padding: 5px 10px; font-size: 12px;">åˆ é™¤</button>
                            </div>
                        `).join('')}
                    </div>
                    <div class="form-group">
                        <label class="form-label">æ·»åŠ æ–°åˆ†ç±»</label>
                        <input type="text" class="form-input" id="newCategoryName" placeholder="è¾“å…¥åˆ†ç±»åç§°">
                    </div>
                    <div style="margin-top: 20px; text-align: center; color: #6c757d; font-size: 14px;">
                        ç‚¹å‡»"ç¡®å®š"æŒ‰é’®æ·»åŠ æ–°åˆ†ç±»
                    </div>
                </div>
            `;

            modal.show({
                title: 'åˆ†ç±»ç®¡ç†',
                content: modalContent,
                type: 'confirm',
                onConfirm: () => {
                    addCategory();
                }
            });
        }

        // æ·»åŠ åˆ†ç±»
        function addCategory() {
            const name = document.getElementById('newCategoryName').value;
            if (!name) {
                notification.show('è¯·è¾“å…¥åˆ†ç±»åç§°', 'error');
                return;
            }

            if (galleryManager.categories.includes(name)) {
                notification.show('åˆ†ç±»å·²å­˜åœ¨', 'warning');
                return;
            }

            galleryManager.categories.push(name);
            notification.show(`åˆ†ç±» "${name}" å·²æ·»åŠ `, 'success');
            
            // æ›´æ–°ç­›é€‰å™¨ä¸­çš„åˆ†ç±»é€‰é¡¹
            galleryManager.updateCategoryFilters();
            
            modal.hide();
        }

        // åˆ é™¤åˆ†ç±»
        function deleteCategory(name) {
            if (galleryManager.categories.length <= 1) {
                notification.show('è‡³å°‘éœ€è¦ä¿ç•™ä¸€ä¸ªåˆ†ç±»', 'warning');
                return;
            }

            const imagesInCategory = galleryManager.images.filter(img => img.category === name);
            if (imagesInCategory.length > 0) {
                notification.show(`æ— æ³•åˆ é™¤åˆ†ç±» "${name}"ï¼Œè¯¥åˆ†ç±»ä¸‹è¿˜æœ‰ ${imagesInCategory.length} å¼ å›¾ç‰‡`, 'error');
                return;
            }

            galleryManager.categories = galleryManager.categories.filter(cat => cat !== name);
            notification.show(`åˆ†ç±» "${name}" å·²åˆ é™¤`, 'success');
            
            // æ›´æ–°ç­›é€‰å™¨ä¸­çš„åˆ†ç±»é€‰é¡¹
            galleryManager.updateCategoryFilters();
        }

        // æ˜¾ç¤ºæ‰¹é‡æ“ä½œ
        function showBulkOperations() {
            const modalContent = `
                <div class="modal-body">
                    <h4>æ‰¹é‡æ“ä½œè¯´æ˜</h4>
                    <ul style="margin: 20px 0;">
                        <li>é€‰æ‹©å›¾ç‰‡ï¼šç‚¹å‡»å›¾ç‰‡å¡ç‰‡è¿›è¡Œé€‰æ‹©</li>
                        <li>å…¨é€‰ï¼šä½¿ç”¨é¡µé¢ä¸Šçš„å…¨é€‰å¤é€‰æ¡†</li>
                        <li>æ‰¹é‡æ˜¾ç¤ºï¼šæ˜¾ç¤ºæ‰€æœ‰é€‰ä¸­çš„å›¾ç‰‡</li>
                        <li>æ‰¹é‡éšè—ï¼šéšè—æ‰€æœ‰é€‰ä¸­çš„å›¾ç‰‡</li>
                        <li>æ‰¹é‡ç¼–è¾‘ï¼šç»Ÿä¸€ä¿®æ”¹é€‰ä¸­å›¾ç‰‡çš„åˆ†ç±»å’ŒçŠ¶æ€</li>
                        <li>æ‰¹é‡åˆ é™¤ï¼šåˆ é™¤æ‰€æœ‰é€‰ä¸­çš„å›¾ç‰‡</li>
                    </ul>
                    <p><strong>å½“å‰é€‰ä¸­ï¼š</strong><span id="currentSelected">0</span> å¼ å›¾ç‰‡</p>
                </div>
            `;

            modal.show({
                title: 'æ‰¹é‡æ“ä½œè¯´æ˜',
                content: modalContent,
                width: '500px'
            });

            // æ›´æ–°é€‰ä¸­æ•°é‡
            setTimeout(() => {
                document.getElementById('currentSelected').textContent = galleryManager.selectedImages.size;
            }, 100);
        }

        // æ˜¾ç¤ºç”»å»Šè®¾ç½®
        function showGallerySettings() {
            const modalContent = `
                <div class="modal-body">
                    <h4>ç”»å»Šè®¾ç½®</h4>
                    <div class="form-group">
                        <label class="plugin-label">é»˜è®¤å›¾ç‰‡çŠ¶æ€</label>
                        <div class="plugin-container">
                            <div id="defaultStatus"></div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="plugin-label">å›¾ç‰‡åŠ è½½æ–¹å¼</label>
                        <div class="plugin-container">
                            <div id="loadMethod"></div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">æ¯è¡Œæ˜¾ç¤ºå›¾ç‰‡æ•°é‡</label>
                        <div class="plugin-container">
                            <div id="imagesPerRow"></div>
                        </div>
                    </div>
                </div>
            `;

            modal.show({
                title: 'ç”»å»Šè®¾ç½®',
                content: modalContent,
                width: '500px',
                onConfirm: () => {
                    saveGallerySettings();
                }
            });

            setTimeout(() => {
                const defaultStatus = new Select({
                    container: '#defaultStatus',
                    options: [
                        { value: 'visible', label: 'æ˜¾ç¤º' },
                        { value: 'hidden', label: 'éšè—' }
                    ],
                    placeholder: 'é€‰æ‹©é»˜è®¤çŠ¶æ€'
                });
                defaultStatus.setValue('visible');
                window.defaultStatus = defaultStatus;

                const loadMethod = new Select({
                    container: '#loadMethod',
                    options: [
                        { value: 'lazy', label: 'æ‡’åŠ è½½' },
                        { value: 'eager', label: 'ç«‹å³åŠ è½½' }
                    ],
                    placeholder: 'é€‰æ‹©åŠ è½½æ–¹å¼'
                });
                loadMethod.setValue('eager');
                window.loadMethod = loadMethod;

                const imagesPerRow = new InputNumber({
                    container: '#imagesPerRow',
                    min: 1,
                    max: 6,
                    step: 1,
                    value: 4
                });
                window.imagesPerRow = imagesPerRow;
            }, 100);
        }

        // ä¿å­˜ç”»å»Šè®¾ç½®
        function saveGallerySettings() {
            const defaultStatus = window.defaultStatus.getValue();
            const loadMethod = window.loadMethod.getValue();
            const imagesPerRow = window.imagesPerRow.getValue();

            // è¿™é‡Œå¯ä»¥ä¿å­˜è®¾ç½®åˆ° localStorage æˆ–å‘é€åˆ°æœåŠ¡å™¨
            localStorage.setItem('gallerySettings', JSON.stringify({
                defaultStatus,
                loadMethod,
                imagesPerRow
            }));

            notification.show('ç”»å»Šè®¾ç½®å·²ä¿å­˜', 'success');
            modal.hide();
        }

        // é‡ç½®ç”»å»Š
        function resetGallery() {
            galleryManager.resetGallery();
        }

        // å…¨å±€å‡½æ•°ï¼Œç”¨äºåœ¨ galleryManager åˆå§‹åŒ–å‰æä¾›å ä½ç¬¦
        function bulkShow() {
            if (window.galleryManager) {
                window.galleryManager.bulkShow();
            }
        }

        function bulkHide() {
            if (window.galleryManager) {
                window.galleryManager.bulkHide();
            }
        }

        function bulkEdit() {
            if (window.galleryManager) {
                window.galleryManager.bulkEdit();
            }
        }

        function bulkDelete() {
            if (window.galleryManager) {
                window.galleryManager.bulkDelete();
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // åˆå§‹åŒ–å…¨å±€æ’ä»¶å®ä¾‹
            modal = new Modal();
            notification = new Notification();
            
            // åˆå§‹åŒ–ç”»å»Šç®¡ç†å™¨
            galleryManager = new GalleryManager();
            
            // å°† galleryManager æš´éœ²åˆ°å…¨å±€ä½œç”¨åŸŸ
            window.galleryManager = galleryManager;
            
            // æ˜¾ç¤ºæ¬¢è¿é€šçŸ¥
            setTimeout(() => {
                notification.show('æ¬¢è¿ä½¿ç”¨å›¾ç‰‡ç”»å»Šç®¡ç†ç³»ç»Ÿ', 'success');
            }, 1000);
        });
    </script>
</body>

</html>